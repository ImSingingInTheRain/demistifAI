/*! streamlit-component-lib v1.7.0 | Built from npm:streamlit-component-lib@1.4.0 bundle for offline use.
 * Source: https://unpkg.com/streamlit-component-lib@1.7.0/dist/index.js
 * This bundled file preserves the Apache-2.0 license from the upstream project.
 */
var streamlit_component_lib=(()=>{var ym=Object.create;var Vn=Object.defineProperty;var mm=Object.getOwnPropertyDescriptor;var bm=Object.getOwnPropertyNames;var _m=Object.getPrototypeOf,gm=Object.prototype.hasOwnProperty;var b=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),vm=(t,e)=>{for(var r in e)Vn(t,r,{get:e[r],enumerable:!0})},yf=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of bm(e))!gm.call(t,n)&&n!==r&&Vn(t,n,{get:()=>e[n],enumerable:!(i=mm(e,n))||i.enumerable});return t};var Un=(t,e,r)=>(r=t!=null?ym(_m(t)):{},yf(e||!t||!t.__esModule?Vn(r,"default",{value:t,enumerable:!0}):r,t)),wm=t=>yf(Vn({},"__esModule",{value:!0}),t);var bf=b(z=>{"use strict";var le=typeof Symbol=="function"&&Symbol.for,Ja=le?Symbol.for("react.element"):60103,Ga=le?Symbol.for("react.portal"):60106,xn=le?Symbol.for("react.fragment"):60107,Ln=le?Symbol.for("react.strict_mode"):60108,Nn=le?Symbol.for("react.profiler"):60114,En=le?Symbol.for("react.provider"):60109,Rn=le?Symbol.for("react.context"):60110,Ka=le?Symbol.for("react.async_mode"):60111,qn=le?Symbol.for("react.concurrent_mode"):60111,Cn=le?Symbol.for("react.forward_ref"):60112,jn=le?Symbol.for("react.suspense"):60113,Bm=le?Symbol.for("react.suspense_list"):60120,kn=le?Symbol.for("react.memo"):60115,Pn=le?Symbol.for("react.lazy"):60116,Tm=le?Symbol.for("react.block"):60121,Im=le?Symbol.for("react.fundamental"):60117,Sm=le?Symbol.for("react.responder"):60118,Am=le?Symbol.for("react.scope"):60119;function De(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case Ja:switch(t=t.type,t){case Ka:case qn:case xn:case Nn:case Ln:case jn:return t;default:switch(t=t&&t.$$typeof,t){case Rn:case Cn:case Pn:case kn:case En:return t;default:return e}}case Ga:return e}}}function mf(t){return De(t)===qn}z.AsyncMode=Ka;z.ConcurrentMode=qn;z.ContextConsumer=Rn;z.ContextProvider=En;z.Element=Ja;z.ForwardRef=Cn;z.Fragment=xn;z.Lazy=Pn;z.Memo=kn;z.Portal=Ga;z.Profiler=Nn;z.StrictMode=Ln;z.Suspense=jn;z.isAsyncMode=function(t){return mf(t)||De(t)===Ka};z.isConcurrentMode=mf;z.isContextConsumer=function(t){return De(t)===Rn};z.isContextProvider=function(t){return De(t)===En};z.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ja};z.isForwardRef=function(t){return De(t)===Cn};z.isFragment=function(t){return De(t)===xn};z.isLazy=function(t){return De(t)===Pn};z.isMemo=function(t){return De(t)===kn};z.isPortal=function(t){return De(t)===Ga};z.isProfiler=function(t){return De(t)===Nn};z.isStrictMode=function(t){return De(t)===Ln};z.isSuspense=function(t){return De(t)===jn};z.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===xn||t===qn||t===Nn||t===Ln||t===jn||t===Bm||typeof t=="object"&&t!==null&&(t.$$typeof===Pn||t.$$typeof===kn||t.$$typeof===En||t.$$typeof===Rn||t.$$typeof===Cn||t.$$typeof===Im||t.$$typeof===Sm||t.$$typeof===Am||t.$$typeof===Tm)};z.typeOf=De});var gf=b((rI,_f)=>{"use strict";_f.exports=bf()});var Af=b((iI,Sf)=>{"use strict";var Za=gf(),Dm={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Fm={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Om={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Tf={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Qa={};Qa[Za.ForwardRef]=Om;Qa[Za.Memo]=Tf;function vf(t){return Za.isMemo(t)?Tf:Qa[t.$$typeof]||Dm}var Mm=Object.defineProperty,Vm=Object.getOwnPropertyNames,wf=Object.getOwnPropertySymbols,Um=Object.getOwnPropertyDescriptor,xm=Object.getPrototypeOf,Bf=Object.prototype;function If(t,e,r){if(typeof e!="string"){if(Bf){var i=xm(e);i&&i!==Bf&&If(t,i,r)}var n=Vm(e);wf&&(n=n.concat(wf(e)));for(var a=vf(t),o=vf(e),c=0;c<n.length;++c){var l=n[c];if(!Fm[l]&&!(r&&r[l])&&!(o&&o[l])&&!(a&&a[l])){var s=Um(e,l);try{Mm(t,l,s)}catch{}}}}return t}Sf.exports=If});var Of=b((nI,Ff)=>{"use strict";var Df=Object.getOwnPropertySymbols,Lm=Object.prototype.hasOwnProperty,Nm=Object.prototype.propertyIsEnumerable;function Em(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function Rm(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;var i=Object.getOwnPropertyNames(e).map(function(a){return e[a]});if(i.join("")!=="0123456789")return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(a){n[a]=a}),Object.keys(Object.assign({},n)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}Ff.exports=Rm()?Object.assign:function(t,e){for(var r,i=Em(t),n,a=1;a<arguments.length;a++){r=Object(arguments[a]);for(var o in r)Lm.call(r,o)&&(i[o]=r[o]);if(Df){n=Df(r);for(var c=0;c<n.length;c++)Nm.call(r,n[c])&&(i[n[c]]=r[n[c]])}}return i}});var kf=b($=>{"use strict";var io=Of(),Re=typeof Symbol=="function"&&Symbol.for,ni=Re?Symbol.for("react.element"):60103,qm=Re?Symbol.for("react.portal"):60106,Cm=Re?Symbol.for("react.fragment"):60107,jm=Re?Symbol.for("react.strict_mode"):60108,km=Re?Symbol.for("react.profiler"):60114,Pm=Re?Symbol.for("react.provider"):60109,zm=Re?Symbol.for("react.context"):60110,$m=Re?Symbol.for("react.forward_ref"):60112,Wm=Re?Symbol.for("react.suspense"):60113,Ym=Re?Symbol.for("react.memo"):60115,Hm=Re?Symbol.for("react.lazy"):60116,Mf=typeof Symbol=="function"&&Symbol.iterator;function si(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Vf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Uf={};function vr(t,e,r){this.props=t,this.context=e,this.refs=Uf,this.updater=r||Vf}vr.prototype.isReactComponent={};vr.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error(si(85));this.updater.enqueueSetState(this,t,e,"setState")};vr.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function xf(){}xf.prototype=vr.prototype;function no(t,e,r){this.props=t,this.context=e,this.refs=Uf,this.updater=r||Vf}var so=no.prototype=new xf;so.constructor=no;io(so,vr.prototype);so.isPureReactComponent=!0;var ao={current:null},Lf=Object.prototype.hasOwnProperty,Nf={key:!0,ref:!0,__self:!0,__source:!0};function Ef(t,e,r){var i,n={},a=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)Lf.call(e,i)&&!Nf.hasOwnProperty(i)&&(n[i]=e[i]);var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){for(var l=Array(c),s=0;s<c;s++)l[s]=arguments[s+2];n.children=l}if(t&&t.defaultProps)for(i in c=t.defaultProps,c)n[i]===void 0&&(n[i]=c[i]);return{$$typeof:ni,type:t,key:a,ref:o,props:n,_owner:ao.current}}function Jm(t,e){return{$$typeof:ni,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function oo(t){return typeof t=="object"&&t!==null&&t.$$typeof===ni}function Gm(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,function(r){return e[r]})}var Rf=/\/+/g,zn=[];function qf(t,e,r,i){if(zn.length){var n=zn.pop();return n.result=t,n.keyPrefix=e,n.func=r,n.context=i,n.count=0,n}return{result:t,keyPrefix:e,func:r,context:i,count:0}}function Cf(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>zn.length&&zn.push(t)}function eo(t,e,r,i){var n=typeof t;(n==="undefined"||n==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(n){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case ni:case qm:a=!0}}if(a)return r(i,t,e===""?"."+Xa(t,0):e),1;if(a=0,e=e===""?".":e+":",Array.isArray(t))for(var o=0;o<t.length;o++){n=t[o];var c=e+Xa(n,o);a+=eo(n,c,r,i)}else if(t===null||typeof t!="object"?c=null:(c=Mf&&t[Mf]||t["@@iterator"],c=typeof c=="function"?c:null),typeof c=="function")for(t=c.call(t),o=0;!(n=t.next()).done;)n=n.value,c=e+Xa(n,o++),a+=eo(n,c,r,i);else if(n==="object")throw r=""+t,Error(si(31,r==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":r,""));return a}function to(t,e,r){return t==null?0:eo(t,"",e,r)}function Xa(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Gm(t.key):e.toString(36)}function Km(t,e){t.func.call(t.context,e,t.count++)}function Zm(t,e,r){var i=t.result,n=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?ro(t,i,r,function(a){return a}):t!=null&&(oo(t)&&(t=Jm(t,n+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(Rf,"$&/")+"/")+r)),i.push(t))}function ro(t,e,r,i,n){var a="";r!=null&&(a=(""+r).replace(Rf,"$&/")+"/"),e=qf(e,a,i,n),to(t,Zm,e),Cf(e)}var jf={current:null};function lt(){var t=jf.current;if(t===null)throw Error(si(321));return t}var Qm={ReactCurrentDispatcher:jf,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:ao,IsSomeRendererActing:{current:!1},assign:io};$.Children={map:function(t,e,r){if(t==null)return t;var i=[];return ro(t,i,null,e,r),i},forEach:function(t,e,r){if(t==null)return t;e=qf(null,null,e,r),to(t,Km,e),Cf(e)},count:function(t){return to(t,function(){return null},null)},toArray:function(t){var e=[];return ro(t,e,null,function(r){return r}),e},only:function(t){if(!oo(t))throw Error(si(143));return t}};$.Component=vr;$.Fragment=Cm;$.Profiler=km;$.PureComponent=no;$.StrictMode=jm;$.Suspense=Wm;$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qm;$.cloneElement=function(t,e,r){if(t==null)throw Error(si(267,t));var i=io({},t.props),n=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=ao.current),e.key!==void 0&&(n=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(l in e)Lf.call(e,l)&&!Nf.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&c!==void 0?c[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){c=Array(l);for(var s=0;s<l;s++)c[s]=arguments[s+2];i.children=c}return{$$typeof:ni,type:t.type,key:n,ref:a,props:i,_owner:o}};$.createContext=function(t,e){return e===void 0&&(e=null),t={$$typeof:zm,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider={$$typeof:Pm,_context:t},t.Consumer=t};$.createElement=Ef;$.createFactory=function(t){var e=Ef.bind(null,t);return e.type=t,e};$.createRef=function(){return{current:null}};$.forwardRef=function(t){return{$$typeof:$m,render:t}};$.isValidElement=oo;$.lazy=function(t){return{$$typeof:Hm,_ctor:t,_status:-1,_result:null}};$.memo=function(t,e){return{$$typeof:Ym,type:t,compare:e===void 0?null:e}};$.useCallback=function(t,e){return lt().useCallback(t,e)};$.useContext=function(t,e){return lt().useContext(t,e)};$.useDebugValue=function(){};$.useEffect=function(t,e){return lt().useEffect(t,e)};$.useImperativeHandle=function(t,e,r){return lt().useImperativeHandle(t,e,r)};$.useLayoutEffect=function(t,e){return lt().useLayoutEffect(t,e)};$.useMemo=function(t,e){return lt().useMemo(t,e)};$.useReducer=function(t,e,r){return lt().useReducer(t,e,r)};$.useRef=function(t){return lt().useRef(t)};$.useState=function(t){return lt().useState(t)};$.version="16.14.0"});var zf=b((aI,Pf)=>{"use strict";Pf.exports=kf()});var Xf=b((ci,oi)=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});var Gf=new WeakMap,co=new WeakMap;function H(t){let e=Gf.get(t);return console.assert(e!=null,"'this' is expected an Event object, but got",t),e}function $f(t){if(t.passiveListener!=null){typeof console<"u"&&typeof console.error=="function"&&console.error("Unable to preventDefault inside passive event listener invocation.",t.passiveListener);return}t.event.cancelable&&(t.canceled=!0,typeof t.event.preventDefault=="function"&&t.event.preventDefault())}function wr(t,e){Gf.set(this,{eventTarget:t,event:e,eventPhase:2,currentTarget:t,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:e.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});let r=Object.keys(e);for(let i=0;i<r.length;++i){let n=r[i];n in this||Object.defineProperty(this,n,Kf(n))}}wr.prototype={get type(){return H(this).event.type},get target(){return H(this).eventTarget},get currentTarget(){return H(this).currentTarget},composedPath(){let t=H(this).currentTarget;return t==null?[]:[t]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return H(this).eventPhase},stopPropagation(){let t=H(this);t.stopped=!0,typeof t.event.stopPropagation=="function"&&t.event.stopPropagation()},stopImmediatePropagation(){let t=H(this);t.stopped=!0,t.immediateStopped=!0,typeof t.event.stopImmediatePropagation=="function"&&t.event.stopImmediatePropagation()},get bubbles(){return!!H(this).event.bubbles},get cancelable(){return!!H(this).event.cancelable},preventDefault(){$f(H(this))},get defaultPrevented(){return H(this).canceled},get composed(){return!!H(this).event.composed},get timeStamp(){return H(this).timeStamp},get srcElement(){return H(this).eventTarget},get cancelBubble(){return H(this).stopped},set cancelBubble(t){if(!t)return;let e=H(this);e.stopped=!0,typeof e.event.cancelBubble=="boolean"&&(e.event.cancelBubble=!0)},get returnValue(){return!H(this).canceled},set returnValue(t){t||$f(H(this))},initEvent(){}};Object.defineProperty(wr.prototype,"constructor",{value:wr,configurable:!0,writable:!0});typeof window<"u"&&typeof window.Event<"u"&&(Object.setPrototypeOf(wr.prototype,window.Event.prototype),co.set(window.Event.prototype,wr));function Kf(t){return{get(){return H(this).event[t]},set(e){H(this).event[t]=e},configurable:!0,enumerable:!0}}function Xm(t){return{value(){let e=H(this).event;return e[t].apply(e,arguments)},configurable:!0,enumerable:!0}}function eb(t,e){let r=Object.keys(e);if(r.length===0)return t;function i(n,a){t.call(this,n,a)}i.prototype=Object.create(t.prototype,{constructor:{value:i,configurable:!0,writable:!0}});for(let n=0;n<r.length;++n){let a=r[n];if(!(a in t.prototype)){let c=typeof Object.getOwnPropertyDescriptor(e,a).value=="function";Object.defineProperty(i.prototype,a,c?Xm(a):Kf(a))}}return i}function Zf(t){if(t==null||t===Object.prototype)return wr;let e=co.get(t);return e==null&&(e=eb(Zf(Object.getPrototypeOf(t)),t),co.set(t,e)),e}function tb(t,e){let r=Zf(Object.getPrototypeOf(e));return new r(t,e)}function rb(t){return H(t).immediateStopped}function ib(t,e){H(t).eventPhase=e}function nb(t,e){H(t).currentTarget=e}function Wf(t,e){H(t).passiveListener=e}var Qf=new WeakMap,Yf=1,Hf=2,$n=3;function Wn(t){return t!==null&&typeof t=="object"}function ai(t){let e=Qf.get(t);if(e==null)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return e}function sb(t){return{get(){let r=ai(this).get(t);for(;r!=null;){if(r.listenerType===$n)return r.listener;r=r.next}return null},set(e){typeof e!="function"&&!Wn(e)&&(e=null);let r=ai(this),i=null,n=r.get(t);for(;n!=null;)n.listenerType===$n?i!==null?i.next=n.next:n.next!==null?r.set(t,n.next):r.delete(t):i=n,n=n.next;if(e!==null){let a={listener:e,listenerType:$n,passive:!1,once:!1,next:null};i===null?r.set(t,a):i.next=a}},configurable:!0,enumerable:!0}}function uo(t,e){Object.defineProperty(t,`on${e}`,sb(e))}function Jf(t){function e(){qe.call(this)}e.prototype=Object.create(qe.prototype,{constructor:{value:e,configurable:!0,writable:!0}});for(let r=0;r<t.length;++r)uo(e.prototype,t[r]);return e}function qe(){if(this instanceof qe){Qf.set(this,new Map);return}if(arguments.length===1&&Array.isArray(arguments[0]))return Jf(arguments[0]);if(arguments.length>0){let t=new Array(arguments.length);for(let e=0;e<arguments.length;++e)t[e]=arguments[e];return Jf(t)}throw new TypeError("Cannot call a class as a function")}qe.prototype={addEventListener(t,e,r){if(e==null)return;if(typeof e!="function"&&!Wn(e))throw new TypeError("'listener' should be a function or an object.");let i=ai(this),n=Wn(r),o=(n?!!r.capture:!!r)?Yf:Hf,c={listener:e,listenerType:o,passive:n&&!!r.passive,once:n&&!!r.once,next:null},l=i.get(t);if(l===void 0){i.set(t,c);return}let s=null;for(;l!=null;){if(l.listener===e&&l.listenerType===o)return;s=l,l=l.next}s.next=c},removeEventListener(t,e,r){if(e==null)return;let i=ai(this),a=(Wn(r)?!!r.capture:!!r)?Yf:Hf,o=null,c=i.get(t);for(;c!=null;){if(c.listener===e&&c.listenerType===a){o!==null?o.next=c.next:c.next!==null?i.set(t,c.next):i.delete(t);return}o=c,c=c.next}},dispatchEvent(t){if(t==null||typeof t.type!="string")throw new TypeError('"event.type" should be a string.');let e=ai(this),r=t.type,i=e.get(r);if(i==null)return!0;let n=tb(this,t),a=null;for(;i!=null;){if(i.once?a!==null?a.next=i.next:i.next!==null?e.set(r,i.next):e.delete(r):a=i,Wf(n,i.passive?i.listener:null),typeof i.listener=="function")try{i.listener.call(this,n)}catch(o){typeof console<"u"&&typeof console.error=="function"&&console.error(o)}else i.listenerType!==$n&&typeof i.listener.handleEvent=="function"&&i.listener.handleEvent(n);if(rb(n))break;i=i.next}return Wf(n,null),ib(n,0),nb(n,null),!n.defaultPrevented}};Object.defineProperty(qe.prototype,"constructor",{value:qe,configurable:!0,writable:!0});typeof window<"u"&&typeof window.EventTarget<"u"&&Object.setPrototypeOf(qe.prototype,window.EventTarget.prototype);ci.defineEventAttribute=uo;ci.EventTarget=qe;ci.default=qe;oi.exports=qe;oi.exports.EventTarget=oi.exports.default=qe;oi.exports.defineEventAttribute=uo});var Br=b(eh=>{var p={};p.Offset;p.Table;p.SIZEOF_SHORT=2;p.SIZEOF_INT=4;p.FILE_IDENTIFIER_LENGTH=4;p.Encoding={UTF8_BYTES:1,UTF16_STRING:2};p.int32=new Int32Array(2);p.float32=new Float32Array(p.int32.buffer);p.float64=new Float64Array(p.int32.buffer);p.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;p.Long=function(t,e){this.low=t|0,this.high=e|0};p.Long.create=function(t,e){return t==0&&e==0?p.Long.ZERO:new p.Long(t,e)};p.Long.prototype.toFloat64=function(){return(this.low>>>0)+this.high*4294967296};p.Long.prototype.equals=function(t){return this.low==t.low&&this.high==t.high};p.Long.ZERO=new p.Long(0,0);p.Builder=function(t){if(t)var e=t;else var e=1024;this.bb=p.ByteBuffer.allocate(e),this.space=e,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1};p.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1};p.Builder.prototype.forceDefaults=function(t){this.force_defaults=t};p.Builder.prototype.dataBuffer=function(){return this.bb};p.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())};p.Builder.prototype.prep=function(t,e){t>this.minalign&&(this.minalign=t);for(var r=~(this.bb.capacity()-this.space+e)+1&t-1;this.space<r+t+e;){var i=this.bb.capacity();this.bb=p.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-i}this.pad(r)};p.Builder.prototype.pad=function(t){for(var e=0;e<t;e++)this.bb.writeInt8(--this.space,0)};p.Builder.prototype.writeInt8=function(t){this.bb.writeInt8(this.space-=1,t)};p.Builder.prototype.writeInt16=function(t){this.bb.writeInt16(this.space-=2,t)};p.Builder.prototype.writeInt32=function(t){this.bb.writeInt32(this.space-=4,t)};p.Builder.prototype.writeInt64=function(t){this.bb.writeInt64(this.space-=8,t)};p.Builder.prototype.writeFloat32=function(t){this.bb.writeFloat32(this.space-=4,t)};p.Builder.prototype.writeFloat64=function(t){this.bb.writeFloat64(this.space-=8,t)};p.Builder.prototype.addInt8=function(t){this.prep(1,0),this.writeInt8(t)};p.Builder.prototype.addInt16=function(t){this.prep(2,0),this.writeInt16(t)};p.Builder.prototype.addInt32=function(t){this.prep(4,0),this.writeInt32(t)};p.Builder.prototype.addInt64=function(t){this.prep(8,0),this.writeInt64(t)};p.Builder.prototype.addFloat32=function(t){this.prep(4,0),this.writeFloat32(t)};p.Builder.prototype.addFloat64=function(t){this.prep(8,0),this.writeFloat64(t)};p.Builder.prototype.addFieldInt8=function(t,e,r){(this.force_defaults||e!=r)&&(this.addInt8(e),this.slot(t))};p.Builder.prototype.addFieldInt16=function(t,e,r){(this.force_defaults||e!=r)&&(this.addInt16(e),this.slot(t))};p.Builder.prototype.addFieldInt32=function(t,e,r){(this.force_defaults||e!=r)&&(this.addInt32(e),this.slot(t))};p.Builder.prototype.addFieldInt64=function(t,e,r){(this.force_defaults||!e.equals(r))&&(this.addInt64(e),this.slot(t))};p.Builder.prototype.addFieldFloat32=function(t,e,r){(this.force_defaults||e!=r)&&(this.addFloat32(e),this.slot(t))};p.Builder.prototype.addFieldFloat64=function(t,e,r){(this.force_defaults||e!=r)&&(this.addFloat64(e),this.slot(t))};p.Builder.prototype.addFieldOffset=function(t,e,r){(this.force_defaults||e!=r)&&(this.addOffset(e),this.slot(t))};p.Builder.prototype.addFieldStruct=function(t,e,r){e!=r&&(this.nested(e),this.slot(t))};p.Builder.prototype.nested=function(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")};p.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")};p.Builder.prototype.slot=function(t){this.vtable[t]=this.offset()};p.Builder.prototype.offset=function(){return this.bb.capacity()-this.space};p.Builder.growByteBuffer=function(t){var e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var r=e<<1,i=p.ByteBuffer.allocate(r);return i.setPosition(r-e),i.bytes().set(t.bytes(),r-e),i};p.Builder.prototype.addOffset=function(t){this.prep(p.SIZEOF_INT,0),this.writeInt32(this.offset()-t+p.SIZEOF_INT)};p.Builder.prototype.startObject=function(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(var e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()};p.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var t=this.offset(),e=this.vtable_in_use-1;e>=0&&this.vtable[e]==0;e--);for(var r=e+1;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);var i=2;this.addInt16(t-this.object_start);var n=(r+i)*p.SIZEOF_SHORT;this.addInt16(n);var a=0,o=this.space;e:for(e=0;e<this.vtables.length;e++){var c=this.bb.capacity()-this.vtables[e];if(n==this.bb.readInt16(c)){for(var l=p.SIZEOF_SHORT;l<n;l+=p.SIZEOF_SHORT)if(this.bb.readInt16(o+l)!=this.bb.readInt16(c+l))continue e;a=this.vtables[e];break}}return a?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,a-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t};p.Builder.prototype.finish=function(t,e){if(e){var r=e;if(this.prep(this.minalign,p.SIZEOF_INT+p.FILE_IDENTIFIER_LENGTH),r.length!=p.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+p.FILE_IDENTIFIER_LENGTH);for(var i=p.FILE_IDENTIFIER_LENGTH-1;i>=0;i--)this.writeInt8(r.charCodeAt(i))}this.prep(this.minalign,p.SIZEOF_INT),this.addOffset(t),this.bb.setPosition(this.space)};p.Builder.prototype.requiredField=function(t,e){var r=this.bb.capacity()-t,i=r-this.bb.readInt32(r),n=this.bb.readInt16(i+e)!=0;if(!n)throw new Error("FlatBuffers: field "+e+" must be set")};p.Builder.prototype.startVector=function(t,e,r){this.notNested(),this.vector_num_elems=e,this.prep(p.SIZEOF_INT,t*e),this.prep(r,t*e)};p.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()};p.Builder.prototype.createString=function(t){if(t instanceof Uint8Array)var e=t;else for(var e=[],r=0;r<t.length;){var i,n=t.charCodeAt(r++);if(n<55296||n>=56320)i=n;else{var a=t.charCodeAt(r++);i=(n<<10)+a+-56613888}i<128?e.push(i):(i<2048?e.push(i>>6&31|192):(i<65536?e.push(i>>12&15|224):e.push(i>>18&7|240,i>>12&63|128),e.push(i>>6&63|128)),e.push(i&63|128))}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(var r=0,o=this.space,c=this.bb.bytes();r<e.length;r++)c[o++]=e[r];return this.endVector()};p.Builder.prototype.createLong=function(t,e){return p.Long.create(t,e)};p.ByteBuffer=function(t){this.bytes_=t,this.position_=0};p.ByteBuffer.allocate=function(t){return new p.ByteBuffer(new Uint8Array(t))};p.ByteBuffer.prototype.clear=function(){this.position_=0};p.ByteBuffer.prototype.bytes=function(){return this.bytes_};p.ByteBuffer.prototype.position=function(){return this.position_};p.ByteBuffer.prototype.setPosition=function(t){this.position_=t};p.ByteBuffer.prototype.capacity=function(){return this.bytes_.length};p.ByteBuffer.prototype.readInt8=function(t){return this.readUint8(t)<<24>>24};p.ByteBuffer.prototype.readUint8=function(t){return this.bytes_[t]};p.ByteBuffer.prototype.readInt16=function(t){return this.readUint16(t)<<16>>16};p.ByteBuffer.prototype.readUint16=function(t){return this.bytes_[t]|this.bytes_[t+1]<<8};p.ByteBuffer.prototype.readInt32=function(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24};p.ByteBuffer.prototype.readUint32=function(t){return this.readInt32(t)>>>0};p.ByteBuffer.prototype.readInt64=function(t){return new p.Long(this.readInt32(t),this.readInt32(t+4))};p.ByteBuffer.prototype.readUint64=function(t){return new p.Long(this.readUint32(t),this.readUint32(t+4))};p.ByteBuffer.prototype.readFloat32=function(t){return p.int32[0]=this.readInt32(t),p.float32[0]};p.ByteBuffer.prototype.readFloat64=function(t){return p.int32[p.isLittleEndian?0:1]=this.readInt32(t),p.int32[p.isLittleEndian?1:0]=this.readInt32(t+4),p.float64[0]};p.ByteBuffer.prototype.writeInt8=function(t,e){this.bytes_[t]=e};p.ByteBuffer.prototype.writeUint8=function(t,e){this.bytes_[t]=e};p.ByteBuffer.prototype.writeInt16=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8};p.ByteBuffer.prototype.writeUint16=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8};p.ByteBuffer.prototype.writeInt32=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24};p.ByteBuffer.prototype.writeUint32=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24};p.ByteBuffer.prototype.writeInt64=function(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)};p.ByteBuffer.prototype.writeUint64=function(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)};p.ByteBuffer.prototype.writeFloat32=function(t,e){p.float32[0]=e,this.writeInt32(t,p.int32[0])};p.ByteBuffer.prototype.writeFloat64=function(t,e){p.float64[0]=e,this.writeInt32(t,p.int32[p.isLittleEndian?0:1]),this.writeInt32(t+4,p.int32[p.isLittleEndian?1:0])};p.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+p.SIZEOF_INT+p.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var t="",e=0;e<p.FILE_IDENTIFIER_LENGTH;e++)t+=String.fromCharCode(this.readInt8(this.position_+p.SIZEOF_INT+e));return t};p.ByteBuffer.prototype.__offset=function(t,e){var r=t-this.readInt32(t);return e<this.readInt16(r)?this.readInt16(r+e):0};p.ByteBuffer.prototype.__union=function(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t};p.ByteBuffer.prototype.__string=function(t,e){t+=this.readInt32(t);var r=this.readInt32(t),i="",n=0;if(t+=p.SIZEOF_INT,e===p.Encoding.UTF8_BYTES)return this.bytes_.subarray(t,t+r);for(;n<r;){var a,o=this.readUint8(t+n++);if(o<192)a=o;else{var c=this.readUint8(t+n++);if(o<224)a=(o&31)<<6|c&63;else{var l=this.readUint8(t+n++);if(o<240)a=(o&15)<<12|(c&63)<<6|l&63;else{var s=this.readUint8(t+n++);a=(o&7)<<18|(c&63)<<12|(l&63)<<6|s&63}}}a<65536?i+=String.fromCharCode(a):(a-=65536,i+=String.fromCharCode((a>>10)+55296,(a&1023)+56320))}return i};p.ByteBuffer.prototype.__indirect=function(t){return t+this.readInt32(t)};p.ByteBuffer.prototype.__vector=function(t){return t+this.readInt32(t)+p.SIZEOF_INT};p.ByteBuffer.prototype.__vector_len=function(t){return this.readInt32(t+this.readInt32(t))};p.ByteBuffer.prototype.__has_identifier=function(t){if(t.length!=p.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+p.FILE_IDENTIFIER_LENGTH);for(var e=0;e<p.FILE_IDENTIFIER_LENGTH;e++)if(t.charCodeAt(e)!=this.readInt8(this.position_+p.SIZEOF_INT+e))return!1;return!0};p.ByteBuffer.prototype.createLong=function(t,e){return p.Long.create(t,e)};eh.flatbuffers=p});var th=b(ho=>{"use strict";function dt(t,e,r){return e<=t&&t<=r}function Kn(t){if(t===void 0)return{};if(t===Object(t))return t;throw TypeError("Could not convert argument to dictionary")}function ab(t){for(var e=String(t),r=e.length,i=0,n=[];i<r;){var a=e.charCodeAt(i);if(a<55296||a>57343)n.push(a);else if(56320<=a&&a<=57343)n.push(65533);else if(55296<=a&&a<=56319)if(i===r-1)n.push(65533);else{var o=t.charCodeAt(i+1);if(56320<=o&&o<=57343){var c=a&1023,l=o&1023;n.push(65536+(c<<10)+l),i+=1}else n.push(65533)}i+=1}return n}function ob(t){for(var e="",r=0;r<t.length;++r){var i=t[r];i<=65535?e+=String.fromCharCode(i):(i-=65536,e+=String.fromCharCode((i>>10)+55296,(i&1023)+56320))}return e}var Yn=-1;function fo(t){this.tokens=[].slice.call(t)}fo.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():Yn},prepend:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.unshift(e.pop());else this.tokens.unshift(t)},push:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.push(e.shift());else this.tokens.push(t)}};var Tr=-1;function lo(t,e){if(t)throw TypeError("Decoder error");return e||65533}var Hn="utf-8";function Jn(t,e){if(!(this instanceof Jn))return new Jn(t,e);if(t=t!==void 0?String(t).toLowerCase():Hn,t!==Hn)throw new Error("Encoding not supported. Only utf-8 is supported");e=Kn(e),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=!!e.fatal,this._ignoreBOM=!!e.ignoreBOM,Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}Jn.prototype={decode:function(e,r){var i;typeof e=="object"&&e instanceof ArrayBuffer?i=new Uint8Array(e):typeof e=="object"&&"buffer"in e&&e.buffer instanceof ArrayBuffer?i=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):i=new Uint8Array(0),r=Kn(r),this._streaming||(this._decoder=new cb({fatal:this._fatal}),this._BOMseen=!1),this._streaming=!!r.stream;for(var n=new fo(i),a=[],o;!n.endOfStream()&&(o=this._decoder.handler(n,n.read()),o!==Tr);)o!==null&&(Array.isArray(o)?a.push.apply(a,o):a.push(o));if(!this._streaming){do{if(o=this._decoder.handler(n,n.read()),o===Tr)break;o!==null&&(Array.isArray(o)?a.push.apply(a,o):a.push(o))}while(!n.endOfStream());this._decoder=null}return a.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(a[0]===65279?(this._BOMseen=!0,a.shift()):this._BOMseen=!0),ob(a)}};function Gn(t,e){if(!(this instanceof Gn))return new Gn(t,e);if(t=t!==void 0?String(t).toLowerCase():Hn,t!==Hn)throw new Error("Encoding not supported. Only utf-8 is supported");e=Kn(e),this._streaming=!1,this._encoder=null,this._options={fatal:!!e.fatal},Object.defineProperty(this,"encoding",{value:"utf-8"})}Gn.prototype={encode:function(e,r){e=e?String(e):"",r=Kn(r),this._streaming||(this._encoder=new ub(this._options)),this._streaming=!!r.stream;for(var i=[],n=new fo(ab(e)),a;!n.endOfStream()&&(a=this._encoder.handler(n,n.read()),a!==Tr);)Array.isArray(a)?i.push.apply(i,a):i.push(a);if(!this._streaming){for(;a=this._encoder.handler(n,n.read()),a!==Tr;)Array.isArray(a)?i.push.apply(i,a):i.push(a);this._encoder=null}return new Uint8Array(i)}};function cb(t){var e=t.fatal,r=0,i=0,n=0,a=128,o=191;this.handler=function(c,l){if(l===Yn&&n!==0)return n=0,lo(e);if(l===Yn)return Tr;if(n===0){if(dt(l,0,127))return l;if(dt(l,194,223))n=1,r=l-192;else if(dt(l,224,239))l===224&&(a=160),l===237&&(o=159),n=2,r=l-224;else if(dt(l,240,244))l===240&&(a=144),l===244&&(o=143),n=3,r=l-240;else return lo(e);return r=r<<6*n,null}if(!dt(l,a,o))return r=n=i=0,a=128,o=191,c.prepend(l),lo(e);if(a=128,o=191,i+=1,r+=l-128<<6*(n-i),i!==n)return null;var s=r;return r=n=i=0,s}}function ub(t){var e=t.fatal;this.handler=function(r,i){if(i===Yn)return Tr;if(dt(i,0,127))return i;var n,a;dt(i,128,2047)?(n=1,a=192):dt(i,2048,65535)?(n=2,a=224):dt(i,65536,1114111)&&(n=3,a=240);for(var o=[(i>>6*n)+a];n>0;){var c=i>>6*(n-1);o.push(128|c&63),n-=1}return o}}ho.TextEncoder=Gn;ho.TextDecoder=Jn});var Pt=b(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:!0});var rh=se(),ih=th(),Zn=typeof Buffer=="function"?Buffer:null,nh=typeof TextDecoder=="function"&&typeof TextEncoder=="function";Qn.decodeUtf8=(t=>{if(nh||!Zn){let e=new t("utf-8");return r=>e.decode(r)}return e=>{let{buffer:r,byteOffset:i,length:n}=rh.toUint8Array(e);return Zn.from(r,i,n).toString()}})(typeof TextDecoder<"u"?TextDecoder:ih.TextDecoder);Qn.encodeUtf8=(t=>{if(nh||!Zn){let e=new t;return r=>e.encode(r)}return(e="")=>rh.toUint8Array(Zn.from(e,"utf8"))})(typeof TextEncoder<"u"?TextEncoder:ih.TextEncoder)});var Ir=b(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:!0});var sh=ui();Xe.ITERATOR_DONE=Object.freeze({done:!0,value:void 0});var po=class{constructor(e){this._json=e}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}};Xe.ArrowJSON=po;var Xn=class{tee(){return this._getDOMStream().tee()}pipe(e,r){return this._getNodeStream().pipe(e,r)}pipeTo(e,r){return this._getDOMStream().pipeTo(e,r)}pipeThrough(e,r){return this._getDOMStream().pipeThrough(e,r)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}};Xe.ReadableInterop=Xn;var yo=class extends Xn{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}get closed(){return this._closedPromise}async cancel(e){await this.return(e)}write(e){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(e):this.resolvers.shift().resolve({done:!1,value:e}))}abort(e){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:e}:this.resolvers.shift().reject({done:!0,value:e}))}close(){if(this._closedPromiseResolve){let{resolvers:e}=this;for(;e.length>0;)e.shift().resolve(Xe.ITERATOR_DONE);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(e){return sh.default.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,e)}toNodeStream(e){return sh.default.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,e)}async throw(e){return await this.abort(e),Xe.ITERATOR_DONE}async return(e){return await this.close(),Xe.ITERATOR_DONE}async read(e){return(await this.next(e,"read")).value}async peek(e){return(await this.next(e,"peek")).value}next(...e){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((r,i)=>{this.resolvers.push({resolve:r,reject:i})}):Promise.resolve(Xe.ITERATOR_DONE)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error(`${this} is closed`)}};Xe.AsyncQueue=yo});var _e=b(E=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var es=Ir(),[lb,db]=(()=>{let t=()=>{throw new Error("BigInt is not available in this environment")};function e(){throw t()}return e.asIntN=()=>{throw t()},e.asUintN=()=>{throw t()},typeof BigInt<"u"?[BigInt,!0]:[e,!1]})();E.BigInt=lb;E.BigIntAvailable=db;var[fb,hb]=(()=>{let t=()=>{throw new Error("BigInt64Array is not available in this environment")};class e{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}}return typeof BigInt64Array<"u"?[BigInt64Array,!0]:[e,!1]})();E.BigInt64Array=fb;E.BigInt64ArrayAvailable=hb;var[pb,yb]=(()=>{let t=()=>{throw new Error("BigUint64Array is not available in this environment")};class e{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}}return typeof BigUint64Array<"u"?[BigUint64Array,!0]:[e,!1]})();E.BigUint64Array=pb;E.BigUint64ArrayAvailable=yb;var mo=t=>typeof t=="number",ah=t=>typeof t=="boolean",pe=t=>typeof t=="function";E.isObject=t=>t!=null&&Object(t)===t;E.isPromise=t=>E.isObject(t)&&pe(t.then);E.isObservable=t=>E.isObject(t)&&pe(t.subscribe);E.isIterable=t=>E.isObject(t)&&pe(t[Symbol.iterator]);E.isAsyncIterable=t=>E.isObject(t)&&pe(t[Symbol.asyncIterator]);E.isArrowJSON=t=>E.isObject(t)&&E.isObject(t.schema);E.isArrayLike=t=>E.isObject(t)&&mo(t.length);E.isIteratorResult=t=>E.isObject(t)&&"done"in t&&"value"in t;E.isUnderlyingSink=t=>E.isObject(t)&&pe(t.abort)&&pe(t.close)&&pe(t.start)&&pe(t.write);E.isFileHandle=t=>E.isObject(t)&&pe(t.stat)&&mo(t.fd);E.isFSReadStream=t=>E.isReadableNodeStream(t)&&mo(t.bytesRead);E.isFetchResponse=t=>E.isObject(t)&&E.isReadableDOMStream(t.body);E.isWritableDOMStream=t=>E.isObject(t)&&pe(t.abort)&&pe(t.getWriter)&&!(t instanceof es.ReadableInterop);E.isReadableDOMStream=t=>E.isObject(t)&&pe(t.cancel)&&pe(t.getReader)&&!(t instanceof es.ReadableInterop);E.isWritableNodeStream=t=>E.isObject(t)&&pe(t.end)&&pe(t.write)&&ah(t.writable)&&!(t instanceof es.ReadableInterop);E.isReadableNodeStream=t=>E.isObject(t)&&pe(t.read)&&pe(t.pipe)&&ah(t.readable)&&!(t instanceof es.ReadableInterop)});var se=b(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});var mb=Br(),bb=Pt(),_b=mb.flatbuffers.ByteBuffer,zt=_e(),go=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function gb(t){let e=t[0]?[t[0]]:[],r,i,n,a;for(let o,c,l=0,s=0,u=t.length;++l<u;){if(o=e[s],c=t[l],!o||!c||o.buffer!==c.buffer||c.byteOffset<o.byteOffset){c&&(e[++s]=c);continue}if({byteOffset:r,byteLength:n}=o,{byteOffset:i,byteLength:a}=c,r+n<i||i+a<r){c&&(e[++s]=c);continue}e[s]=new Uint8Array(o.buffer,r,i-r+a)}return e}function bo(t,e,r=0,i=e.byteLength){let n=t.byteLength,a=new Uint8Array(t.buffer,t.byteOffset,n),o=new Uint8Array(e.buffer,e.byteOffset,Math.min(i,n));return a.set(o,r),t}q.memcpy=bo;function vb(t,e){let r=gb(t),i=r.reduce((u,y)=>u+y.byteLength,0),n,a,o,c=0,l=-1,s=Math.min(e||1/0,i);for(let u=r.length;++l<u;){if(n=r[l],a=n.subarray(0,Math.min(n.length,s-c)),s<=c+a.length){a.length<n.length?r[l]=n.subarray(a.length):a.length===n.length&&l++,o?bo(o,a,c):o=a;break}bo(o||(o=new Uint8Array(s)),a,c),c+=a.length}return[o||new Uint8Array(0),r.slice(l),i-(o?o.byteLength:0)]}q.joinUint8Arrays=vb;function ge(t,e){let r=zt.isIteratorResult(e)?e.value:e;return r instanceof t?t===Uint8Array?new t(r.buffer,r.byteOffset,r.byteLength):r:r?(typeof r=="string"&&(r=bb.encodeUtf8(r)),r instanceof ArrayBuffer?new t(r):r instanceof go?new t(r):r instanceof _b?ge(t,r.bytes()):ArrayBuffer.isView(r)?r.byteLength<=0?new t(0):new t(r.buffer,r.byteOffset,r.byteLength/t.BYTES_PER_ELEMENT):t.from(r)):new t(0)}q.toArrayBufferView=ge;q.toInt8Array=t=>ge(Int8Array,t);q.toInt16Array=t=>ge(Int16Array,t);q.toInt32Array=t=>ge(Int32Array,t);q.toBigInt64Array=t=>ge(zt.BigInt64Array,t);q.toUint8Array=t=>ge(Uint8Array,t);q.toUint16Array=t=>ge(Uint16Array,t);q.toUint32Array=t=>ge(Uint32Array,t);q.toBigUint64Array=t=>ge(zt.BigUint64Array,t);q.toFloat32Array=t=>ge(Float32Array,t);q.toFloat64Array=t=>ge(Float64Array,t);q.toUint8ClampedArray=t=>ge(Uint8ClampedArray,t);var _o=t=>(t.next(),t);function*et(t,e){let r=function*(n){yield n},i=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof go?r(e):zt.isIterable(e)?e:r(e);yield*_o((function*(n){let a=null;do a=n.next(yield ge(t,a));while(!a.done)})(i[Symbol.iterator]()))}q.toArrayBufferViewIterator=et;q.toInt8ArrayIterator=t=>et(Int8Array,t);q.toInt16ArrayIterator=t=>et(Int16Array,t);q.toInt32ArrayIterator=t=>et(Int32Array,t);q.toUint8ArrayIterator=t=>et(Uint8Array,t);q.toUint16ArrayIterator=t=>et(Uint16Array,t);q.toUint32ArrayIterator=t=>et(Uint32Array,t);q.toFloat32ArrayIterator=t=>et(Float32Array,t);q.toFloat64ArrayIterator=t=>et(Float64Array,t);q.toUint8ClampedArrayIterator=t=>et(Uint8ClampedArray,t);async function*Ce(t,e){if(zt.isPromise(e))return yield*Ce(t,await e);let r=async function*(a){yield await a},i=async function*(a){yield*_o((function*(o){let c=null;do c=o.next(yield c&&c.value);while(!c.done)})(a[Symbol.iterator]()))},n=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof go?r(e):zt.isIterable(e)?i(e):zt.isAsyncIterable(e)?e:r(e);yield*_o((async function*(a){let o=null;do o=await a.next(yield ge(t,o));while(!o.done)})(n[Symbol.asyncIterator]()))}q.toArrayBufferViewAsyncIterator=Ce;q.toInt8ArrayAsyncIterator=t=>Ce(Int8Array,t);q.toInt16ArrayAsyncIterator=t=>Ce(Int16Array,t);q.toInt32ArrayAsyncIterator=t=>Ce(Int32Array,t);q.toUint8ArrayAsyncIterator=t=>Ce(Uint8Array,t);q.toUint16ArrayAsyncIterator=t=>Ce(Uint16Array,t);q.toUint32ArrayAsyncIterator=t=>Ce(Uint32Array,t);q.toFloat32ArrayAsyncIterator=t=>Ce(Float32Array,t);q.toFloat64ArrayAsyncIterator=t=>Ce(Float64Array,t);q.toUint8ClampedArrayAsyncIterator=t=>Ce(Uint8ClampedArray,t);function wb(t,e,r){if(t!==0){r=r.slice(0,e+1);for(let i=-1;++i<=e;)r[i]+=t}return r}q.rebaseValueOffsets=wb;function Bb(t,e){let r=0,i=t.length;if(i!==e.length)return!1;if(i>0)do if(t[r]!==e[r])return!1;while(++r<i);return!0}q.compareArrayLike=Bb});var ui=b(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});var ve=se();Bo.default={fromIterable(t){return ts(Tb(t))},fromAsyncIterable(t){return ts(Ib(t))},fromDOMStream(t){return ts(Sb(t))},fromNodeStream(t){return ts(Ab(t))},toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}};var ts=t=>(t.next(),t);function*Tb(t){let e,r=!1,i=[],n,a,o,c=0;function l(){return a==="peek"?ve.joinUint8Arrays(i,o)[0]:([n,i,c]=ve.joinUint8Arrays(i,o),n)}({cmd:a,size:o}=yield null);let s=ve.toUint8ArrayIterator(t)[Symbol.iterator]();try{do if({done:e,value:n}=isNaN(o-c)?s.next(void 0):s.next(o-c),!e&&n.byteLength>0&&(i.push(n),c+=n.byteLength),e||o<=c)do({cmd:a,size:o}=yield l());while(o<c);while(!e)}catch(u){(r=!0)&&typeof s.throw=="function"&&s.throw(u)}finally{r===!1&&typeof s.return=="function"&&s.return()}}async function*Ib(t){let e,r=!1,i=[],n,a,o,c=0;function l(){return a==="peek"?ve.joinUint8Arrays(i,o)[0]:([n,i,c]=ve.joinUint8Arrays(i,o),n)}({cmd:a,size:o}=yield null);let s=ve.toUint8ArrayAsyncIterator(t)[Symbol.asyncIterator]();try{do if({done:e,value:n}=isNaN(o-c)?await s.next(void 0):await s.next(o-c),!e&&n.byteLength>0&&(i.push(n),c+=n.byteLength),e||o<=c)do({cmd:a,size:o}=yield l());while(o<c);while(!e)}catch(u){(r=!0)&&typeof s.throw=="function"&&await s.throw(u)}finally{r===!1&&typeof s.return=="function"&&await s.return()}}async function*Sb(t){let e=!1,r=!1,i=[],n,a,o,c=0;function l(){return a==="peek"?ve.joinUint8Arrays(i,o)[0]:([n,i,c]=ve.joinUint8Arrays(i,o),n)}({cmd:a,size:o}=yield null);let s=new wo(t);try{do if({done:e,value:n}=isNaN(o-c)?await s.read(void 0):await s.read(o-c),!e&&n.byteLength>0&&(i.push(ve.toUint8Array(n)),c+=n.byteLength),e||o<=c)do({cmd:a,size:o}=yield l());while(o<c);while(!e)}catch(u){(r=!0)&&await s.cancel(u)}finally{r===!1?await s.cancel():t.locked&&s.releaseLock()}}var wo=class{constructor(e){this.source=e,this.byobReader=null,this.defaultReader=null;try{this.supportsBYOB=!!(this.reader=this.getBYOBReader())}catch{this.supportsBYOB=!(this.reader=this.getDefaultReader())}}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=this.byobReader=this.defaultReader=null}async cancel(e){let{reader:r,source:i}=this;r&&await r.cancel(e).catch(()=>{}),i&&i.locked&&this.releaseLock()}async read(e){if(e===0)return{done:this.reader==null,value:new Uint8Array(0)};let r=!this.supportsBYOB||typeof e!="number"?await this.getDefaultReader().read():await this.readFromBYOBReader(e);return!r.done&&(r.value=ve.toUint8Array(r)),r}getDefaultReader(){return this.byobReader&&this.releaseLock(),this.defaultReader||(this.defaultReader=this.source.getReader(),this.defaultReader.closed.catch(()=>{})),this.reader=this.defaultReader}getBYOBReader(){return this.defaultReader&&this.releaseLock(),this.byobReader||(this.byobReader=this.source.getReader({mode:"byob"}),this.byobReader.closed.catch(()=>{})),this.reader=this.byobReader}async readFromBYOBReader(e){return await oh(this.getBYOBReader(),new ArrayBuffer(e),0,e)}};async function oh(t,e,r,i){if(r>=i)return{done:!1,value:new Uint8Array(e,0,i)};let{done:n,value:a}=await t.read(new Uint8Array(e,r,i-r));return(r+=a.byteLength)<i&&!n?await oh(t,a.buffer,r,i):{done:n,value:new Uint8Array(a.buffer,0,r)}}var vo=(t,e)=>{let r=n=>i([e,n]),i;return[e,r,new Promise(n=>(i=n)&&t.once(e,r))]};async function*Ab(t){let e=[],r="error",i=!1,n=null,a,o,c=0,l=[],s;function u(){return a==="peek"?ve.joinUint8Arrays(l,o)[0]:([s,l,c]=ve.joinUint8Arrays(l,o),s)}if({cmd:a,size:o}=yield null,t.isTTY)return yield new Uint8Array(0);try{e[0]=vo(t,"end"),e[1]=vo(t,"error");do{if(e[2]=vo(t,"readable"),[r,n]=await Promise.race(e.map(w=>w[2])),r==="error")break;if((i=r==="end")||(isFinite(o-c)?(s=ve.toUint8Array(t.read(o-c)),s.byteLength<o-c&&(s=ve.toUint8Array(t.read(void 0)))):s=ve.toUint8Array(t.read(void 0)),s.byteLength>0&&(l.push(s),c+=s.byteLength)),i||o<=c)do({cmd:a,size:o}=yield u());while(o<c)}while(!i)}finally{await y(e,r==="error"?n:null)}function y(w,C){return s=l=null,new Promise(async(Be,gr)=>{for(let[Tt,pm]of w)t.off(Tt,pm);try{let Tt=t.destroy;Tt&&Tt.call(t,C),C=void 0}catch(Tt){C=Tt||C}finally{C!=null?gr(C):Be()}})}}});var ie=b(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});var rs=class{};is.AbstractVector=rs;is.Vector=rs});var Sr=b(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});var k;(function(t){var e;(function(r){var i;(function(n){var a;(function(o){let c;(function(l){l[l.V1=0]="V1",l[l.V2=1]="V2",l[l.V3=2]="V3",l[l.V4=3]="V4"})(c=o.MetadataVersion||(o.MetadataVersion={}))})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){let c;(function(l){l[l.Sparse=0]="Sparse",l[l.Dense=1]="Dense"})(c=o.UnionMode||(o.UnionMode={}))})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){let c;(function(l){l[l.HALF=0]="HALF",l[l.SINGLE=1]="SINGLE",l[l.DOUBLE=2]="DOUBLE"})(c=o.Precision||(o.Precision={}))})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){let c;(function(l){l[l.DAY=0]="DAY",l[l.MILLISECOND=1]="MILLISECOND"})(c=o.DateUnit||(o.DateUnit={}))})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){let c;(function(l){l[l.SECOND=0]="SECOND",l[l.MILLISECOND=1]="MILLISECOND",l[l.MICROSECOND=2]="MICROSECOND",l[l.NANOSECOND=3]="NANOSECOND"})(c=o.TimeUnit||(o.TimeUnit={}))})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){let c;(function(l){l[l.YEAR_MONTH=0]="YEAR_MONTH",l[l.DAY_TIME=1]="DAY_TIME"})(c=o.IntervalUnit||(o.IntervalUnit={}))})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){let c;(function(l){l[l.NONE=0]="NONE",l[l.Null=1]="Null",l[l.Int=2]="Int",l[l.FloatingPoint=3]="FloatingPoint",l[l.Binary=4]="Binary",l[l.Utf8=5]="Utf8",l[l.Bool=6]="Bool",l[l.Decimal=7]="Decimal",l[l.Date=8]="Date",l[l.Time=9]="Time",l[l.Timestamp=10]="Timestamp",l[l.Interval=11]="Interval",l[l.List=12]="List",l[l.Struct_=13]="Struct_",l[l.Union=14]="Union",l[l.FixedSizeBinary=15]="FixedSizeBinary",l[l.FixedSizeList=16]="FixedSizeList",l[l.Map=17]="Map",l[l.Duration=18]="Duration",l[l.LargeBinary=19]="LargeBinary",l[l.LargeUtf8=20]="LargeUtf8",l[l.LargeList=21]="LargeList"})(c=o.Type||(o.Type={}))})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){let c;(function(l){l[l.Little=0]="Little",l[l.Big=1]="Big"})(c=o.Endianness||(o.Endianness={}))})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsNull(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}static startNull(s){s.startObject(0)}static endNull(s){return s.endObject()}static createNull(s){return c.startNull(s),c.endNull(s)}}o.Null=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsStruct_(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}static startStruct_(s){s.startObject(0)}static endStruct_(s){return s.endObject()}static createStruct_(s){return c.startStruct_(s),c.endStruct_(s)}}o.Struct_=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsList(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}static startList(s){s.startObject(0)}static endList(s){return s.endObject()}static createList(s){return c.startList(s),c.endList(s)}}o.List=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsLargeList(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}static startLargeList(s){s.startObject(0)}static endLargeList(s){return s.endObject()}static createLargeList(s){return c.startLargeList(s),c.endLargeList(s)}}o.LargeList=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsFixedSizeList(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}listSize(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt32(this.bb_pos+s):0}static startFixedSizeList(s){s.startObject(1)}static addListSize(s,u){s.addFieldInt32(0,u,0)}static endFixedSizeList(s){return s.endObject()}static createFixedSizeList(s,u){return c.startFixedSizeList(s),c.addListSize(s,u),c.endFixedSizeList(s)}}o.FixedSizeList=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsMap(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}keysSorted(){let s=this.bb.__offset(this.bb_pos,4);return s?!!this.bb.readInt8(this.bb_pos+s):!1}static startMap(s){s.startObject(1)}static addKeysSorted(s,u){s.addFieldInt8(0,+u,0)}static endMap(s){return s.endObject()}static createMap(s,u){return c.startMap(s),c.addKeysSorted(s,u),c.endMap(s)}}o.Map=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsUnion(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}mode(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):t.apache.arrow.flatbuf.UnionMode.Sparse}typeIds(s){let u=this.bb.__offset(this.bb_pos,6);return u?this.bb.readInt32(this.bb.__vector(this.bb_pos+u)+s*4):0}typeIdsLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}typeIdsArray(){let s=this.bb.__offset(this.bb_pos,6);return s?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+s),this.bb.__vector_len(this.bb_pos+s)):null}static startUnion(s){s.startObject(2)}static addMode(s,u){s.addFieldInt16(0,u,t.apache.arrow.flatbuf.UnionMode.Sparse)}static addTypeIds(s,u){s.addFieldOffset(1,u,0)}static createTypeIdsVector(s,u){s.startVector(4,u.length,4);for(let y=u.length-1;y>=0;y--)s.addInt32(u[y]);return s.endVector()}static startTypeIdsVector(s,u){s.startVector(4,u,4)}static endUnion(s){return s.endObject()}static createUnion(s,u,y){return c.startUnion(s),c.addMode(s,u),c.addTypeIds(s,y),c.endUnion(s)}}o.Union=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsInt(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}bitWidth(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt32(this.bb_pos+s):0}isSigned(){let s=this.bb.__offset(this.bb_pos,6);return s?!!this.bb.readInt8(this.bb_pos+s):!1}static startInt(s){s.startObject(2)}static addBitWidth(s,u){s.addFieldInt32(0,u,0)}static addIsSigned(s,u){s.addFieldInt8(1,+u,0)}static endInt(s){return s.endObject()}static createInt(s,u,y){return c.startInt(s),c.addBitWidth(s,u),c.addIsSigned(s,y),c.endInt(s)}}o.Int=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsFloatingPoint(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}precision(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):t.apache.arrow.flatbuf.Precision.HALF}static startFloatingPoint(s){s.startObject(1)}static addPrecision(s,u){s.addFieldInt16(0,u,t.apache.arrow.flatbuf.Precision.HALF)}static endFloatingPoint(s){return s.endObject()}static createFloatingPoint(s,u){return c.startFloatingPoint(s),c.addPrecision(s,u),c.endFloatingPoint(s)}}o.FloatingPoint=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsUtf8(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}static startUtf8(s){s.startObject(0)}static endUtf8(s){return s.endObject()}static createUtf8(s){return c.startUtf8(s),c.endUtf8(s)}}o.Utf8=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsBinary(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}static startBinary(s){s.startObject(0)}static endBinary(s){return s.endObject()}static createBinary(s){return c.startBinary(s),c.endBinary(s)}}o.Binary=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsLargeUtf8(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}static startLargeUtf8(s){s.startObject(0)}static endLargeUtf8(s){return s.endObject()}static createLargeUtf8(s){return c.startLargeUtf8(s),c.endLargeUtf8(s)}}o.LargeUtf8=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsLargeBinary(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}static startLargeBinary(s){s.startObject(0)}static endLargeBinary(s){return s.endObject()}static createLargeBinary(s){return c.startLargeBinary(s),c.endLargeBinary(s)}}o.LargeBinary=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsFixedSizeBinary(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}byteWidth(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt32(this.bb_pos+s):0}static startFixedSizeBinary(s){s.startObject(1)}static addByteWidth(s,u){s.addFieldInt32(0,u,0)}static endFixedSizeBinary(s){return s.endObject()}static createFixedSizeBinary(s,u){return c.startFixedSizeBinary(s),c.addByteWidth(s,u),c.endFixedSizeBinary(s)}}o.FixedSizeBinary=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsBool(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}static startBool(s){s.startObject(0)}static endBool(s){return s.endObject()}static createBool(s){return c.startBool(s),c.endBool(s)}}o.Bool=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsDecimal(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}precision(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt32(this.bb_pos+s):0}scale(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.readInt32(this.bb_pos+s):0}static startDecimal(s){s.startObject(2)}static addPrecision(s,u){s.addFieldInt32(0,u,0)}static addScale(s,u){s.addFieldInt32(1,u,0)}static endDecimal(s){return s.endObject()}static createDecimal(s,u,y){return c.startDecimal(s),c.addPrecision(s,u),c.addScale(s,y),c.endDecimal(s)}}o.Decimal=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsDate(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}unit(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):t.apache.arrow.flatbuf.DateUnit.MILLISECOND}static startDate(s){s.startObject(1)}static addUnit(s,u){s.addFieldInt16(0,u,t.apache.arrow.flatbuf.DateUnit.MILLISECOND)}static endDate(s){return s.endObject()}static createDate(s,u){return c.startDate(s),c.addUnit(s,u),c.endDate(s)}}o.Date=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsTime(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}unit(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):t.apache.arrow.flatbuf.TimeUnit.MILLISECOND}bitWidth(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.readInt32(this.bb_pos+s):32}static startTime(s){s.startObject(2)}static addUnit(s,u){s.addFieldInt16(0,u,t.apache.arrow.flatbuf.TimeUnit.MILLISECOND)}static addBitWidth(s,u){s.addFieldInt32(1,u,32)}static endTime(s){return s.endObject()}static createTime(s,u,y){return c.startTime(s),c.addUnit(s,u),c.addBitWidth(s,y),c.endTime(s)}}o.Time=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsTimestamp(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}unit(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):t.apache.arrow.flatbuf.TimeUnit.SECOND}timezone(s){let u=this.bb.__offset(this.bb_pos,6);return u?this.bb.__string(this.bb_pos+u,s):null}static startTimestamp(s){s.startObject(2)}static addUnit(s,u){s.addFieldInt16(0,u,t.apache.arrow.flatbuf.TimeUnit.SECOND)}static addTimezone(s,u){s.addFieldOffset(1,u,0)}static endTimestamp(s){return s.endObject()}static createTimestamp(s,u,y){return c.startTimestamp(s),c.addUnit(s,u),c.addTimezone(s,y),c.endTimestamp(s)}}o.Timestamp=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsInterval(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}unit(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):t.apache.arrow.flatbuf.IntervalUnit.YEAR_MONTH}static startInterval(s){s.startObject(1)}static addUnit(s,u){s.addFieldInt16(0,u,t.apache.arrow.flatbuf.IntervalUnit.YEAR_MONTH)}static endInterval(s){return s.endObject()}static createInterval(s,u){return c.startInterval(s),c.addUnit(s,u),c.endInterval(s)}}o.Interval=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsDuration(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}unit(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):t.apache.arrow.flatbuf.TimeUnit.MILLISECOND}static startDuration(s){s.startObject(1)}static addUnit(s,u){s.addFieldInt16(0,u,t.apache.arrow.flatbuf.TimeUnit.MILLISECOND)}static endDuration(s){return s.endObject()}static createDuration(s,u){return c.startDuration(s),c.addUnit(s,u),c.endDuration(s)}}o.Duration=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsKeyValue(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}key(s){let u=this.bb.__offset(this.bb_pos,4);return u?this.bb.__string(this.bb_pos+u,s):null}value(s){let u=this.bb.__offset(this.bb_pos,6);return u?this.bb.__string(this.bb_pos+u,s):null}static startKeyValue(s){s.startObject(2)}static addKey(s,u){s.addFieldOffset(0,u,0)}static addValue(s,u){s.addFieldOffset(1,u,0)}static endKeyValue(s){return s.endObject()}static createKeyValue(s,u,y){return c.startKeyValue(s),c.addKey(s,u),c.addValue(s,y),c.endKeyValue(s)}}o.KeyValue=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsDictionaryEncoding(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}id(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}indexType(s){let u=this.bb.__offset(this.bb_pos,6);return u?(s||new t.apache.arrow.flatbuf.Int).__init(this.bb.__indirect(this.bb_pos+u),this.bb):null}isOrdered(){let s=this.bb.__offset(this.bb_pos,8);return s?!!this.bb.readInt8(this.bb_pos+s):!1}static startDictionaryEncoding(s){s.startObject(3)}static addId(s,u){s.addFieldInt64(0,u,s.createLong(0,0))}static addIndexType(s,u){s.addFieldOffset(1,u,0)}static addIsOrdered(s,u){s.addFieldInt8(2,+u,0)}static endDictionaryEncoding(s){return s.endObject()}static createDictionaryEncoding(s,u,y,w){return c.startDictionaryEncoding(s),c.addId(s,u),c.addIndexType(s,y),c.addIsOrdered(s,w),c.endDictionaryEncoding(s)}}o.DictionaryEncoding=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsField(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}name(s){let u=this.bb.__offset(this.bb_pos,4);return u?this.bb.__string(this.bb_pos+u,s):null}nullable(){let s=this.bb.__offset(this.bb_pos,6);return s?!!this.bb.readInt8(this.bb_pos+s):!1}typeType(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.readUint8(this.bb_pos+s):t.apache.arrow.flatbuf.Type.NONE}type(s){let u=this.bb.__offset(this.bb_pos,10);return u?this.bb.__union(s,this.bb_pos+u):null}dictionary(s){let u=this.bb.__offset(this.bb_pos,12);return u?(s||new t.apache.arrow.flatbuf.DictionaryEncoding).__init(this.bb.__indirect(this.bb_pos+u),this.bb):null}children(s,u){let y=this.bb.__offset(this.bb_pos,14);return y?(u||new t.apache.arrow.flatbuf.Field).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+y)+s*4),this.bb):null}childrenLength(){let s=this.bb.__offset(this.bb_pos,14);return s?this.bb.__vector_len(this.bb_pos+s):0}customMetadata(s,u){let y=this.bb.__offset(this.bb_pos,16);return y?(u||new t.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+y)+s*4),this.bb):null}customMetadataLength(){let s=this.bb.__offset(this.bb_pos,16);return s?this.bb.__vector_len(this.bb_pos+s):0}static startField(s){s.startObject(7)}static addName(s,u){s.addFieldOffset(0,u,0)}static addNullable(s,u){s.addFieldInt8(1,+u,0)}static addTypeType(s,u){s.addFieldInt8(2,u,t.apache.arrow.flatbuf.Type.NONE)}static addType(s,u){s.addFieldOffset(3,u,0)}static addDictionary(s,u){s.addFieldOffset(4,u,0)}static addChildren(s,u){s.addFieldOffset(5,u,0)}static createChildrenVector(s,u){s.startVector(4,u.length,4);for(let y=u.length-1;y>=0;y--)s.addOffset(u[y]);return s.endVector()}static startChildrenVector(s,u){s.startVector(4,u,4)}static addCustomMetadata(s,u){s.addFieldOffset(6,u,0)}static createCustomMetadataVector(s,u){s.startVector(4,u.length,4);for(let y=u.length-1;y>=0;y--)s.addOffset(u[y]);return s.endVector()}static startCustomMetadataVector(s,u){s.startVector(4,u,4)}static endField(s){return s.endObject()}static createField(s,u,y,w,C,Be,gr,Tt){return c.startField(s),c.addName(s,u),c.addNullable(s,y),c.addTypeType(s,w),c.addType(s,C),c.addDictionary(s,Be),c.addChildren(s,gr),c.addCustomMetadata(s,Tt),c.endField(s)}}o.Field=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static createBuffer(s,u,y){return s.prep(8,16),s.writeInt64(y),s.writeInt64(u),s.offset()}}o.Buffer=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsSchema(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}endianness(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):t.apache.arrow.flatbuf.Endianness.Little}fields(s,u){let y=this.bb.__offset(this.bb_pos,6);return y?(u||new t.apache.arrow.flatbuf.Field).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+y)+s*4),this.bb):null}fieldsLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}customMetadata(s,u){let y=this.bb.__offset(this.bb_pos,8);return y?(u||new t.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+y)+s*4),this.bb):null}customMetadataLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}static startSchema(s){s.startObject(3)}static addEndianness(s,u){s.addFieldInt16(0,u,t.apache.arrow.flatbuf.Endianness.Little)}static addFields(s,u){s.addFieldOffset(1,u,0)}static createFieldsVector(s,u){s.startVector(4,u.length,4);for(let y=u.length-1;y>=0;y--)s.addOffset(u[y]);return s.endVector()}static startFieldsVector(s,u){s.startVector(4,u,4)}static addCustomMetadata(s,u){s.addFieldOffset(2,u,0)}static createCustomMetadataVector(s,u){s.startVector(4,u.length,4);for(let y=u.length-1;y>=0;y--)s.addOffset(u[y]);return s.endVector()}static startCustomMetadataVector(s,u){s.startVector(4,u,4)}static endSchema(s){return s.endObject()}static finishSchemaBuffer(s,u){s.finish(u)}static createSchema(s,u,y,w){return c.startSchema(s),c.addEndianness(s,u),c.addFields(s,y),c.addCustomMetadata(s,w),c.endSchema(s)}}o.Schema=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(k=_.org||(_.org={}))});var To=b(Te=>{"use strict";Object.defineProperty(Te,"__esModule",{value:!0});var li=Sr(),Ar;(function(t){var e;(function(r){var i;(function(n){var a;(function(o){o.Schema=li.org.apache.arrow.flatbuf.Schema})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(Ar=Te.org||(Te.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){let c;(function(l){l[l.NONE=0]="NONE",l[l.Schema=1]="Schema",l[l.DictionaryBatch=2]="DictionaryBatch",l[l.RecordBatch=3]="RecordBatch",l[l.Tensor=4]="Tensor",l[l.SparseTensor=5]="SparseTensor"})(c=o.MessageHeader||(o.MessageHeader={}))})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(Ar=Te.org||(Te.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static createFieldNode(s,u,y){return s.prep(8,16),s.writeInt64(y),s.writeInt64(u),s.offset()}}o.FieldNode=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(Ar=Te.org||(Te.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsRecordBatch(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}length(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}nodes(s,u){let y=this.bb.__offset(this.bb_pos,6);return y?(u||new t.apache.arrow.flatbuf.FieldNode).__init(this.bb.__vector(this.bb_pos+y)+s*16,this.bb):null}nodesLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}buffers(s,u){let y=this.bb.__offset(this.bb_pos,8);return y?(u||new li.org.apache.arrow.flatbuf.Buffer).__init(this.bb.__vector(this.bb_pos+y)+s*16,this.bb):null}buffersLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}static startRecordBatch(s){s.startObject(3)}static addLength(s,u){s.addFieldInt64(0,u,s.createLong(0,0))}static addNodes(s,u){s.addFieldOffset(1,u,0)}static startNodesVector(s,u){s.startVector(16,u,8)}static addBuffers(s,u){s.addFieldOffset(2,u,0)}static startBuffersVector(s,u){s.startVector(16,u,8)}static endRecordBatch(s){return s.endObject()}static createRecordBatch(s,u,y,w){return c.startRecordBatch(s),c.addLength(s,u),c.addNodes(s,y),c.addBuffers(s,w),c.endRecordBatch(s)}}o.RecordBatch=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(Ar=Te.org||(Te.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsDictionaryBatch(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}id(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}data(s){let u=this.bb.__offset(this.bb_pos,6);return u?(s||new t.apache.arrow.flatbuf.RecordBatch).__init(this.bb.__indirect(this.bb_pos+u),this.bb):null}isDelta(){let s=this.bb.__offset(this.bb_pos,8);return s?!!this.bb.readInt8(this.bb_pos+s):!1}static startDictionaryBatch(s){s.startObject(3)}static addId(s,u){s.addFieldInt64(0,u,s.createLong(0,0))}static addData(s,u){s.addFieldOffset(1,u,0)}static addIsDelta(s,u){s.addFieldInt8(2,+u,0)}static endDictionaryBatch(s){return s.endObject()}static createDictionaryBatch(s,u,y,w){return c.startDictionaryBatch(s),c.addId(s,u),c.addData(s,y),c.addIsDelta(s,w),c.endDictionaryBatch(s)}}o.DictionaryBatch=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(Ar=Te.org||(Te.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsMessage(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}version(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):li.org.apache.arrow.flatbuf.MetadataVersion.V1}headerType(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.readUint8(this.bb_pos+s):t.apache.arrow.flatbuf.MessageHeader.NONE}header(s){let u=this.bb.__offset(this.bb_pos,8);return u?this.bb.__union(s,this.bb_pos+u):null}bodyLength(){let s=this.bb.__offset(this.bb_pos,10);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}customMetadata(s,u){let y=this.bb.__offset(this.bb_pos,12);return y?(u||new li.org.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+y)+s*4),this.bb):null}customMetadataLength(){let s=this.bb.__offset(this.bb_pos,12);return s?this.bb.__vector_len(this.bb_pos+s):0}static startMessage(s){s.startObject(5)}static addVersion(s,u){s.addFieldInt16(0,u,li.org.apache.arrow.flatbuf.MetadataVersion.V1)}static addHeaderType(s,u){s.addFieldInt8(1,u,t.apache.arrow.flatbuf.MessageHeader.NONE)}static addHeader(s,u){s.addFieldOffset(2,u,0)}static addBodyLength(s,u){s.addFieldInt64(3,u,s.createLong(0,0))}static addCustomMetadata(s,u){s.addFieldOffset(4,u,0)}static createCustomMetadataVector(s,u){s.startVector(4,u.length,4);for(let y=u.length-1;y>=0;y--)s.addOffset(u[y]);return s.endVector()}static startCustomMetadataVector(s,u){s.startVector(4,u,4)}static endMessage(s){return s.endObject()}static finishMessageBuffer(s,u){s.finish(u)}static createMessage(s,u,y,w,C,Be){return c.startMessage(s),c.addVersion(s,u),c.addHeaderType(s,y),c.addHeader(s,w),c.addBodyLength(s,C),c.addCustomMetadata(s,Be),c.endMessage(s)}}o.Message=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(Ar=Te.org||(Te.org={}))});var Y=b(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});var $t=Sr(),Db=To();Ie.ArrowType=$t.org.apache.arrow.flatbuf.Type;Ie.DateUnit=$t.org.apache.arrow.flatbuf.DateUnit;Ie.TimeUnit=$t.org.apache.arrow.flatbuf.TimeUnit;Ie.Precision=$t.org.apache.arrow.flatbuf.Precision;Ie.UnionMode=$t.org.apache.arrow.flatbuf.UnionMode;Ie.IntervalUnit=$t.org.apache.arrow.flatbuf.IntervalUnit;Ie.MessageHeader=Db.org.apache.arrow.flatbuf.MessageHeader;Ie.MetadataVersion=$t.org.apache.arrow.flatbuf.MetadataVersion;var Fb;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"})(Fb=Ie.Type||(Ie.Type={}));var Ob;(function(t){t[t.OFFSET=0]="OFFSET",t[t.DATA=1]="DATA",t[t.VALIDITY=2]="VALIDITY",t[t.TYPE=3]="TYPE"})(Ob=Ie.BufferType||(Ie.BufferType={}))});var tt=b(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});function ch(t,e,r,i){return(r&1<<i)!==0}je.getBool=ch;function uh(t,e,r,i){return(r&1<<i)>>i}je.getBit=uh;function Mb(t,e,r){return r?!!(t[e>>3]|=1<<e%8)||!0:!(t[e>>3]&=~(1<<e%8))&&!1}je.setBool=Mb;function Vb(t,e,r){let i=r.byteLength+7&-8;if(t>0||r.byteLength<i){let n=new Uint8Array(i);return n.set(t%8===0?r.subarray(t>>3):lh(So(r,t,e,null,ch)).subarray(0,i)),n}return r}je.truncateBitmap=Vb;function lh(t){let e=[],r=0,i=0,n=0;for(let o of t)o&&(n|=1<<i),++i===8&&(e[r++]=n,n=i=0);(r===0||i>0)&&(e[r++]=n);let a=new Uint8Array(e.length+7&-8);return a.set(e),a}je.packBools=lh;function*So(t,e,r,i,n){let a=e%8,o=e>>3,c=0,l=r;for(;l>0;a=0){let s=t[o++];do yield n(i,c++,s,a);while(--l>0&&++a<8)}}je.iterateBits=So;function Io(t,e,r){if(r-e<=0)return 0;if(r-e<8){let a=0;for(let o of So(t,e,r-e,t,uh))a+=o;return a}let i=r>>3<<3,n=e+(e%8===0?0:8-e%8);return Io(t,e,n)+Io(t,i,r)+dh(t,n>>3,i-n>>3)}je.popcnt_bit_range=Io;function dh(t,e,r){let i=0,n=e|0,a=new DataView(t.buffer,t.byteOffset,t.byteLength),o=r===void 0?t.byteLength:n+r;for(;o-n>=4;)i+=ns(a.getUint32(n)),n+=4;for(;o-n>=2;)i+=ns(a.getUint16(n)),n+=2;for(;o-n>=1;)i+=ns(a.getUint8(n)),n+=1;return i}je.popcnt_array=dh;function ns(t){let e=t|0;return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),(e+(e>>>4)&252645135)*16843009>>>24}je.popcnt_uint32=ns});var ye=b(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});var Ub=ke(),xb=ie(),m=Y(),Lb=P(),W=class{visitMany(e,...r){return e.map((i,n)=>this.visit(i,...r.map(a=>a[n])))}visit(...e){return this.getVisitFn(e[0],!1).apply(this,e)}getVisitFn(e,r=!0){return Nb(this,e,r)}visitNull(e,...r){return null}visitBool(e,...r){return null}visitInt(e,...r){return null}visitFloat(e,...r){return null}visitUtf8(e,...r){return null}visitBinary(e,...r){return null}visitFixedSizeBinary(e,...r){return null}visitDate(e,...r){return null}visitTimestamp(e,...r){return null}visitTime(e,...r){return null}visitDecimal(e,...r){return null}visitList(e,...r){return null}visitStruct(e,...r){return null}visitUnion(e,...r){return null}visitDictionary(e,...r){return null}visitInterval(e,...r){return null}visitFixedSizeList(e,...r){return null}visitMap(e,...r){return null}};Do.Visitor=W;function Nb(t,e,r=!0){let i=null,n=m.Type.NONE;switch(e instanceof Ub.Data||e instanceof xb.Vector?n=Ao(e.type):e instanceof Lb.DataType?n=Ao(e):typeof(n=e)!="number"&&(n=m.Type[e]),n){case m.Type.Null:i=t.visitNull;break;case m.Type.Bool:i=t.visitBool;break;case m.Type.Int:i=t.visitInt;break;case m.Type.Int8:i=t.visitInt8||t.visitInt;break;case m.Type.Int16:i=t.visitInt16||t.visitInt;break;case m.Type.Int32:i=t.visitInt32||t.visitInt;break;case m.Type.Int64:i=t.visitInt64||t.visitInt;break;case m.Type.Uint8:i=t.visitUint8||t.visitInt;break;case m.Type.Uint16:i=t.visitUint16||t.visitInt;break;case m.Type.Uint32:i=t.visitUint32||t.visitInt;break;case m.Type.Uint64:i=t.visitUint64||t.visitInt;break;case m.Type.Float:i=t.visitFloat;break;case m.Type.Float16:i=t.visitFloat16||t.visitFloat;break;case m.Type.Float32:i=t.visitFloat32||t.visitFloat;break;case m.Type.Float64:i=t.visitFloat64||t.visitFloat;break;case m.Type.Utf8:i=t.visitUtf8;break;case m.Type.Binary:i=t.visitBinary;break;case m.Type.FixedSizeBinary:i=t.visitFixedSizeBinary;break;case m.Type.Date:i=t.visitDate;break;case m.Type.DateDay:i=t.visitDateDay||t.visitDate;break;case m.Type.DateMillisecond:i=t.visitDateMillisecond||t.visitDate;break;case m.Type.Timestamp:i=t.visitTimestamp;break;case m.Type.TimestampSecond:i=t.visitTimestampSecond||t.visitTimestamp;break;case m.Type.TimestampMillisecond:i=t.visitTimestampMillisecond||t.visitTimestamp;break;case m.Type.TimestampMicrosecond:i=t.visitTimestampMicrosecond||t.visitTimestamp;break;case m.Type.TimestampNanosecond:i=t.visitTimestampNanosecond||t.visitTimestamp;break;case m.Type.Time:i=t.visitTime;break;case m.Type.TimeSecond:i=t.visitTimeSecond||t.visitTime;break;case m.Type.TimeMillisecond:i=t.visitTimeMillisecond||t.visitTime;break;case m.Type.TimeMicrosecond:i=t.visitTimeMicrosecond||t.visitTime;break;case m.Type.TimeNanosecond:i=t.visitTimeNanosecond||t.visitTime;break;case m.Type.Decimal:i=t.visitDecimal;break;case m.Type.List:i=t.visitList;break;case m.Type.Struct:i=t.visitStruct;break;case m.Type.Union:i=t.visitUnion;break;case m.Type.DenseUnion:i=t.visitDenseUnion||t.visitUnion;break;case m.Type.SparseUnion:i=t.visitSparseUnion||t.visitUnion;break;case m.Type.Dictionary:i=t.visitDictionary;break;case m.Type.Interval:i=t.visitInterval;break;case m.Type.IntervalDayTime:i=t.visitIntervalDayTime||t.visitInterval;break;case m.Type.IntervalYearMonth:i=t.visitIntervalYearMonth||t.visitInterval;break;case m.Type.FixedSizeList:i=t.visitFixedSizeList;break;case m.Type.Map:i=t.visitMap;break}if(typeof i=="function")return i;if(!r)return()=>null;throw new Error(`Unrecognized type '${m.Type[n]}'`)}function Ao(t){switch(t.typeId){case m.Type.Null:return m.Type.Null;case m.Type.Int:let{bitWidth:e,isSigned:r}=t;switch(e){case 8:return r?m.Type.Int8:m.Type.Uint8;case 16:return r?m.Type.Int16:m.Type.Uint16;case 32:return r?m.Type.Int32:m.Type.Uint32;case 64:return r?m.Type.Int64:m.Type.Uint64}return m.Type.Int;case m.Type.Float:switch(t.precision){case m.Precision.HALF:return m.Type.Float16;case m.Precision.SINGLE:return m.Type.Float32;case m.Precision.DOUBLE:return m.Type.Float64}return m.Type.Float;case m.Type.Binary:return m.Type.Binary;case m.Type.Utf8:return m.Type.Utf8;case m.Type.Bool:return m.Type.Bool;case m.Type.Decimal:return m.Type.Decimal;case m.Type.Time:switch(t.unit){case m.TimeUnit.SECOND:return m.Type.TimeSecond;case m.TimeUnit.MILLISECOND:return m.Type.TimeMillisecond;case m.TimeUnit.MICROSECOND:return m.Type.TimeMicrosecond;case m.TimeUnit.NANOSECOND:return m.Type.TimeNanosecond}return m.Type.Time;case m.Type.Timestamp:switch(t.unit){case m.TimeUnit.SECOND:return m.Type.TimestampSecond;case m.TimeUnit.MILLISECOND:return m.Type.TimestampMillisecond;case m.TimeUnit.MICROSECOND:return m.Type.TimestampMicrosecond;case m.TimeUnit.NANOSECOND:return m.Type.TimestampNanosecond}return m.Type.Timestamp;case m.Type.Date:switch(t.unit){case m.DateUnit.DAY:return m.Type.DateDay;case m.DateUnit.MILLISECOND:return m.Type.DateMillisecond}return m.Type.Date;case m.Type.Interval:switch(t.unit){case m.IntervalUnit.DAY_TIME:return m.Type.IntervalDayTime;case m.IntervalUnit.YEAR_MONTH:return m.Type.IntervalYearMonth}return m.Type.Interval;case m.Type.Map:return m.Type.Map;case m.Type.List:return m.Type.List;case m.Type.Struct:return m.Type.Struct;case m.Type.Union:switch(t.mode){case m.UnionMode.Dense:return m.Type.DenseUnion;case m.UnionMode.Sparse:return m.Type.SparseUnion}return m.Type.Union;case m.Type.FixedSizeBinary:return m.Type.FixedSizeBinary;case m.Type.FixedSizeList:return m.Type.FixedSizeList;case m.Type.Dictionary:return m.Type.Dictionary}throw new Error(`Unrecognized type '${m.Type[t.typeId]}'`)}W.prototype.visitInt8=null;W.prototype.visitInt16=null;W.prototype.visitInt32=null;W.prototype.visitInt64=null;W.prototype.visitUint8=null;W.prototype.visitUint16=null;W.prototype.visitUint32=null;W.prototype.visitUint64=null;W.prototype.visitFloat16=null;W.prototype.visitFloat32=null;W.prototype.visitFloat64=null;W.prototype.visitDateDay=null;W.prototype.visitDateMillisecond=null;W.prototype.visitTimestampSecond=null;W.prototype.visitTimestampMillisecond=null;W.prototype.visitTimestampMicrosecond=null;W.prototype.visitTimestampNanosecond=null;W.prototype.visitTimeSecond=null;W.prototype.visitTimeMillisecond=null;W.prototype.visitTimeMicrosecond=null;W.prototype.visitTimeNanosecond=null;W.prototype.visitDenseUnion=null;W.prototype.visitSparseUnion=null;W.prototype.visitIntervalDayTime=null;W.prototype.visitIntervalYearMonth=null});var Vo=b(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});var Eb=ye(),T=class extends Eb.Visitor{compareSchemas(e,r){return e===r||r instanceof e.constructor&&Se.instance.compareFields(e.fields,r.fields)}compareFields(e,r){return e===r||Array.isArray(e)&&Array.isArray(r)&&e.length===r.length&&e.every((i,n)=>Se.instance.compareField(i,r[n]))}compareField(e,r){return e===r||r instanceof e.constructor&&e.name===r.name&&e.nullable===r.nullable&&Se.instance.visit(e.type,r.type)}};Se.TypeComparator=T;function Ae(t,e){return e instanceof t.constructor}function di(t,e){return t===e||Ae(t,e)}function ft(t,e){return t===e||Ae(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function ss(t,e){return t===e||Ae(t,e)&&t.precision===e.precision}function Rb(t,e){return t===e||Ae(t,e)&&t.byteWidth===e.byteWidth}function Fo(t,e){return t===e||Ae(t,e)&&t.unit===e.unit}function fi(t,e){return t===e||Ae(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function hi(t,e){return t===e||Ae(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function qb(t,e){return t===e||Ae(t,e)&&t.children.length===e.children.length&&Se.instance.compareFields(t.children,e.children)}function Cb(t,e){return t===e||Ae(t,e)&&t.children.length===e.children.length&&Se.instance.compareFields(t.children,e.children)}function Oo(t,e){return t===e||Ae(t,e)&&t.mode===e.mode&&t.typeIds.every((r,i)=>r===e.typeIds[i])&&Se.instance.compareFields(t.children,e.children)}function jb(t,e){return t===e||Ae(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&Se.instance.visit(t.indices,e.indices)&&Se.instance.visit(t.dictionary,e.dictionary)}function Mo(t,e){return t===e||Ae(t,e)&&t.unit===e.unit}function kb(t,e){return t===e||Ae(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&Se.instance.compareFields(t.children,e.children)}function Pb(t,e){return t===e||Ae(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&Se.instance.compareFields(t.children,e.children)}T.prototype.visitNull=di;T.prototype.visitBool=di;T.prototype.visitInt=ft;T.prototype.visitInt8=ft;T.prototype.visitInt16=ft;T.prototype.visitInt32=ft;T.prototype.visitInt64=ft;T.prototype.visitUint8=ft;T.prototype.visitUint16=ft;T.prototype.visitUint32=ft;T.prototype.visitUint64=ft;T.prototype.visitFloat=ss;T.prototype.visitFloat16=ss;T.prototype.visitFloat32=ss;T.prototype.visitFloat64=ss;T.prototype.visitUtf8=di;T.prototype.visitBinary=di;T.prototype.visitFixedSizeBinary=Rb;T.prototype.visitDate=Fo;T.prototype.visitDateDay=Fo;T.prototype.visitDateMillisecond=Fo;T.prototype.visitTimestamp=fi;T.prototype.visitTimestampSecond=fi;T.prototype.visitTimestampMillisecond=fi;T.prototype.visitTimestampMicrosecond=fi;T.prototype.visitTimestampNanosecond=fi;T.prototype.visitTime=hi;T.prototype.visitTimeSecond=hi;T.prototype.visitTimeMillisecond=hi;T.prototype.visitTimeMicrosecond=hi;T.prototype.visitTimeNanosecond=hi;T.prototype.visitDecimal=di;T.prototype.visitList=qb;T.prototype.visitStruct=Cb;T.prototype.visitUnion=Oo;T.prototype.visitDenseUnion=Oo;T.prototype.visitSparseUnion=Oo;T.prototype.visitDictionary=jb;T.prototype.visitInterval=Mo;T.prototype.visitIntervalDayTime=Mo;T.prototype.visitIntervalYearMonth=Mo;T.prototype.visitFixedSizeList=kb;T.prototype.visitMap=Pb;Se.instance=new T});var P=b(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var zb=Vo(),g=Y(),Z=class{static isNull(e){return e&&e.typeId===g.Type.Null}static isInt(e){return e&&e.typeId===g.Type.Int}static isFloat(e){return e&&e.typeId===g.Type.Float}static isBinary(e){return e&&e.typeId===g.Type.Binary}static isUtf8(e){return e&&e.typeId===g.Type.Utf8}static isBool(e){return e&&e.typeId===g.Type.Bool}static isDecimal(e){return e&&e.typeId===g.Type.Decimal}static isDate(e){return e&&e.typeId===g.Type.Date}static isTime(e){return e&&e.typeId===g.Type.Time}static isTimestamp(e){return e&&e.typeId===g.Type.Timestamp}static isInterval(e){return e&&e.typeId===g.Type.Interval}static isList(e){return e&&e.typeId===g.Type.List}static isStruct(e){return e&&e.typeId===g.Type.Struct}static isUnion(e){return e&&e.typeId===g.Type.Union}static isFixedSizeBinary(e){return e&&e.typeId===g.Type.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===g.Type.FixedSizeList}static isMap(e){return e&&e.typeId===g.Type.Map}static isDictionary(e){return e&&e.typeId===g.Type.Dictionary}get typeId(){return g.Type.NONE}compareTo(e){return zb.instance.visit(this,e)}};Z[Symbol.toStringTag]=(t=>(t.children=null,t.ArrayType=Array,t[Symbol.toStringTag]="DataType"))(Z.prototype);I.DataType=Z;var pi=class extends Z{toString(){return"Null"}get typeId(){return g.Type.Null}};pi[Symbol.toStringTag]=(t=>t[Symbol.toStringTag]="Null")(pi.prototype);I.Null=pi;var Fe=class extends Z{constructor(e,r){super(),this.isSigned=e,this.bitWidth=r}get typeId(){return g.Type.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?Int32Array:Uint32Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}};Fe[Symbol.toStringTag]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(Fe.prototype);I.Int=Fe;var as=class extends Fe{constructor(){super(!0,8)}};I.Int8=as;var os=class extends Fe{constructor(){super(!0,16)}};I.Int16=os;var cs=class extends Fe{constructor(){super(!0,32)}};I.Int32=cs;var us=class extends Fe{constructor(){super(!0,64)}};I.Int64=us;var ls=class extends Fe{constructor(){super(!1,8)}};I.Uint8=ls;var ds=class extends Fe{constructor(){super(!1,16)}};I.Uint16=ds;var fs=class extends Fe{constructor(){super(!1,32)}};I.Uint32=fs;var hs=class extends Fe{constructor(){super(!1,64)}};I.Uint64=hs;Object.defineProperty(as.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(os.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(cs.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(us.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(ls.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(ds.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(fs.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(hs.prototype,"ArrayType",{value:Uint32Array});var It=class extends Z{constructor(e){super(),this.precision=e}get typeId(){return g.Type.Float}get ArrayType(){switch(this.precision){case g.Precision.HALF:return Uint16Array;case g.Precision.SINGLE:return Float32Array;case g.Precision.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}};It[Symbol.toStringTag]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(It.prototype);I.Float=It;var ps=class extends It{constructor(){super(g.Precision.HALF)}};I.Float16=ps;var ys=class extends It{constructor(){super(g.Precision.SINGLE)}};I.Float32=ys;var ms=class extends It{constructor(){super(g.Precision.DOUBLE)}};I.Float64=ms;Object.defineProperty(ps.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(ys.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(ms.prototype,"ArrayType",{value:Float64Array});var yi=class extends Z{constructor(){super()}get typeId(){return g.Type.Binary}toString(){return"Binary"}};yi[Symbol.toStringTag]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(yi.prototype);I.Binary=yi;var mi=class extends Z{constructor(){super()}get typeId(){return g.Type.Utf8}toString(){return"Utf8"}};mi[Symbol.toStringTag]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(mi.prototype);I.Utf8=mi;var bi=class extends Z{constructor(){super()}get typeId(){return g.Type.Bool}toString(){return"Bool"}};bi[Symbol.toStringTag]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(bi.prototype);I.Bool=bi;var _i=class extends Z{constructor(e,r){super(),this.scale=e,this.precision=r}get typeId(){return g.Type.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};_i[Symbol.toStringTag]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(_i.prototype);I.Decimal=_i;var Wt=class extends Z{constructor(e){super(),this.unit=e}get typeId(){return g.Type.Date}toString(){return`Date${(this.unit+1)*32}<${g.DateUnit[this.unit]}>`}};Wt[Symbol.toStringTag]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Date"))(Wt.prototype);I.Date_=Wt;var Uo=class extends Wt{constructor(){super(g.DateUnit.DAY)}};I.DateDay=Uo;var xo=class extends Wt{constructor(){super(g.DateUnit.MILLISECOND)}};I.DateMillisecond=xo;var ht=class extends Z{constructor(e,r){super(),this.unit=e,this.bitWidth=r}get typeId(){return g.Type.Time}toString(){return`Time${this.bitWidth}<${g.TimeUnit[this.unit]}>`}};ht[Symbol.toStringTag]=(t=>(t.unit=null,t.bitWidth=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Time"))(ht.prototype);I.Time=ht;var Lo=class extends ht{constructor(){super(g.TimeUnit.SECOND,32)}};I.TimeSecond=Lo;var No=class extends ht{constructor(){super(g.TimeUnit.MILLISECOND,32)}};I.TimeMillisecond=No;var Eo=class extends ht{constructor(){super(g.TimeUnit.MICROSECOND,64)}};I.TimeMicrosecond=Eo;var Ro=class extends ht{constructor(){super(g.TimeUnit.NANOSECOND,64)}};I.TimeNanosecond=Ro;var pt=class extends Z{constructor(e,r){super(),this.unit=e,this.timezone=r}get typeId(){return g.Type.Timestamp}toString(){return`Timestamp<${g.TimeUnit[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}};pt[Symbol.toStringTag]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Timestamp"))(pt.prototype);I.Timestamp=pt;var qo=class extends pt{constructor(e){super(g.TimeUnit.SECOND,e)}};I.TimestampSecond=qo;var Co=class extends pt{constructor(e){super(g.TimeUnit.MILLISECOND,e)}};I.TimestampMillisecond=Co;var jo=class extends pt{constructor(e){super(g.TimeUnit.MICROSECOND,e)}};I.TimestampMicrosecond=jo;var ko=class extends pt{constructor(e){super(g.TimeUnit.NANOSECOND,e)}};I.TimestampNanosecond=ko;var Yt=class extends Z{constructor(e){super(),this.unit=e}get typeId(){return g.Type.Interval}toString(){return`Interval<${g.IntervalUnit[this.unit]}>`}};Yt[Symbol.toStringTag]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(Yt.prototype);I.Interval=Yt;var Po=class extends Yt{constructor(){super(g.IntervalUnit.DAY_TIME)}};I.IntervalDayTime=Po;var zo=class extends Yt{constructor(){super(g.IntervalUnit.YEAR_MONTH)}};I.IntervalYearMonth=zo;var gi=class extends Z{constructor(e){super(),this.children=[e]}get typeId(){return g.Type.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};gi[Symbol.toStringTag]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(gi.prototype);I.List=gi;var vi=class extends Z{constructor(e){super(),this.children=e}get typeId(){return g.Type.Struct}toString(){return`Struct<{${this.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}};vi[Symbol.toStringTag]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(vi.prototype);I.Struct=vi;var Ht=class extends Z{constructor(e,r,i){super(),this.mode=e,this.children=i,this.typeIds=r=Int32Array.from(r),this.typeIdToChildIndex=r.reduce((n,a,o)=>(n[a]=o)&&n||n,Object.create(null))}get typeId(){return g.Type.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(e=>`${e.type}`).join(" | ")}>`}};Ht[Symbol.toStringTag]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))(Ht.prototype);I.Union=Ht;var $o=class extends Ht{constructor(e,r){super(g.UnionMode.Dense,e,r)}};I.DenseUnion=$o;var Wo=class extends Ht{constructor(e,r){super(g.UnionMode.Sparse,e,r)}};I.SparseUnion=Wo;var wi=class extends Z{constructor(e){super(),this.byteWidth=e}get typeId(){return g.Type.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};wi[Symbol.toStringTag]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(wi.prototype);I.FixedSizeBinary=wi;var Bi=class extends Z{constructor(e,r){super(),this.listSize=e,this.children=[r]}get typeId(){return g.Type.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};Bi[Symbol.toStringTag]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(Bi.prototype);I.FixedSizeList=Bi;var Ti=class extends Z{constructor(e,r=!1){super(),this.children=[e],this.keysSorted=r}get typeId(){return g.Type.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}toString(){return`Map<{${this.children[0].type.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}};Ti[Symbol.toStringTag]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(Ti.prototype);I.Map_=Ti;var $b=(t=>()=>++t)(-1),Ii=class extends Z{constructor(e,r,i,n){super(),this.indices=r,this.dictionary=e,this.isOrdered=n||!1,this.id=i==null?$b():typeof i=="number"?i:i.low}get typeId(){return g.Type.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}};Ii[Symbol.toStringTag]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(Ii.prototype);I.Dictionary=Ii;function Wb(t){let e=t;switch(t.typeId){case g.Type.Decimal:return 4;case g.Type.Timestamp:return 2;case g.Type.Date:return 1+e.unit;case g.Type.Interval:return 1+e.unit;case g.Type.Int:return 1+ +(e.bitWidth>32);case g.Type.Time:return 1+ +(e.bitWidth>32);case g.Type.FixedSizeList:return e.listSize;case g.Type.FixedSizeBinary:return e.byteWidth;default:return 1}}I.strideForType=Wb});var ke=b(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});var Yb=tt(),Hb=tt(),v=Y(),Jb=P(),j=se();Si.kUnknownNullCount=-1;var bs=class t{constructor(e,r,i,n,a,o,c){this.type=e,this.dictionary=c,this.offset=Math.floor(Math.max(r||0,0)),this.length=Math.floor(Math.max(i||0,0)),this._nullCount=Math.floor(Math.max(n||0,-1)),this.childData=(o||[]).map(s=>s instanceof t?s:s.data);let l;a instanceof t?(this.stride=a.stride,this.values=a.values,this.typeIds=a.typeIds,this.nullBitmap=a.nullBitmap,this.valueOffsets=a.valueOffsets):(this.stride=Jb.strideForType(e),a&&((l=a[0])&&(this.valueOffsets=l),(l=a[1])&&(this.values=l),(l=a[2])&&(this.nullBitmap=l),(l=a[3])&&(this.typeIds=l)))}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let e=0,{valueOffsets:r,values:i,nullBitmap:n,typeIds:a}=this;return r&&(e+=r.byteLength),i&&(e+=i.byteLength),n&&(e+=n.byteLength),a&&(e+=a.byteLength),this.childData.reduce((o,c)=>o+c.byteLength,e)}get nullCount(){let e=this._nullCount,r;return e<=Si.kUnknownNullCount&&(r=this.nullBitmap)&&(this._nullCount=e=this.length-Hb.popcnt_bit_range(r,this.offset,this.offset+this.length)),e}clone(e,r=this.offset,i=this.length,n=this._nullCount,a=this,o=this.childData){return new t(e,r,i,n,a,o,this.dictionary)}slice(e,r){let{stride:i,typeId:n,childData:a}=this,o=+(this._nullCount===0)-1,c=n===16?i:1,l=this._sliceBuffers(e,r,i,n);return this.clone(this.type,this.offset+e,r,o,l,!a.length||this.valueOffsets?a:this._sliceChildren(a,c*e,c*r))}_changeLengthAndBackfillNullBitmap(e){if(this.typeId===v.Type.Null)return this.clone(this.type,0,e,0);let{length:r,nullCount:i}=this,n=new Uint8Array((e+63&-64)>>3).fill(255,0,r>>3);n[r>>3]=(1<<r-(r&-8))-1,i>0&&n.set(Yb.truncateBitmap(this.offset,r,this.nullBitmap),0);let a=this.buffers;return a[v.BufferType.VALIDITY]=n,this.clone(this.type,0,e,i+(e-r),a)}_sliceBuffers(e,r,i,n){let a,{buffers:o}=this;return(a=o[v.BufferType.TYPE])&&(o[v.BufferType.TYPE]=a.subarray(e,e+r)),(a=o[v.BufferType.OFFSET])&&(o[v.BufferType.OFFSET]=a.subarray(e,e+r+1))||(a=o[v.BufferType.DATA])&&(o[v.BufferType.DATA]=n===6?a:a.subarray(i*e,i*(e+r))),o}_sliceChildren(e,r,i){return e.map(n=>n.slice(r,i))}static new(e,r,i,n,a,o,c){switch(a instanceof t?a=a.buffers:a||(a=[]),e.typeId){case v.Type.Null:return t.Null(e,r,i);case v.Type.Int:return t.Int(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.DATA]||[]);case v.Type.Dictionary:return t.Dictionary(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.DATA]||[],c);case v.Type.Float:return t.Float(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.DATA]||[]);case v.Type.Bool:return t.Bool(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.DATA]||[]);case v.Type.Decimal:return t.Decimal(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.DATA]||[]);case v.Type.Date:return t.Date(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.DATA]||[]);case v.Type.Time:return t.Time(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.DATA]||[]);case v.Type.Timestamp:return t.Timestamp(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.DATA]||[]);case v.Type.Interval:return t.Interval(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.DATA]||[]);case v.Type.FixedSizeBinary:return t.FixedSizeBinary(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.DATA]||[]);case v.Type.Binary:return t.Binary(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.OFFSET]||[],a[v.BufferType.DATA]||[]);case v.Type.Utf8:return t.Utf8(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.OFFSET]||[],a[v.BufferType.DATA]||[]);case v.Type.List:return t.List(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.OFFSET]||[],(o||[])[0]);case v.Type.FixedSizeList:return t.FixedSizeList(e,r,i,n||0,a[v.BufferType.VALIDITY],(o||[])[0]);case v.Type.Struct:return t.Struct(e,r,i,n||0,a[v.BufferType.VALIDITY],o||[]);case v.Type.Map:return t.Map(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.OFFSET]||[],(o||[])[0]);case v.Type.Union:return t.Union(e,r,i,n||0,a[v.BufferType.VALIDITY],a[v.BufferType.TYPE]||[],a[v.BufferType.OFFSET]||o,o)}throw new Error(`Unrecognized typeId ${e.typeId}`)}static Null(e,r,i){return new t(e,r,i,0)}static Int(e,r,i,n,a,o){return new t(e,r,i,n,[void 0,j.toArrayBufferView(e.ArrayType,o),j.toUint8Array(a)])}static Dictionary(e,r,i,n,a,o,c){return new t(e,r,i,n,[void 0,j.toArrayBufferView(e.indices.ArrayType,o),j.toUint8Array(a)],[],c)}static Float(e,r,i,n,a,o){return new t(e,r,i,n,[void 0,j.toArrayBufferView(e.ArrayType,o),j.toUint8Array(a)])}static Bool(e,r,i,n,a,o){return new t(e,r,i,n,[void 0,j.toArrayBufferView(e.ArrayType,o),j.toUint8Array(a)])}static Decimal(e,r,i,n,a,o){return new t(e,r,i,n,[void 0,j.toArrayBufferView(e.ArrayType,o),j.toUint8Array(a)])}static Date(e,r,i,n,a,o){return new t(e,r,i,n,[void 0,j.toArrayBufferView(e.ArrayType,o),j.toUint8Array(a)])}static Time(e,r,i,n,a,o){return new t(e,r,i,n,[void 0,j.toArrayBufferView(e.ArrayType,o),j.toUint8Array(a)])}static Timestamp(e,r,i,n,a,o){return new t(e,r,i,n,[void 0,j.toArrayBufferView(e.ArrayType,o),j.toUint8Array(a)])}static Interval(e,r,i,n,a,o){return new t(e,r,i,n,[void 0,j.toArrayBufferView(e.ArrayType,o),j.toUint8Array(a)])}static FixedSizeBinary(e,r,i,n,a,o){return new t(e,r,i,n,[void 0,j.toArrayBufferView(e.ArrayType,o),j.toUint8Array(a)])}static Binary(e,r,i,n,a,o,c){return new t(e,r,i,n,[j.toInt32Array(o),j.toUint8Array(c),j.toUint8Array(a)])}static Utf8(e,r,i,n,a,o,c){return new t(e,r,i,n,[j.toInt32Array(o),j.toUint8Array(c),j.toUint8Array(a)])}static List(e,r,i,n,a,o,c){return new t(e,r,i,n,[j.toInt32Array(o),void 0,j.toUint8Array(a)],[c])}static FixedSizeList(e,r,i,n,a,o){return new t(e,r,i,n,[void 0,void 0,j.toUint8Array(a)],[o])}static Struct(e,r,i,n,a,o){return new t(e,r,i,n,[void 0,void 0,j.toUint8Array(a)],o)}static Map(e,r,i,n,a,o,c){return new t(e,r,i,n,[j.toInt32Array(o),void 0,j.toUint8Array(a)],[c])}static Union(e,r,i,n,a,o,c,l){let s=[void 0,void 0,j.toUint8Array(a),j.toArrayBufferView(e.ArrayType,o)];return e.mode===v.UnionMode.Sparse?new t(e,r,i,n,s,c):(s[v.BufferType.OFFSET]=j.toInt32Array(c),new t(e,r,i,n,s,l))}};Si.Data=bs;bs.prototype.childData=Object.freeze([])});var Ho=b(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});var Gb=void 0;function Kb(t){if(t===null)return"null";if(t===Gb)return"undefined";switch(typeof t){case"number":return`${t}`;case"bigint":return`${t}`;case"string":return`"${t}"`}return typeof t[Symbol.toPrimitive]=="function"?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t)}Yo.valueToString=Kb});var fh=b(Go=>{"use strict";Object.defineProperty(Go,"__esModule",{value:!0});var Jo=Ho(),Zb=_e();function Qb(t){if(!t||t.length<=0)return function(n){return!0};let e="",r=t.filter(i=>i===i);return r.length>0&&(e=`
    switch (x) {${r.map(i=>`
        case ${Xb(i)}:`).join("")}
            return false;
    }`),t.length!==r.length&&(e=`if (x !== x) return false;
${e}`),new Function("x",`${e}
return true;`)}Go.createIsValidFunction=Qb;function Xb(t){return typeof t!="bigint"?Jo.valueToString(t):Zb.BigIntAvailable?`${Jo.valueToString(t)}n`:`"${Jo.valueToString(t)}"`}});var St=b(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});var hh=se(),Ko=_e(),Zo=(t,e)=>(t*e+63&-64||64)/e,e_=(t,e=0)=>t.length>=e?t.subarray(0,e):hh.memcpy(new t.constructor(e),t,0),Dr=class{constructor(e,r=1){this.buffer=e,this.stride=r,this.BYTES_PER_ELEMENT=e.BYTES_PER_ELEMENT,this.ArrayType=e.constructor,this._resize(this.length=e.length/r|0)}get byteLength(){return this.length*this.stride*this.BYTES_PER_ELEMENT|0}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(e,r){return this}append(e){return this.set(this.length,e)}reserve(e){if(e>0){this.length+=e;let r=this.stride,i=this.length*r,n=this.buffer.length;i>=n&&this._resize(n===0?Zo(i*1,this.BYTES_PER_ELEMENT):Zo(i*2,this.BYTES_PER_ELEMENT))}return this}flush(e=this.length){e=Zo(e*this.stride,this.BYTES_PER_ELEMENT);let r=e_(this.buffer,e);return this.clear(),r}clear(){return this.length=0,this._resize(0),this}_resize(e){return this.buffer=hh.memcpy(new this.ArrayType(e),this.buffer)}};Jt.BufferBuilder=Dr;Dr.prototype.offset=0;var Ai=class extends Dr{last(){return this.get(this.length-1)}get(e){return this.buffer[e]}set(e,r){return this.reserve(e-this.length+1),this.buffer[e*this.stride]=r,this}};Jt.DataBufferBuilder=Ai;var Qo=class extends Ai{constructor(e=new Uint8Array(0)){super(e,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(e){return this.buffer[e>>3]>>e%8&1}set(e,r){let{buffer:i}=this.reserve(e-this.length+1),n=e>>3,a=e%8,o=i[n]>>a&1;return r?o===0&&(i[n]|=1<<a,++this.numValid):o===1&&(i[n]&=~(1<<a),--this.numValid),this}clear(){return this.numValid=0,super.clear()}};Jt.BitmapBufferBuilder=Qo;var Xo=class extends Ai{constructor(e=new Int32Array(1)){super(e,1)}append(e){return this.set(this.length-1,e)}set(e,r){let i=this.length-1,n=this.reserve(e-i+1).buffer;return i<e++&&n.fill(n[i],i,e),n[e]=n[e-1]+r,this}flush(e=this.length-1){return e>this.length&&this.set(e-1,0),super.flush(e+1)}};Jt.OffsetsBufferBuilder=Xo;var ec=class extends Dr{get ArrayType64(){return this._ArrayType64||(this._ArrayType64=this.buffer instanceof Int32Array?Ko.BigInt64Array:Ko.BigUint64Array)}set(e,r){switch(this.reserve(e-this.length+1),typeof r){case"bigint":this.buffer64[e]=r;break;case"number":this.buffer[e*this.stride]=r;break;default:this.buffer.set(r,e*this.stride)}return this}_resize(e){let r=super._resize(e),i=r.byteLength/(this.BYTES_PER_ELEMENT*this.stride);return Ko.BigIntAvailable&&(this.buffer64=new this.ArrayType64(r.buffer,r.byteOffset,i)),r}};Jt.WideBufferBuilder=ec});var ee=b(Di=>{"use strict";Object.defineProperty(Di,"__esModule",{value:!0});var t_=ie(),Fr=Y(),r_=ke(),i_=fh(),ic=St(),n_=P(),Oe=class{constructor({type:e,nullValues:r}){this.length=0,this.finished=!1,this.type=e,this.children=[],this.nullValues=r,this.stride=n_.strideForType(e),this._nulls=new ic.BitmapBufferBuilder,r&&r.length>0&&(this._isValid=i_.createIsValidFunction(r))}static new(e){}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e){throw new Error('"throughDOM" not available in this environment')}static throughIterable(e){return s_(e)}static throughAsyncIterable(e){return a_(e)}toVector(){return t_.Vector.new(this.flush())}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let e=0;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),this._typeIds&&(e+=this._typeIds.byteLength),this.children.reduce((r,i)=>r+i.byteLength,e)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let e=0;return this._offsets&&(e+=this._offsets.reservedByteLength),this._values&&(e+=this._values.reservedByteLength),this._nulls&&(e+=this._nulls.reservedByteLength),this._typeIds&&(e+=this._typeIds.reservedByteLength),this.children.reduce((r,i)=>r+i.reservedByteLength,e)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(e){return this.set(this.length,e)}isValid(e){return this._isValid(e)}set(e,r){return this.setValid(e,this.isValid(r))&&this.setValue(e,r),this}setValue(e,r){this._setValue(this,e,r)}setValid(e,r){return this.length=this._nulls.set(e,+r).length,r}addChild(e,r=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(e){return this.children[e]||null}flush(){let e=[],r=this._values,i=this._offsets,n=this._typeIds,{length:a,nullCount:o}=this;n?(e[Fr.BufferType.TYPE]=n.flush(a),i&&(e[Fr.BufferType.OFFSET]=i.flush(a))):i?(r&&(e[Fr.BufferType.DATA]=r.flush(i.last())),e[Fr.BufferType.OFFSET]=i.flush(a)):r&&(e[Fr.BufferType.DATA]=r.flush(a)),o>0&&(e[Fr.BufferType.VALIDITY]=this._nulls.flush(a));let c=r_.Data.new(this.type,0,a,o,e,this.children.map(l=>l.flush()));return this.clear(),c}finish(){return this.finished=!0,this.children.forEach(e=>e.finish()),this}clear(){return this.length=0,this._offsets&&this._offsets.clear(),this._values&&this._values.clear(),this._nulls&&this._nulls.clear(),this._typeIds&&this._typeIds.clear(),this.children.forEach(e=>e.clear()),this}};Di.Builder=Oe;Oe.prototype.length=1;Oe.prototype.stride=1;Oe.prototype.children=null;Oe.prototype.finished=!1;Oe.prototype.nullValues=null;Oe.prototype._isValid=()=>!0;var tc=class extends Oe{constructor(e){super(e),this._values=new ic.DataBufferBuilder(new this.ArrayType(0),this.stride)}setValue(e,r){let i=this._values;return i.reserve(e-i.length+1),super.setValue(e,r)}};Di.FixedWidthBuilder=tc;var rc=class extends Oe{constructor(e){super(e),this._pendingLength=0,this._offsets=new ic.OffsetsBufferBuilder}setValue(e,r){let i=this._pending||(this._pending=new Map),n=i.get(e);n&&(this._pendingLength-=n.length),this._pendingLength+=r.length,i.set(e,r)}setValid(e,r){return super.setValid(e,r)?!0:((this._pending||(this._pending=new Map)).set(e,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let e=this._pending,r=this._pendingLength;return this._pendingLength=0,this._pending=void 0,e&&e.size>0&&this._flushPending(e,r),this}};Di.VariableWidthBuilder=rc;function s_(t){let{["queueingStrategy"]:e="count"}=t,{["highWaterMark"]:r=e!=="bytes"?1e3:2**14}=t,i=e!=="bytes"?"length":"byteLength";return function*(n){let a=0,o=Oe.new(t);for(let c of n)o.append(c)[i]>=r&&++a&&(yield o.toVector());(o.finish().length>0||a===0)&&(yield o.toVector())}}function a_(t){let{["queueingStrategy"]:e="count"}=t,{["highWaterMark"]:r=e!=="bytes"?1e3:2**14}=t,i=e!=="bytes"?"length":"byteLength";return async function*(n){let a=0,o=Oe.new(t);for await(let c of n)o.append(c)[i]>=r&&++a&&(yield o.toVector());(o.finish().length>0||a===0)&&(yield o.toVector())}}});var ac=b(sc=>{"use strict";Object.defineProperty(sc,"__esModule",{value:!0});var o_=St(),c_=ee(),nc=class extends c_.Builder{constructor(e){super(e),this._values=new o_.BitmapBufferBuilder}setValue(e,r){this._values.set(e,+r)}};sc.BoolBuilder=nc});var uc=b(cc=>{"use strict";Object.defineProperty(cc,"__esModule",{value:!0});var u_=ee(),oc=class extends u_.Builder{setValue(e,r){}setValid(e,r){return this.length=Math.max(e+1,this.length),r}};cc.NullBuilder=oc});var fc=b(Oi=>{"use strict";Object.defineProperty(Oi,"__esModule",{value:!0});var l_=ee(),Fi=class extends l_.FixedWidthBuilder{};Oi.DateBuilder=Fi;var lc=class extends Fi{};Oi.DateDayBuilder=lc;var dc=class extends Fi{};Oi.DateMillisecondBuilder=dc});var yc=b(pc=>{"use strict";Object.defineProperty(pc,"__esModule",{value:!0});var d_=ee(),hc=class extends d_.FixedWidthBuilder{};pc.DecimalBuilder=hc});var gc=b(_c=>{"use strict";Object.defineProperty(_c,"__esModule",{value:!0});var f_=P(),mc=ee(),bc=class extends mc.Builder{constructor({type:e,nullValues:r,dictionaryHashFunction:i}){super({type:new f_.Dictionary(e.dictionary,e.indices,e.id,e.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=mc.Builder.new({type:this.type.indices,nullValues:r}),this.dictionary=mc.Builder.new({type:this.type.dictionary,nullValues:null}),typeof i=="function"&&(this.valueToKey=i)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(e){return this.indices.isValid(e)}setValid(e,r){let i=this.indices;return r=i.setValid(e,r),this.length=i.length,r}setValue(e,r){let i=this._keysToIndices,n=this.valueToKey(r),a=i[n];return a===void 0&&(i[n]=a=this._dictionaryOffset+this.dictionary.append(r).length-1),this.indices.setValue(e,a)}flush(){let e=this.type,r=this._dictionary,i=this.dictionary.toVector(),n=this.indices.flush().clone(e);return n.dictionary=r?r.concat(i):i,this.finished||(this._dictionaryOffset+=i.length),this._dictionary=n.dictionary,this.clear(),n}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(e){return typeof e=="string"?e:`${e}`}};_c.DictionaryBuilder=bc});var Bc=b(wc=>{"use strict";Object.defineProperty(wc,"__esModule",{value:!0});var h_=ee(),vc=class extends h_.FixedWidthBuilder{};wc.FixedSizeBinaryBuilder=vc});var Mi=b(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});var ph=new Float64Array(1),Or=new Uint32Array(ph.buffer);function p_(t){let e=(t&31744)>>10,r=(t&1023)/1024,i=(-1)**((t&32768)>>15);switch(e){case 31:return i*(r?NaN:1/0);case 0:return i*(r?6103515625e-14*r:0)}return i*2**(e-15)*(1+r)}_s.uint16ToFloat64=p_;function y_(t){if(t!==t)return 32256;ph[0]=t;let e=(Or[1]&2147483648)>>16&65535,r=Or[1]&2146435072,i=0;return r>=1089470464?Or[0]>0?r=31744:(r=(r&2080374784)>>16,i=(Or[1]&1048575)>>10):r<=1056964608?(i=1048576+(Or[1]&1048575),i=1048576+(i<<(r>>20)-998)>>21,r=0):(r=r-1056964608>>10,i=(Or[1]&1048575)+512>>10),e|r|i&65535}_s.float64ToUint16=y_});var Ac=b(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});var m_=Mi(),b_=ee(),Mr=class extends b_.FixedWidthBuilder{};Vr.FloatBuilder=Mr;var Tc=class extends Mr{setValue(e,r){this._values.set(e,m_.float64ToUint16(r))}};Vr.Float16Builder=Tc;var Ic=class extends Mr{setValue(e,r){this._values.set(e,r)}};Vr.Float32Builder=Ic;var Sc=class extends Mr{setValue(e,r){this._values.set(e,r)}};Vr.Float64Builder=Sc});var xi=b(we=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});var __=se(),Ui=_e();we.isArrowBigNumSymbol=Symbol.for("isArrowBigNum");function Pe(t,...e){return e.length===0?Object.setPrototypeOf(__.toArrayBufferView(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}Pe.prototype[we.isArrowBigNumSymbol]=!0;Pe.prototype.toJSON=function(){return`"${we.bignumToString(this)}"`};Pe.prototype.valueOf=function(){return yh(this)};Pe.prototype.toString=function(){return we.bignumToString(this)};Pe.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return yh(this);case"string":return we.bignumToString(this);case"default":return we.bignumToBigInt(this)}return we.bignumToString(this)};function Ur(...t){return Pe.apply(this,t)}function xr(...t){return Pe.apply(this,t)}function Vi(...t){return Pe.apply(this,t)}Object.setPrototypeOf(Ur.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(xr.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(Vi.prototype,Object.create(Uint32Array.prototype));Object.assign(Ur.prototype,Pe.prototype,{constructor:Ur,signed:!0,TypedArray:Int32Array,BigIntArray:Ui.BigInt64Array});Object.assign(xr.prototype,Pe.prototype,{constructor:xr,signed:!1,TypedArray:Uint32Array,BigIntArray:Ui.BigUint64Array});Object.assign(Vi.prototype,Pe.prototype,{constructor:Vi,signed:!0,TypedArray:Uint32Array,BigIntArray:Ui.BigUint64Array});function yh(t){let{buffer:e,byteOffset:r,length:i,signed:n}=t,a=new Int32Array(e,r,i),o=0,c=0,l=a.length,s,u;for(;c<l;)u=a[c++],s=a[c++],n||(s=s>>>0),o+=(u>>>0)+s*c**32;return o}Ui.BigIntAvailable?(we.bignumToBigInt=(t=>t.byteLength===8?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:Dc(t)),we.bignumToString=(t=>t.byteLength===8?`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`:Dc(t))):(we.bignumToString=Dc,we.bignumToBigInt=we.bignumToString);function Dc(t){let e="",r=new Uint32Array(2),i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),n=new Uint32Array((i=new Uint16Array(i).reverse()).buffer),a=-1,o=i.length-1;do{for(r[0]=i[a=0];a<o;)i[a++]=r[1]=r[0]/10,r[0]=(r[0]-r[1]*10<<16)+i[a];i[a]=r[1]=r[0]/10,r[0]=r[0]-r[1]*10,e=`${r[0]}${e}`}while(n[0]||n[1]||n[2]||n[3]);return e||"0"}var Fc=class t{constructor(e,r){return t.new(e,r)}static new(e,r){switch(r){case!0:return new Ur(e);case!1:return new xr(e)}switch(e.constructor){case Int8Array:case Int16Array:case Int32Array:case Ui.BigInt64Array:return new Ur(e)}return e.byteLength===16?new Vi(e):new xr(e)}static signed(e){return new Ur(e)}static unsigned(e){return new xr(e)}static decimal(e){return new Vi(e)}};we.BN=Fc});var Rc=b($e=>{"use strict";Object.defineProperty($e,"__esModule",{value:!0});var g_=xi(),mh=St(),v_=_e(),w_=ee(),ze=class extends w_.FixedWidthBuilder{setValue(e,r){this._values.set(e,r)}};$e.IntBuilder=ze;var Oc=class extends ze{};$e.Int8Builder=Oc;var Mc=class extends ze{};$e.Int16Builder=Mc;var Vc=class extends ze{};$e.Int32Builder=Vc;var Uc=class extends ze{constructor(e){e.nullValues&&(e.nullValues=e.nullValues.map(gs)),super(e),this._values=new mh.WideBufferBuilder(new Int32Array(0),2)}get values64(){return this._values.buffer64}isValid(e){return super.isValid(gs(e))}};$e.Int64Builder=Uc;var xc=class extends ze{};$e.Uint8Builder=xc;var Lc=class extends ze{};$e.Uint16Builder=Lc;var Nc=class extends ze{};$e.Uint32Builder=Nc;var Ec=class extends ze{constructor(e){e.nullValues&&(e.nullValues=e.nullValues.map(gs)),super(e),this._values=new mh.WideBufferBuilder(new Uint32Array(0),2)}get values64(){return this._values.buffer64}isValid(e){return super.isValid(gs(e))}};$e.Uint64Builder=Ec;var gs=(t=>e=>(ArrayBuffer.isView(e)&&(t.buffer=e.buffer,t.byteOffset=e.byteOffset,t.byteLength=e.byteLength,e=g_.bignumToBigInt(t),t.buffer=null),e))({BigIntArray:v_.BigInt64Array})});var Pc=b(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});var B_=ee(),Gt=class extends B_.FixedWidthBuilder{};Kt.TimeBuilder=Gt;var qc=class extends Gt{};Kt.TimeSecondBuilder=qc;var Cc=class extends Gt{};Kt.TimeMillisecondBuilder=Cc;var jc=class extends Gt{};Kt.TimeMicrosecondBuilder=jc;var kc=class extends Gt{};Kt.TimeNanosecondBuilder=kc});var Hc=b(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var T_=ee(),Zt=class extends T_.FixedWidthBuilder{};Qt.TimestampBuilder=Zt;var zc=class extends Zt{};Qt.TimestampSecondBuilder=zc;var $c=class extends Zt{};Qt.TimestampMillisecondBuilder=$c;var Wc=class extends Zt{};Qt.TimestampMicrosecondBuilder=Wc;var Yc=class extends Zt{};Qt.TimestampNanosecondBuilder=Yc});var Kc=b(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});var I_=ee(),Li=class extends I_.FixedWidthBuilder{};Ni.IntervalBuilder=Li;var Jc=class extends Li{};Ni.IntervalDayTimeBuilder=Jc;var Gc=class extends Li{};Ni.IntervalYearMonthBuilder=Gc});var vs=b(Qc=>{"use strict";Object.defineProperty(Qc,"__esModule",{value:!0});var S_=se(),A_=St(),D_=ee(),Zc=class extends D_.VariableWidthBuilder{constructor(e){super(e),this._values=new A_.BufferBuilder(new Uint8Array(0))}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,r){return super.setValue(e,S_.toUint8Array(r))}_flushPending(e,r){let i=this._offsets,n=this._values.reserve(r).buffer,a=0,o=0,c=0,l;for([a,l]of e)l===void 0?i.set(a,0):(o=l.length,n.set(l,c),i.set(a,o),c+=o)}};Qc.BinaryBuilder=Zc});var Bs=b(Xc=>{"use strict";Object.defineProperty(Xc,"__esModule",{value:!0});var F_=Pt(),O_=vs(),M_=St(),V_=ee(),ws=class extends V_.VariableWidthBuilder{constructor(e){super(e),this._values=new M_.BufferBuilder(new Uint8Array(0))}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,r){return super.setValue(e,F_.encodeUtf8(r))}_flushPending(e,r){}};Xc.Utf8Builder=ws;ws.prototype._flushPending=O_.BinaryBuilder.prototype._flushPending});var ru=b(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});var U_=ie(),eu=class{get length(){return this._values.length}get(e){return this._values[e]}clear(){return this._values=null,this}bind(e){return e instanceof U_.Vector?e:(this._values=e,this)}};tu.Run=eu});var Ei=b(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});var bh=Ho(),me=Symbol.for("parent"),Lr=Symbol.for("rowIndex"),Ve=Symbol.for("keyToIdx"),Me=Symbol.for("idxToVal"),iu=Symbol.for("nodejs.util.inspect.custom"),We=class{constructor(e,r){this[me]=e,this.size=r}entries(){return this[Symbol.iterator]()}has(e){return this.get(e)!==void 0}get(e){let r;if(e!=null){let i=this[Ve]||(this[Ve]=new Map),n=i.get(e);if(n!==void 0){let a=this[Me]||(this[Me]=new Array(this.size));(r=a[n])!==void 0||(a[n]=r=this.getValue(n))}else if((n=this.getIndex(e))>-1){i.set(e,n);let a=this[Me]||(this[Me]=new Array(this.size));(r=a[n])!==void 0||(a[n]=r=this.getValue(n))}}return r}set(e,r){if(e!=null){let i=this[Ve]||(this[Ve]=new Map),n=i.get(e);if(n===void 0&&i.set(e,n=this.getIndex(e)),n>-1){let a=this[Me]||(this[Me]=new Array(this.size));a[n]=this.setValue(n,r)}}return this}clear(){throw new Error(`Clearing ${this[Symbol.toStringTag]} not supported.`)}delete(e){throw new Error(`Deleting ${this[Symbol.toStringTag]} values not supported.`)}*[Symbol.iterator](){let e=this.keys(),r=this.values(),i=this[Ve]||(this[Ve]=new Map),n=this[Me]||(this[Me]=new Array(this.size));for(let a,o,c=0,l,s;!((l=e.next()).done||(s=r.next()).done);++c)a=l.value,o=s.value,n[c]=o,i.has(a)||i.set(a,c),yield[a,o]}forEach(e,r){let i=this.keys(),n=this.values(),a=r===void 0?e:(l,s,u)=>e.call(r,l,s,u),o=this[Ve]||(this[Ve]=new Map),c=this[Me]||(this[Me]=new Array(this.size));for(let l,s,u=0,y,w;!((y=i.next()).done||(w=n.next()).done);++u)l=y.value,s=w.value,c[u]=s,o.has(l)||o.set(l,u),a(s,l,this)}toArray(){return[...this.values()]}toJSON(){let e={};return this.forEach((r,i)=>e[i]=r),e}inspect(){return this.toString()}[iu](){return this.toString()}toString(){let e=[];return this.forEach((r,i)=>{i=bh.valueToString(i),r=bh.valueToString(r),e.push(`${i}: ${r}`)}),`{ ${e.join(", ")} }`}};We[Symbol.toStringTag]=(t=>(Object.defineProperties(t,{size:{writable:!0,enumerable:!1,configurable:!1,value:0},[me]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Lr]:{writable:!0,enumerable:!1,configurable:!1,value:-1}}),t[Symbol.toStringTag]="Row"))(We.prototype);var nu=class extends We{constructor(e){return super(e,e.length),x_(this)}keys(){return this[me].getChildAt(0)[Symbol.iterator]()}values(){return this[me].getChildAt(1)[Symbol.iterator]()}getKey(e){return this[me].getChildAt(0).get(e)}getIndex(e){return this[me].getChildAt(0).indexOf(e)}getValue(e){return this[me].getChildAt(1).get(e)}setValue(e,r){this[me].getChildAt(1).set(e,r)}};Ts.MapRow=nu;var su=class extends We{constructor(e){return super(e,e.type.children.length),_h(this)}*keys(){for(let e of this[me].type.children)yield e.name}*values(){for(let e of this[me].type.children)yield this[e.name]}getKey(e){return this[me].type.children[e].name}getIndex(e){return this[me].type.children.findIndex(r=>r.name===e)}getValue(e){return this[me].getChildAt(e).get(this[Lr])}setValue(e,r){return this[me].getChildAt(e).set(this[Lr],r)}};Ts.StructRow=su;Object.setPrototypeOf(We.prototype,Map.prototype);var _h=(()=>{let t={enumerable:!0,configurable:!1,get:null,set:null};return e=>{let r=-1,i=e[Ve]||(e[Ve]=new Map),n=o=>function(){return this.get(o)},a=o=>function(c){return this.set(o,c)};for(let o of e.keys())i.set(o,++r),t.get=n(o),t.set=a(o),e.hasOwnProperty(o)||(t.enumerable=!0,Object.defineProperty(e,o,t)),e.hasOwnProperty(r)||(t.enumerable=!1,Object.defineProperty(e,r,t));return t.get=t.set=null,e}})(),x_=(()=>{if(typeof Proxy>"u")return _h;let t=We.prototype.has,e=We.prototype.get,r=We.prototype.set,i=We.prototype.getKey,n={isExtensible(){return!1},deleteProperty(){return!1},preventExtensions(){return!0},ownKeys(a){return[...a.keys()].map(o=>`${o}`)},has(a,o){switch(o){case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case me:case Lr:case Me:case Ve:case iu:return!0}return typeof o=="number"&&!a.has(o)&&(o=a.getKey(o)),a.has(o)},get(a,o,c){switch(o){case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case me:case Lr:case Me:case Ve:case iu:return Reflect.get(a,o,c)}return typeof o=="number"&&!t.call(c,o)&&(o=i.call(c,o)),e.call(c,o)},set(a,o,c,l){switch(o){case me:case Lr:case Me:case Ve:return Reflect.set(a,o,c,l);case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:return!1}return typeof o=="number"&&!t.call(l,o)&&(o=i.call(l,o)),t.call(l,o)?!!r.call(l,o,c):!1}};return a=>new Proxy(a,n)})()});var Ci=b(qi=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});var Ih=ie(),gh=Ei(),L_=se(),vh=_e();function N_(t,e,r){let i=t.length,n=e>-1?e:i+e%i;return r?r(t,n):n}qi.clampIndex=N_;var wh;function E_(t,e,r,i){let{length:n=0}=t,a=typeof e!="number"?0:e,o=typeof r!="number"?n:r;return a<0&&(a=(a%n+n)%n),o<0&&(o=(o%n+n)%n),o<a&&(wh=a,a=o,o=wh),o>n&&(o=n),i?i(t,a,o):[a,o]}qi.clampRange=E_;var R_=vh.BigIntAvailable?vh.BigInt(0):0,Bh=t=>t!==t;function Ri(t){let e=typeof t;if(e!=="object"||t===null)return Bh(t)?Bh:e!=="bigint"?r=>r===t:r=>R_+r===t;if(t instanceof Date){let r=t.valueOf();return i=>i instanceof Date?i.valueOf()===r:!1}return ArrayBuffer.isView(t)?r=>r?L_.compareArrayLike(t,r):!1:t instanceof Map?C_(t):Array.isArray(t)?q_(t):t instanceof Ih.Vector?j_(t):k_(t)}qi.createElementComparator=Ri;function q_(t){let e=[];for(let r=-1,i=t.length;++r<i;)e[r]=Ri(t[r]);return Is(e)}function C_(t){let e=-1,r=[];return t.forEach(i=>r[++e]=Ri(i)),Is(r)}function j_(t){let e=[];for(let r=-1,i=t.length;++r<i;)e[r]=Ri(t.get(r));return Is(e)}function k_(t){let e=Object.keys(t);if(e.length===0)return()=>!1;let r=[];for(let i=-1,n=e.length;++i<n;)r[i]=Ri(t[e[i]]);return Is(r,e)}function Is(t,e){return r=>{if(!r||typeof r!="object")return!1;switch(r.constructor){case Array:return P_(t,r);case Map:case gh.MapRow:case gh.StructRow:return Th(t,r,r.keys());case Object:case void 0:return Th(t,r,e||Object.keys(r))}return r instanceof Ih.Vector?z_(t,r):!1}}function P_(t,e){let r=t.length;if(e.length!==r)return!1;for(let i=-1;++i<r;)if(!t[i](e[i]))return!1;return!0}function z_(t,e){let r=t.length;if(e.length!==r)return!1;for(let i=-1;++i<r;)if(!t[i](e.get(i)))return!1;return!0}function Th(t,e,r){let i=r[Symbol.iterator](),n=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),a=e instanceof Map?e.values():Object.values(e)[Symbol.iterator](),o=0,c=t.length,l=a.next(),s=i.next(),u=n.next();for(;o<c&&!s.done&&!u.done&&!l.done&&!(s.value!==u.value||!t[o](l.value));++o,s=i.next(),u=n.next(),l=a.next());return o===c&&s.done&&u.done&&l.done?!0:(i.return&&i.return(),n.return&&n.return(),a.return&&a.return(),!1)}});var At=b(ou=>{"use strict";Object.defineProperty(ou,"__esModule",{value:!0});var $_=Ci(),Sh=P(),W_=Dt(),Ah=ie(),au=class t extends Ah.AbstractVector{constructor(e,r=[],i=Y_(r)){super(),this._nullCount=-1,this._type=e,this._chunks=r,this._chunkOffsets=i,this._length=i[i.length-1],this._numChildren=(this._type.children||[]).length}static flatten(...e){return W_.selectChunkArgs(Ah.Vector,e)}static concat(...e){let r=t.flatten(...e);return new t(r[0].type,r)}get type(){return this._type}get length(){return this._length}get chunks(){return this._chunks}get typeId(){return this._type.typeId}get VectorName(){return`Chunked<${this._type}>`}get data(){return this._chunks[0]?this._chunks[0].data:null}get ArrayType(){return this._type.ArrayType}get numChildren(){return this._numChildren}get stride(){return this._chunks[0]?this._chunks[0].stride:1}get byteLength(){return this._chunks.reduce((e,r)=>e+r.byteLength,0)}get nullCount(){let e=this._nullCount;return e<0&&(this._nullCount=e=this._chunks.reduce((r,{nullCount:i})=>r+i,0)),e}get indices(){if(Sh.DataType.isDictionary(this._type)){if(!this._indices){let e=this._chunks;this._indices=e.length===1?e[0].indices:t.concat(...e.map(r=>r.indices))}return this._indices}return null}get dictionary(){return Sh.DataType.isDictionary(this._type)?this._chunks[this._chunks.length-1].data.dictionary:null}*[Symbol.iterator](){for(let e of this._chunks)yield*e}clone(e=this._chunks){return new t(this._type,e)}concat(...e){return this.clone(t.flatten(this,...e))}slice(e,r){return $_.clampRange(this,e,r,this._sliceInternal)}getChildAt(e){if(e<0||e>=this._numChildren)return null;let r=this._children||(this._children=[]),i,n,a;return(i=r[e])?i:(n=(this._type.children||[])[e])&&(a=this._chunks.map(o=>o.getChildAt(e)).filter(o=>o!=null),a.length>0)?r[e]=new t(n.type,a):null}search(e,r){let i=e,n=this._chunkOffsets,a=n.length-1;if(i<0||i>=n[a])return null;if(a<=1)return r?r(this,0,i):[0,i];let o=0,c=0,l=0;do{if(o+1===a)return r?r(this,o,i-c):[o,i-c];l=o+(a-o)/2|0,i>=n[l]?o=l:a=l}while(i<n[a]&&i>=(c=n[o]));return null}isValid(e){return!!this.search(e,this.isValidInternal)}get(e){return this.search(e,this.getInternal)}set(e,r){this.search(e,({chunks:i},n,a)=>i[n].set(a,r))}indexOf(e,r){return r&&typeof r=="number"?this.search(r,(i,n,a)=>this.indexOfInternal(i,n,a,e)):this.indexOfInternal(this,0,Math.max(0,r||0),e)}toArray(){let{chunks:e}=this,r=e.length,i=this._type.ArrayType;if(r<=0)return new i(0);if(r<=1)return e[0].toArray();let n=0,a=new Array(r);for(let l=-1;++l<r;)n+=(a[l]=e[l].toArray()).length;i!==a[0].constructor&&(i=a[0].constructor);let o=new i(n),c=i===Array?J_:H_;for(let l=-1,s=0;++l<r;)s=c(a[l],o,s);return o}getInternal({_chunks:e},r,i){return e[r].get(i)}isValidInternal({_chunks:e},r,i){return e[r].isValid(i)}indexOfInternal({_chunks:e},r,i,n){let a=r-1,o=e.length,c=i,l=0,s=-1;for(;++a<o;){if(~(s=e[a].indexOf(n,c)))return l+s;c=0,l+=e[a].length}return-1}_sliceInternal(e,r,i){let n=[],{chunks:a,_chunkOffsets:o}=e;for(let c=-1,l=a.length;++c<l;){let s=a[c],u=s.length,y=o[c];if(y>=i)break;if(r>=y+u)continue;if(y>=r&&y+u<=i){n.push(s);continue}let w=Math.max(0,r-y),C=Math.min(i-y,u);n.push(s.slice(w,C))}return e.clone(n)}};ou.Chunked=au;function Y_(t){let e=new Uint32Array((t||[]).length+1),r=e[0]=0,i=e.length;for(let n=0;++n<i;)e[n]=r+=t[n-1].length;return e}var H_=(t,e,r)=>(e.set(t,r),r+t.length),J_=(t,e,r)=>{let i=r;for(let n=-1,a=t.length;++n<a;)e[i++]=t[n];return i}});var Nr=b(uu=>{"use strict";Object.defineProperty(uu,"__esModule",{value:!0});var G_=de(),Dh=ie(),cu=At(),Ss=class t extends cu.Chunked{constructor(e,r=[],i){if(r=cu.Chunked.flatten(...r),super(e.type,r,i),this._field=e,r.length===1&&!(this instanceof As))return new As(e,r[0],this._chunkOffsets)}static new(e,r,...i){let n=cu.Chunked.flatten(Array.isArray(r)?[...r,...i]:r instanceof Dh.Vector?[r,...i]:[Dh.Vector.new(r,...i)]);if(typeof e=="string"){let a=n[0].data.type;e=new G_.Field(e,a,!0)}else!e.nullable&&n.some(({nullCount:a})=>a>0)&&(e=e.clone({nullable:!0}));return new t(e,n)}get field(){return this._field}get name(){return this._field.name}get nullable(){return this._field.nullable}get metadata(){return this._field.metadata}clone(e=this._chunks){return new t(this._field,e)}getChildAt(e){if(e<0||e>=this.numChildren)return null;let r=this._children||(this._children=[]),i,n,a;return(i=r[e])?i:(n=(this.type.children||[])[e])&&(a=this._chunks.map(o=>o.getChildAt(e)).filter(o=>o!=null),a.length>0)?r[e]=new t(n,a):null}};uu.Column=Ss;var As=class extends Ss{constructor(e,r,i){super(e,[r],i),this._chunk=r}search(e,r){return r?r(this,0,e):[0,e]}isValid(e){return this._chunk.isValid(e)}get(e){return this._chunk.get(e)}set(e,r){this._chunk.set(e,r)}indexOf(e,r){return this._chunk.indexOf(e,r)}}});var Dt=b(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});var Fh=ke(),Oh=de(),Ft=Nr(),ji=ie(),Mh=P(),K_=At(),Ot=Array.isArray;Mt.selectArgs=(t,e)=>Ds(t,e,[],0);Mt.selectColumnArgs=t=>{let[e,r]=du(t,[[],[]]);return r.map((i,n)=>i instanceof Ft.Column?Ft.Column.new(i.field.clone(e[n]),i):i instanceof ji.Vector?Ft.Column.new(e[n],i):Ft.Column.new(e[n],[]))};Mt.selectFieldArgs=t=>du(t,[[],[]]);Mt.selectChunkArgs=(t,e)=>lu(t,e,[],0);Mt.selectVectorChildrenArgs=(t,e)=>Vh(t,e,[],0);Mt.selectColumnChildrenArgs=(t,e)=>Uh(t,e,[],0);function Ds(t,e,r,i){let n,a=i,o=-1,c=e.length;for(;++o<c;)Ot(n=e[o])?a=Ds(t,n,r,a).length:n instanceof t&&(r[a++]=n);return r}function lu(t,e,r,i){let n,a=i,o=-1,c=e.length;for(;++o<c;)Ot(n=e[o])?a=lu(t,n,r,a).length:n instanceof K_.Chunked?a=lu(t,n.chunks,r,a).length:n instanceof t&&(r[a++]=n);return r}function Vh(t,e,r,i){let n,a=i,o=-1,c=e.length;for(;++o<c;)Ot(n=e[o])?a=Vh(t,n,r,a).length:n instanceof t?a=Ds(ji.Vector,n.schema.fields.map((l,s)=>n.getChildAt(s)),r,a).length:n instanceof ji.Vector&&(r[a++]=n);return r}function Uh(t,e,r,i){let n,a=i,o=-1,c=e.length;for(;++o<c;)Ot(n=e[o])?a=Uh(t,n,r,a).length:n instanceof t?a=Ds(Ft.Column,n.schema.fields.map((l,s)=>Ft.Column.new(l,n.getChildAt(s))),r,a).length:n instanceof Ft.Column&&(r[a++]=n);return r}var Z_=(t,[e,r],i)=>(t[0][i]=e,t[1][i]=r,t);function du(t,e){let r,i;switch(i=t.length){case 0:return e;case 1:if(r=e[0],!t[0])return e;if(Ot(t[0]))return du(t[0],e);t[0]instanceof Fh.Data||t[0]instanceof ji.Vector||t[0]instanceof Mh.DataType||([r,t]=Object.entries(t[0]).reduce(Z_,e));break;default:Ot(r=t[i-1])?t=Ot(t[0])?t[0]:t.slice(0,i-1):(t=Ot(t[0])?t[0]:t,r=[])}let n=-1,a=-1,o=-1,c=t.length,l,s,[u,y]=e;for(;++o<c;)s=t[o],s instanceof Ft.Column&&(y[++a]=s)?u[++n]=s.field.clone(r[o],s.type,!0):({[o]:l=o}=r,s instanceof Mh.DataType&&(y[++a]=s)?u[++n]=Oh.Field.new(l,s,!0):s&&s.type&&(y[++a]=s)&&(s instanceof Fh.Data&&(y[a]=s=ji.Vector.new(s)),u[++n]=Oh.Field.new(l,s.type,!0)));return e}});var de=b(Os=>{"use strict";Object.defineProperty(Os,"__esModule",{value:!0});var Q_=P(),X_=Dt(),eg=Dt(),xh=Vo(),Er=class t{constructor(e=[],r,i){this.fields=e||[],this.metadata=r||new Map,i||(i=fu(e)),this.dictionaries=i}static from(...e){return t.new(e[0],e[1])}static new(...e){return new t(eg.selectFieldArgs(e)[0])}get[Symbol.toStringTag](){return"Schema"}toString(){return`Schema<{ ${this.fields.map((e,r)=>`${r}: ${e}`).join(", ")} }>`}compareTo(e){return xh.instance.compareSchemas(this,e)}select(...e){let r=e.reduce((i,n)=>(i[n]=!0)&&i,Object.create(null));return new t(this.fields.filter(i=>r[i.name]),this.metadata)}selectAt(...e){return new t(e.map(r=>this.fields[r]).filter(Boolean),this.metadata)}assign(...e){let r=e[0]instanceof t?e[0]:new t(X_.selectArgs(Vt,e)),i=[...this.fields],n=Fs(Fs(new Map,this.metadata),r.metadata),a=r.fields.filter(c=>{let l=i.findIndex(s=>s.name===c.name);return~l?(i[l]=c.clone({metadata:Fs(Fs(new Map,i[l].metadata),c.metadata)}))&&!1:!0}),o=fu(a,new Map);return new t([...i,...a],n,new Map([...this.dictionaries,...o]))}};Os.Schema=Er;var Vt=class t{constructor(e,r,i=!1,n){this.name=e,this.type=r,this.nullable=i,this.metadata=n||new Map}static new(...e){let[r,i,n,a]=e;return e[0]&&typeof e[0]=="object"&&({name:r}=e[0],i===void 0&&(i=e[0].type),n===void 0&&(n=e[0].nullable),a===void 0&&(a=e[0].metadata)),new t(`${r}`,i,n,a)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}compareTo(e){return xh.instance.compareField(this,e)}clone(...e){let[r,i,n,a]=e;return!e[0]||typeof e[0]!="object"?[r=this.name,i=this.type,n=this.nullable,a=this.metadata]=e:{name:r=this.name,type:i=this.type,nullable:n=this.nullable,metadata:a=this.metadata}=e[0],t.new(r,i,n,a)}};Os.Field=Vt;function Fs(t,e){return new Map([...t||new Map,...e||new Map])}function fu(t,e=new Map){for(let r=-1,i=t.length;++r<i;){let a=t[r].type;if(Q_.DataType.isDictionary(a)){if(!e.has(a.id))e.set(a.id,a.dictionary);else if(e.get(a.id)!==a.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}a.children&&a.children.length>0&&fu(a.children,e)}return e}Er.prototype.fields=null;Er.prototype.metadata=null;Er.prototype.dictionaries=null;Vt.prototype.type=null;Vt.prototype.name=null;Vt.prototype.nullable=null;Vt.prototype.metadata=null});var yu=b(pu=>{"use strict";Object.defineProperty(pu,"__esModule",{value:!0});var tg=ru(),rg=de(),ig=P(),ng=St(),sg=ee(),hu=class extends sg.VariableWidthBuilder{constructor(e){super(e),this._run=new tg.Run,this._offsets=new ng.OffsetsBufferBuilder}addChild(e,r="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new ig.List(new rg.Field(r,e.type,!0)),this.numChildren-1}clear(){return this._run.clear(),super.clear()}_flushPending(e){let r=this._run,i=this._offsets,n=this._setValue,a=0,o;for([a,o]of e)o===void 0?i.set(a,0):(i.set(a,o.length),n(this,a,r.bind(o)))}};pu.ListBuilder=hu});var _u=b(bu=>{"use strict";Object.defineProperty(bu,"__esModule",{value:!0});var ag=ru(),og=de(),cg=ee(),ug=P(),mu=class extends cg.Builder{constructor(){super(...arguments),this._run=new ag.Run}setValue(e,r){super.setValue(e,this._run.bind(r))}addChild(e,r="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");let i=this.children.push(e);return this.type=new ug.FixedSizeList(this.type.listSize,new og.Field(r,e.type,!0)),i}clear(){return this._run.clear(),super.clear()}};bu.FixedSizeListBuilder=mu});var wu=b(vu=>{"use strict";Object.defineProperty(vu,"__esModule",{value:!0});var lg=de(),dg=P(),fg=ee(),gu=class extends fg.VariableWidthBuilder{set(e,r){return super.set(e,r)}setValue(e,r){r=r instanceof Map?r:new Map(Object.entries(r));let i=this._pending||(this._pending=new Map),n=i.get(e);n&&(this._pendingLength-=n.size),this._pendingLength+=r.size,i.set(e,r)}addChild(e,r=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new dg.Map_(new lg.Field(r,e.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(e){let r=this._offsets,i=this._setValue;e.forEach((n,a)=>{n===void 0?r.set(a,0):(r.set(a,n.size),i(this,a,n))})}};vu.MapBuilder=gu});var Iu=b(Tu=>{"use strict";Object.defineProperty(Tu,"__esModule",{value:!0});var hg=de(),pg=ee(),yg=P(),Bu=class extends pg.Builder{addChild(e,r=`${this.numChildren}`){let i=this.children.push(e);return this.type=new yg.Struct([...this.type.children,new hg.Field(r,e.type,!0)]),i}};Tu.StructBuilder=Bu});var Du=b(Pi=>{"use strict";Object.defineProperty(Pi,"__esModule",{value:!0});var mg=de(),Lh=St(),bg=ee(),_g=P(),ki=class extends bg.Builder{constructor(e){super(e),this._typeIds=new Lh.DataBufferBuilder(new Int8Array(0),1),typeof e.valueToChildTypeId=="function"&&(this._valueToChildTypeId=e.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(e,r){return this.set(this.length,e,r)}set(e,r,i){return i===void 0&&(i=this._valueToChildTypeId(this,r,e)),this.setValid(e,this.isValid(r))&&this.setValue(e,r,i),this}setValue(e,r,i){this._typeIds.set(e,i),super.setValue(e,r)}addChild(e,r=`${this.children.length}`){let i=this.children.push(e),{type:{children:n,mode:a,typeIds:o}}=this,c=[...n,new mg.Field(r,e.type)];return this.type=new _g.Union(a,[...o,i],c),i}_valueToChildTypeId(e,r,i){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}};Pi.UnionBuilder=ki;var Su=class extends ki{};Pi.SparseUnionBuilder=Su;var Au=class extends ki{constructor(e){super(e),this._offsets=new Lh.DataBufferBuilder(new Int32Array(0))}setValue(e,r,i){let n=this.type.typeIdToChildIndex[i];return this._offsets.set(e,this.getChildAt(n).length),super.setValue(e,r,i)}};Pi.DenseUnionBuilder=Au});var Mu=b(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});var gg=ie(),vg=ye(),wg=Pt(),Bg=Mi(),Tg=se(),xe=Y(),O=class extends vg.Visitor{};Ms.SetVisitor=O;var Ig=(t,e,r)=>{t[e]=r/864e5|0},Fu=(t,e,r)=>{t[e]=r%4294967296|0,t[e+1]=r/4294967296|0},Sg=(t,e,r)=>{t[e]=r*1e3%4294967296|0,t[e+1]=r*1e3/4294967296|0},Ag=(t,e,r)=>{t[e]=r*1e6%4294967296|0,t[e+1]=r*1e6/4294967296|0},Nh=(t,e,r,i)=>{let{[r]:n,[r+1]:a}=e;n!=null&&a!=null&&t.set(i.subarray(0,a-n),n)},Dg=({offset:t,values:e},r,i)=>{let n=t+r;i?e[n>>3]|=1<<n%8:e[n>>3]&=~(1<<n%8)},Eh=({values:t},e,r)=>{Ig(t,e,r.valueOf())},Rh=({values:t},e,r)=>{Fu(t,e*2,r.valueOf())},rt=({stride:t,values:e},r,i)=>{e[t*r]=i},qh=({stride:t,values:e},r,i)=>{e[t*r]=Bg.float64ToUint16(i)},Ou=(t,e,r)=>{switch(typeof r){case"bigint":t.values64[e]=r;break;case"number":t.values[e*t.stride]=r;break;default:let i=r,{stride:n,ArrayType:a}=t,o=Tg.toArrayBufferView(a,i);t.values.set(o.subarray(0,n),n*e)}},Fg=({stride:t,values:e},r,i)=>{e.set(i.subarray(0,t),t*r)},Og=({values:t,valueOffsets:e},r,i)=>Nh(t,e,r,i),Mg=({values:t,valueOffsets:e},r,i)=>{Nh(t,e,r,wg.encodeUtf8(i))},Vg=(t,e,r)=>{t.type.bitWidth<64?rt(t,e,r):Ou(t,e,r)},Ug=(t,e,r)=>{t.type.precision!==xe.Precision.HALF?rt(t,e,r):qh(t,e,r)},xg=(t,e,r)=>{t.type.unit===xe.DateUnit.DAY?Eh(t,e,r):Rh(t,e,r)},Ch=({values:t},e,r)=>Fu(t,e*2,r/1e3),jh=({values:t},e,r)=>Fu(t,e*2,r),kh=({values:t},e,r)=>Sg(t,e*2,r),Ph=({values:t},e,r)=>Ag(t,e*2,r),Lg=(t,e,r)=>{switch(t.type.unit){case xe.TimeUnit.SECOND:return Ch(t,e,r);case xe.TimeUnit.MILLISECOND:return jh(t,e,r);case xe.TimeUnit.MICROSECOND:return kh(t,e,r);case xe.TimeUnit.NANOSECOND:return Ph(t,e,r)}},zh=({values:t,stride:e},r,i)=>{t[e*r]=i},$h=({values:t,stride:e},r,i)=>{t[e*r]=i},Wh=({values:t},e,r)=>{t.set(r.subarray(0,2),2*e)},Yh=({values:t},e,r)=>{t.set(r.subarray(0,2),2*e)},Ng=(t,e,r)=>{switch(t.type.unit){case xe.TimeUnit.SECOND:return zh(t,e,r);case xe.TimeUnit.MILLISECOND:return $h(t,e,r);case xe.TimeUnit.MICROSECOND:return Wh(t,e,r);case xe.TimeUnit.NANOSECOND:return Yh(t,e,r)}},Eg=({values:t},e,r)=>{t.set(r.subarray(0,4),4*e)},Rg=(t,e,r)=>{let i=t.getChildAt(0),n=t.valueOffsets;for(let a=-1,o=n[e],c=n[e+1];o<c;)i.set(o++,r.get(++a))},qg=(t,e,r)=>{let i=t.getChildAt(0),n=t.valueOffsets,a=r instanceof Map?[...r]:Object.entries(r);for(let o=-1,c=n[e],l=n[e+1];c<l;)i.set(c++,a[++o])},Cg=(t,e)=>(r,i,n)=>r&&r.set(t,e[n]),jg=(t,e)=>(r,i,n)=>r&&r.set(t,e.get(n)),kg=(t,e)=>(r,i,n)=>r&&r.set(t,e.get(i.name)),Pg=(t,e)=>(r,i,n)=>r&&r.set(t,e[i.name]),zg=(t,e,r)=>{let i=r instanceof Map?kg(e,r):r instanceof gg.Vector?jg(e,r):Array.isArray(r)?Cg(e,r):Pg(e,r);t.type.children.forEach((n,a)=>i(t.getChildAt(a),n,a))},$g=(t,e,r)=>{t.type.mode===xe.UnionMode.Dense?Hh(t,e,r):Jh(t,e,r)},Hh=(t,e,r)=>{let i=t.typeIdToChildIndex[t.typeIds[e]],n=t.getChildAt(i);n&&n.set(t.valueOffsets[e],r)},Jh=(t,e,r)=>{let i=t.typeIdToChildIndex[t.typeIds[e]],n=t.getChildAt(i);n&&n.set(e,r)},Wg=(t,e,r)=>{let i=t.getKey(e);i!==null&&t.setValue(i,r)},Yg=(t,e,r)=>{t.type.unit===xe.IntervalUnit.DAY_TIME?Gh(t,e,r):Kh(t,e,r)},Gh=({values:t},e,r)=>{t.set(r.subarray(0,2),2*e)},Kh=({values:t},e,r)=>{t[e]=r[0]*12+r[1]%12},Hg=(t,e,r)=>{let i=t.getChildAt(0),{stride:n}=t;for(let a=-1,o=e*n;++a<n;)i.set(o+a,r.get(a))};O.prototype.visitBool=Dg;O.prototype.visitInt=Vg;O.prototype.visitInt8=rt;O.prototype.visitInt16=rt;O.prototype.visitInt32=rt;O.prototype.visitInt64=Ou;O.prototype.visitUint8=rt;O.prototype.visitUint16=rt;O.prototype.visitUint32=rt;O.prototype.visitUint64=Ou;O.prototype.visitFloat=Ug;O.prototype.visitFloat16=qh;O.prototype.visitFloat32=rt;O.prototype.visitFloat64=rt;O.prototype.visitUtf8=Mg;O.prototype.visitBinary=Og;O.prototype.visitFixedSizeBinary=Fg;O.prototype.visitDate=xg;O.prototype.visitDateDay=Eh;O.prototype.visitDateMillisecond=Rh;O.prototype.visitTimestamp=Lg;O.prototype.visitTimestampSecond=Ch;O.prototype.visitTimestampMillisecond=jh;O.prototype.visitTimestampMicrosecond=kh;O.prototype.visitTimestampNanosecond=Ph;O.prototype.visitTime=Ng;O.prototype.visitTimeSecond=zh;O.prototype.visitTimeMillisecond=$h;O.prototype.visitTimeMicrosecond=Wh;O.prototype.visitTimeNanosecond=Yh;O.prototype.visitDecimal=Eg;O.prototype.visitList=Rg;O.prototype.visitStruct=zg;O.prototype.visitUnion=$g;O.prototype.visitDenseUnion=Hh;O.prototype.visitSparseUnion=Jh;O.prototype.visitDictionary=Wg;O.prototype.visitInterval=Yg;O.prototype.visitIntervalDayTime=Gh;O.prototype.visitIntervalYearMonth=Kh;O.prototype.visitFixedSizeList=Hg;O.prototype.visitMap=qg;Ms.instance=new O});var Zh=b(xs=>{"use strict";Object.defineProperty(xs,"__esModule",{value:!0});var Jg=ye(),Gg=vs(),Kg=ac(),Vu=fc(),Zg=yc(),Qg=gc(),Xg=Bc(),ev=_u(),Vs=Ac(),Uu=Kc(),yt=Rc(),tv=yu(),rv=wu(),iv=uc(),nv=Iu(),zi=Hc(),$i=Pc(),xu=Du(),sv=Bs(),Us=class extends Jg.Visitor{visitNull(){return iv.NullBuilder}visitBool(){return Kg.BoolBuilder}visitInt(){return yt.IntBuilder}visitInt8(){return yt.Int8Builder}visitInt16(){return yt.Int16Builder}visitInt32(){return yt.Int32Builder}visitInt64(){return yt.Int64Builder}visitUint8(){return yt.Uint8Builder}visitUint16(){return yt.Uint16Builder}visitUint32(){return yt.Uint32Builder}visitUint64(){return yt.Uint64Builder}visitFloat(){return Vs.FloatBuilder}visitFloat16(){return Vs.Float16Builder}visitFloat32(){return Vs.Float32Builder}visitFloat64(){return Vs.Float64Builder}visitUtf8(){return sv.Utf8Builder}visitBinary(){return Gg.BinaryBuilder}visitFixedSizeBinary(){return Xg.FixedSizeBinaryBuilder}visitDate(){return Vu.DateBuilder}visitDateDay(){return Vu.DateDayBuilder}visitDateMillisecond(){return Vu.DateMillisecondBuilder}visitTimestamp(){return zi.TimestampBuilder}visitTimestampSecond(){return zi.TimestampSecondBuilder}visitTimestampMillisecond(){return zi.TimestampMillisecondBuilder}visitTimestampMicrosecond(){return zi.TimestampMicrosecondBuilder}visitTimestampNanosecond(){return zi.TimestampNanosecondBuilder}visitTime(){return $i.TimeBuilder}visitTimeSecond(){return $i.TimeSecondBuilder}visitTimeMillisecond(){return $i.TimeMillisecondBuilder}visitTimeMicrosecond(){return $i.TimeMicrosecondBuilder}visitTimeNanosecond(){return $i.TimeNanosecondBuilder}visitDecimal(){return Zg.DecimalBuilder}visitList(){return tv.ListBuilder}visitStruct(){return nv.StructBuilder}visitUnion(){return xu.UnionBuilder}visitDenseUnion(){return xu.DenseUnionBuilder}visitSparseUnion(){return xu.SparseUnionBuilder}visitDictionary(){return Qg.DictionaryBuilder}visitInterval(){return Uu.IntervalBuilder}visitIntervalDayTime(){return Uu.IntervalDayTimeBuilder}visitIntervalYearMonth(){return Uu.IntervalYearMonthBuilder}visitFixedSizeList(){return ev.FixedSizeListBuilder}visitMap(){return rv.MapBuilder}};xs.GetBuilderCtor=Us;xs.instance=new Us});var Ns=b(M=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});var av=ee();M.Builder=av.Builder;var ov=ac();M.BoolBuilder=ov.BoolBuilder;var cv=uc();M.NullBuilder=cv.NullBuilder;var Nu=fc();M.DateBuilder=Nu.DateBuilder;M.DateDayBuilder=Nu.DateDayBuilder;M.DateMillisecondBuilder=Nu.DateMillisecondBuilder;var uv=yc();M.DecimalBuilder=uv.DecimalBuilder;var lv=gc();M.DictionaryBuilder=lv.DictionaryBuilder;var dv=Bc();M.FixedSizeBinaryBuilder=dv.FixedSizeBinaryBuilder;var Ls=Ac();M.FloatBuilder=Ls.FloatBuilder;M.Float16Builder=Ls.Float16Builder;M.Float32Builder=Ls.Float32Builder;M.Float64Builder=Ls.Float64Builder;var mt=Rc();M.IntBuilder=mt.IntBuilder;M.Int8Builder=mt.Int8Builder;M.Int16Builder=mt.Int16Builder;M.Int32Builder=mt.Int32Builder;M.Int64Builder=mt.Int64Builder;M.Uint8Builder=mt.Uint8Builder;M.Uint16Builder=mt.Uint16Builder;M.Uint32Builder=mt.Uint32Builder;M.Uint64Builder=mt.Uint64Builder;var Wi=Pc();M.TimeBuilder=Wi.TimeBuilder;M.TimeSecondBuilder=Wi.TimeSecondBuilder;M.TimeMillisecondBuilder=Wi.TimeMillisecondBuilder;M.TimeMicrosecondBuilder=Wi.TimeMicrosecondBuilder;M.TimeNanosecondBuilder=Wi.TimeNanosecondBuilder;var Yi=Hc();M.TimestampBuilder=Yi.TimestampBuilder;M.TimestampSecondBuilder=Yi.TimestampSecondBuilder;M.TimestampMillisecondBuilder=Yi.TimestampMillisecondBuilder;M.TimestampMicrosecondBuilder=Yi.TimestampMicrosecondBuilder;M.TimestampNanosecondBuilder=Yi.TimestampNanosecondBuilder;var Eu=Kc();M.IntervalBuilder=Eu.IntervalBuilder;M.IntervalDayTimeBuilder=Eu.IntervalDayTimeBuilder;M.IntervalYearMonthBuilder=Eu.IntervalYearMonthBuilder;var fv=Bs();M.Utf8Builder=fv.Utf8Builder;var hv=vs();M.BinaryBuilder=hv.BinaryBuilder;var pv=yu();M.ListBuilder=pv.ListBuilder;var yv=_u();M.FixedSizeListBuilder=yv.FixedSizeListBuilder;var mv=wu();M.MapBuilder=mv.MapBuilder;var bv=Iu();M.StructBuilder=bv.StructBuilder;var Ru=Du();M.UnionBuilder=Ru.UnionBuilder;M.SparseUnionBuilder=Ru.SparseUnionBuilder;M.DenseUnionBuilder=Ru.DenseUnionBuilder;var Lu=Y(),_v=Bs(),gv=ee(),Qh=Mu(),Xh=Zh();gv.Builder.new=ep;function ep(t){let e=t.type,r=new(Xh.instance.getVisitFn(e)())(t);if(e.children&&e.children.length>0){let i=t.children||[],n={nullValues:t.nullValues},a=Array.isArray(i)?((o,c)=>i[c]||n):(({name:o})=>i[o]||n);e.children.forEach((o,c)=>{let{type:l}=o,s=a(o,c);r.children.push(ep({...s,type:l}))})}return r}Object.keys(Lu.Type).map(t=>Lu.Type[t]).filter(t=>typeof t=="number"&&t!==Lu.Type.NONE).forEach(t=>{let e=Xh.instance.visit(t);e.prototype._setValue=Qh.instance.getVisitFn(t)});_v.Utf8Builder.prototype._setValue=Qh.instance.visitBinary});var rp=b(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});var qu=Sr(),tp;(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}static getRootAsFooter(s,u){return(u||new c).__init(s.readInt32(s.position())+s.position(),s)}version(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt16(this.bb_pos+s):qu.org.apache.arrow.flatbuf.MetadataVersion.V1}schema(s){let u=this.bb.__offset(this.bb_pos,6);return u?(s||new qu.org.apache.arrow.flatbuf.Schema).__init(this.bb.__indirect(this.bb_pos+u),this.bb):null}dictionaries(s,u){let y=this.bb.__offset(this.bb_pos,8);return y?(u||new t.apache.arrow.flatbuf.Block).__init(this.bb.__vector(this.bb_pos+y)+s*24,this.bb):null}dictionariesLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}recordBatches(s,u){let y=this.bb.__offset(this.bb_pos,10);return y?(u||new t.apache.arrow.flatbuf.Block).__init(this.bb.__vector(this.bb_pos+y)+s*24,this.bb):null}recordBatchesLength(){let s=this.bb.__offset(this.bb_pos,10);return s?this.bb.__vector_len(this.bb_pos+s):0}static startFooter(s){s.startObject(4)}static addVersion(s,u){s.addFieldInt16(0,u,qu.org.apache.arrow.flatbuf.MetadataVersion.V1)}static addSchema(s,u){s.addFieldOffset(1,u,0)}static addDictionaries(s,u){s.addFieldOffset(2,u,0)}static startDictionariesVector(s,u){s.startVector(24,u,8)}static addRecordBatches(s,u){s.addFieldOffset(3,u,0)}static startRecordBatchesVector(s,u){s.startVector(24,u,8)}static endFooter(s){return s.endObject()}static finishFooterBuffer(s,u){s.finish(u)}static createFooter(s,u,y,w,C){return c.startFooter(s),c.addVersion(s,u),c.addSchema(s,y),c.addDictionaries(s,w),c.addRecordBatches(s,C),c.endFooter(s)}}o.Footer=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(tp=Rr.org||(Rr.org={}));(function(t){var e;(function(r){var i;(function(n){var a;(function(o){class c{constructor(){this.bb=null,this.bb_pos=0}__init(s,u){return this.bb_pos=s,this.bb=u,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static createBlock(s,u,y,w){return s.prep(8,24),s.writeInt64(w),s.pad(4),s.writeInt32(y),s.writeInt64(u),s.offset()}}o.Block=c})(a=n.flatbuf||(n.flatbuf={}))})(i=r.arrow||(r.arrow={}))})(e=t.apache||(t.apache={}))})(tp=Rr.org||(Rr.org={}))});var ku=b(Rs=>{"use strict";Object.defineProperty(Rs,"__esModule",{value:!0});var ap=rp(),ju=Br(),ip=ju.flatbuffers.Long,vv=ju.flatbuffers.Builder,wv=ju.flatbuffers.ByteBuffer,Bv=ap.org.apache.arrow.flatbuf.Block,it=ap.org.apache.arrow.flatbuf.Footer,np=de(),sp=Y(),Tv=se(),Es=class{constructor(e,r=sp.MetadataVersion.V4,i,n){this.schema=e,this.version=r,i&&(this._recordBatches=i),n&&(this._dictionaryBatches=n)}static decode(e){e=new wv(Tv.toUint8Array(e));let r=it.getRootAsFooter(e),i=np.Schema.decode(r.schema());return new Cu(i,r)}static encode(e){let r=new vv,i=np.Schema.encode(r,e.schema);it.startRecordBatchesVector(r,e.numRecordBatches),[...e.recordBatches()].slice().reverse().forEach(o=>Xt.encode(r,o));let n=r.endVector();it.startDictionariesVector(r,e.numDictionaries),[...e.dictionaryBatches()].slice().reverse().forEach(o=>Xt.encode(r,o));let a=r.endVector();return it.startFooter(r),it.addSchema(r,i),it.addVersion(r,sp.MetadataVersion.V4),it.addRecordBatches(r,n),it.addDictionaries(r,a),it.finishFooterBuffer(r,it.endFooter(r)),r.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let e,r=-1,i=this.numRecordBatches;++r<i;)(e=this.getRecordBatch(r))&&(yield e)}*dictionaryBatches(){for(let e,r=-1,i=this.numDictionaries;++r<i;)(e=this.getDictionaryBatch(r))&&(yield e)}getRecordBatch(e){return e>=0&&e<this.numRecordBatches&&this._recordBatches[e]||null}getDictionaryBatch(e){return e>=0&&e<this.numDictionaries&&this._dictionaryBatches[e]||null}};Rs.Footer=Es;var Cu=class extends Es{constructor(e,r){super(e,r.version()),this._footer=r}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(e){if(e>=0&&e<this.numRecordBatches){let r=this._footer.recordBatches(e);if(r)return Xt.decode(r)}return null}getDictionaryBatch(e){if(e>=0&&e<this.numDictionaries){let r=this._footer.dictionaries(e);if(r)return Xt.decode(r)}return null}},Xt=class t{static decode(e){return new t(e.metaDataLength(),e.bodyLength(),e.offset())}static encode(e,r){let{metaDataLength:i}=r,n=new ip(r.offset,0),a=new ip(r.bodyLength,0);return Bv.createBlock(e,n,i,a)}constructor(e,r,i){this.metaDataLength=e,this.offset=typeof i=="number"?i:i.low,this.bodyLength=typeof r=="number"?r:r.low}};Rs.FileBlock=Xt});var xt=b(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});var Ut=ui(),op=Pt(),Hi=Ir(),Pu=se(),qr=_e(),qs=class extends Hi.AsyncQueue{write(e){if((e=Pu.toUint8Array(e)).byteLength>0)return super.write(e)}toString(e=!1){return e?op.decodeUtf8(this.toUint8Array(!0)):this.toUint8Array(!1).then(op.decodeUtf8)}toUint8Array(e=!1){return e?Pu.joinUint8Arrays(this._values)[0]:(async()=>{let r=[],i=0;for await(let n of this)r.push(n),i+=n.byteLength;return Pu.joinUint8Arrays(r,i)[0]})()}};Ji.AsyncByteQueue=qs;var zu=class{constructor(e){e&&(this.source=new Wu(Ut.default.fromIterable(e)))}[Symbol.iterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}};Ji.ByteStream=zu;var $u=class t{constructor(e){e instanceof t?this.source=e.source:e instanceof qs?this.source=new bt(Ut.default.fromAsyncIterable(e)):qr.isReadableNodeStream(e)?this.source=new bt(Ut.default.fromNodeStream(e)):qr.isReadableDOMStream(e)?this.source=new bt(Ut.default.fromDOMStream(e)):qr.isFetchResponse(e)?this.source=new bt(Ut.default.fromDOMStream(e.body)):qr.isIterable(e)?this.source=new bt(Ut.default.fromIterable(e)):qr.isPromise(e)?this.source=new bt(Ut.default.fromAsyncIterable(e)):qr.isAsyncIterable(e)&&(this.source=new bt(Ut.default.fromAsyncIterable(e)))}[Symbol.asyncIterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}get closed(){return this.source.closed}cancel(e){return this.source.cancel(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}};Ji.AsyncByteStream=$u;var Wu=class{constructor(e){this.source=e}cancel(e){this.return(e)}peek(e){return this.next(e,"peek").value}read(e){return this.next(e,"read").value}next(e,r="read"){return this.source.next({cmd:r,size:e})}throw(e){return Object.create(this.source.throw&&this.source.throw(e)||Hi.ITERATOR_DONE)}return(e){return Object.create(this.source.return&&this.source.return(e)||Hi.ITERATOR_DONE)}},bt=class{constructor(e){this.source=e,this._closedPromise=new Promise(r=>this._closedPromiseResolve=r)}async cancel(e){await this.return(e)}get closed(){return this._closedPromise}async read(e){return(await this.next(e,"read")).value}async peek(e){return(await this.next(e,"peek")).value}async next(e,r="read"){return await this.source.next({cmd:r,size:e})}async throw(e){let r=this.source.throw&&await this.source.throw(e)||Hi.ITERATOR_DONE;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)}async return(e){let r=this.source.return&&await this.source.return(e)||Hi.ITERATOR_DONE;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)}}});var Ju=b(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});var cp=xt(),Iv=se(),Yu=class extends cp.ByteStream{constructor(e,r){super(),this.position=0,this.buffer=Iv.toUint8Array(e),this.size=typeof r>"u"?this.buffer.byteLength:r}readInt32(e){let{buffer:r,byteOffset:i}=this.readAt(e,4);return new DataView(r,i).getInt32(0,!0)}seek(e){return this.position=Math.min(e,this.size),e<this.size}read(e){let{buffer:r,size:i,position:n}=this;return r&&n<i?(typeof e!="number"&&(e=1/0),this.position=Math.min(i,n+Math.min(i-n,e)),r.subarray(n,this.position)):null}readAt(e,r){let i=this.buffer,n=Math.min(this.size,e+r);return i?i.subarray(e,n):new Uint8Array(r)}close(){this.buffer&&(this.buffer=null)}throw(e){return this.close(),{done:!0,value:e}}return(e){return this.close(),{done:!0,value:e}}};Cs.RandomAccessFile=Yu;var Hu=class extends cp.AsyncByteStream{constructor(e,r){super(),this.position=0,this._handle=e,typeof r=="number"?this.size=r:this._pending=(async()=>{this.size=(await e.stat()).size,delete this._pending})()}async readInt32(e){let{buffer:r,byteOffset:i}=await this.readAt(e,4);return new DataView(r,i).getInt32(0,!0)}async seek(e){return this._pending&&await this._pending,this.position=Math.min(e,this.size),e<this.size}async read(e){this._pending&&await this._pending;let{_handle:r,size:i,position:n}=this;if(r&&n<i){typeof e!="number"&&(e=1/0);let a=n,o=0,c=0,l=Math.min(i,a+Math.min(i-a,e)),s=new Uint8Array(Math.max(0,(this.position=l)-a));for(;(a+=c)<l&&(o+=c)<s.byteLength;)({bytesRead:c}=await r.read(s,o,s.byteLength-o,a));return s}return null}async readAt(e,r){this._pending&&await this._pending;let{_handle:i,size:n}=this;if(i&&e+r<n){let a=Math.min(n,e+r),o=new Uint8Array(a-e);return(await i.read(o,0,r,e)).buffer}return new Uint8Array(r)}async close(){let e=this._handle;this._handle=null,e&&await e.close()}async throw(e){return await this.close(),{done:!0,value:e}}async return(e){return await this.close(),{done:!0,value:e}}};Cs.AsyncRandomAccessFile=Hu});var Zu=b(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});var Sv=65536;function Cr(t){return t<0&&(t=4294967295+t+1),`0x${t.toString(16)}`}var jr=8,Ku=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8],Gi=class{constructor(e){this.buffer=e}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(e){let r=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),i=new Uint32Array([e.buffer[1]>>>16,e.buffer[1]&65535,e.buffer[0]>>>16,e.buffer[0]&65535]),n=r[3]*i[3];this.buffer[0]=n&65535;let a=n>>>16;return n=r[2]*i[3],a+=n,n=r[3]*i[2]>>>0,a+=n,this.buffer[0]+=a<<16,this.buffer[1]=a>>>0<n?Sv:0,this.buffer[1]+=a>>>16,this.buffer[1]+=r[1]*i[3]+r[2]*i[2]+r[3]*i[1],this.buffer[1]+=r[0]*i[3]+r[1]*i[2]+r[2]*i[1]+r[3]*i[0]<<16,this}_plus(e){let r=this.buffer[0]+e.buffer[0]>>>0;this.buffer[1]+=e.buffer[1],r<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=r}lessThan(e){return this.buffer[1]<e.buffer[1]||this.buffer[1]===e.buffer[1]&&this.buffer[0]<e.buffer[0]}equals(e){return this.buffer[1]===e.buffer[1]&&this.buffer[0]==e.buffer[0]}greaterThan(e){return e.lessThan(this)}hex(){return`${Cr(this.buffer[1])} ${Cr(this.buffer[0])}`}};kr.BaseInt64=Gi;var Q=class t extends Gi{times(e){return this._times(e),this}plus(e){return this._plus(e),this}static from(e,r=new Uint32Array(2)){return t.fromString(typeof e=="string"?e:e.toString(),r)}static fromNumber(e,r=new Uint32Array(2)){return t.fromString(e.toString(),r)}static fromString(e,r=new Uint32Array(2)){let i=e.length,n=new t(r);for(let a=0;a<i;){let o=jr<i-a?jr:i-a,c=new t(new Uint32Array([parseInt(e.substr(a,o),10),0])),l=new t(new Uint32Array([Ku[o],0]));n.times(l),n.plus(c),a+=o}return n}static convertArray(e){let r=new Uint32Array(e.length*2);for(let i=-1,n=e.length;++i<n;)t.from(e[i],new Uint32Array(r.buffer,r.byteOffset+2*i*4,2));return r}static multiply(e,r){return new t(new Uint32Array(e.buffer)).times(r)}static add(e,r){return new t(new Uint32Array(e.buffer)).plus(r)}};kr.Uint64=Q;var Ki=class t extends Gi{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(e){return this._times(e),this}plus(e){return this._plus(e),this}lessThan(e){let r=this.buffer[1]<<0,i=e.buffer[1]<<0;return r<i||r===i&&this.buffer[0]<e.buffer[0]}static from(e,r=new Uint32Array(2)){return t.fromString(typeof e=="string"?e:e.toString(),r)}static fromNumber(e,r=new Uint32Array(2)){return t.fromString(e.toString(),r)}static fromString(e,r=new Uint32Array(2)){let i=e.startsWith("-"),n=e.length,a=new t(r);for(let o=i?1:0;o<n;){let c=jr<n-o?jr:n-o,l=new t(new Uint32Array([parseInt(e.substr(o,c),10),0])),s=new t(new Uint32Array([Ku[c],0]));a.times(s),a.plus(l),o+=c}return i?a.negate():a}static convertArray(e){let r=new Uint32Array(e.length*2);for(let i=-1,n=e.length;++i<n;)t.from(e[i],new Uint32Array(r.buffer,r.byteOffset+2*i*4,2));return r}static multiply(e,r){return new t(new Uint32Array(e.buffer)).times(r)}static add(e,r){return new t(new Uint32Array(e.buffer)).plus(r)}};kr.Int64=Ki;var Gu=class t{constructor(e){this.buffer=e}high(){return new Ki(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Ki(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(e){let r=new Q(new Uint32Array([this.buffer[3],0])),i=new Q(new Uint32Array([this.buffer[2],0])),n=new Q(new Uint32Array([this.buffer[1],0])),a=new Q(new Uint32Array([this.buffer[0],0])),o=new Q(new Uint32Array([e.buffer[3],0])),c=new Q(new Uint32Array([e.buffer[2],0])),l=new Q(new Uint32Array([e.buffer[1],0])),s=new Q(new Uint32Array([e.buffer[0],0])),u=Q.multiply(a,s);this.buffer[0]=u.low();let y=new Q(new Uint32Array([u.high(),0]));return u=Q.multiply(n,s),y.plus(u),u=Q.multiply(a,l),y.plus(u),this.buffer[1]=y.low(),this.buffer[3]=y.lessThan(u)?1:0,this.buffer[2]=y.high(),new Q(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(Q.multiply(i,s)).plus(Q.multiply(n,l)).plus(Q.multiply(a,c)),this.buffer[3]+=Q.multiply(r,s).plus(Q.multiply(i,l)).plus(Q.multiply(n,c)).plus(Q.multiply(a,o)).low(),this}plus(e){let r=new Uint32Array(4);return r[3]=this.buffer[3]+e.buffer[3]>>>0,r[2]=this.buffer[2]+e.buffer[2]>>>0,r[1]=this.buffer[1]+e.buffer[1]>>>0,r[0]=this.buffer[0]+e.buffer[0]>>>0,r[0]<this.buffer[0]>>>0&&++r[1],r[1]<this.buffer[1]>>>0&&++r[2],r[2]<this.buffer[2]>>>0&&++r[3],this.buffer[3]=r[3],this.buffer[2]=r[2],this.buffer[1]=r[1],this.buffer[0]=r[0],this}hex(){return`${Cr(this.buffer[3])} ${Cr(this.buffer[2])} ${Cr(this.buffer[1])} ${Cr(this.buffer[0])}`}static multiply(e,r){return new t(new Uint32Array(e.buffer)).times(r)}static add(e,r){return new t(new Uint32Array(e.buffer)).plus(r)}static from(e,r=new Uint32Array(4)){return t.fromString(typeof e=="string"?e:e.toString(),r)}static fromNumber(e,r=new Uint32Array(4)){return t.fromString(e.toString(),r)}static fromString(e,r=new Uint32Array(4)){let i=e.startsWith("-"),n=e.length,a=new t(r);for(let o=i?1:0;o<n;){let c=jr<n-o?jr:n-o,l=new t(new Uint32Array([parseInt(e.substr(o,c),10),0,0,0])),s=new t(new Uint32Array([Ku[c],0,0,0]));a.times(s),a.plus(l),o+=c}return i?a.negate():a}static convertArray(e){let r=new Uint32Array(e.length*4);for(let i=-1,n=e.length;++i<n;)t.from(e[i],new Uint32Array(r.buffer,r.byteOffset+16*i,4));return r}};kr.Int128=Gu});var dp=b(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});var oe=ke(),Av=de(),_t=P(),Dv=ye(),up=tt(),Fv=Pt(),js=Zu(),lp=Y(),nt=se(),ks=class extends Dv.Visitor{constructor(e,r,i,n){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=e,this.nodes=r,this.buffers=i,this.dictionaries=n}visit(e){return super.visit(e instanceof Av.Field?e.type:e)}visitNull(e,{length:r}=this.nextFieldNode()){return oe.Data.Null(e,0,r)}visitBool(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Bool(e,0,r,i,this.readNullBitmap(e,i),this.readData(e))}visitInt(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Int(e,0,r,i,this.readNullBitmap(e,i),this.readData(e))}visitFloat(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Float(e,0,r,i,this.readNullBitmap(e,i),this.readData(e))}visitUtf8(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Utf8(e,0,r,i,this.readNullBitmap(e,i),this.readOffsets(e),this.readData(e))}visitBinary(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Binary(e,0,r,i,this.readNullBitmap(e,i),this.readOffsets(e),this.readData(e))}visitFixedSizeBinary(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.FixedSizeBinary(e,0,r,i,this.readNullBitmap(e,i),this.readData(e))}visitDate(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Date(e,0,r,i,this.readNullBitmap(e,i),this.readData(e))}visitTimestamp(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Timestamp(e,0,r,i,this.readNullBitmap(e,i),this.readData(e))}visitTime(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Time(e,0,r,i,this.readNullBitmap(e,i),this.readData(e))}visitDecimal(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Decimal(e,0,r,i,this.readNullBitmap(e,i),this.readData(e))}visitList(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.List(e,0,r,i,this.readNullBitmap(e,i),this.readOffsets(e),this.visit(e.children[0]))}visitStruct(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Struct(e,0,r,i,this.readNullBitmap(e,i),this.visitMany(e.children))}visitUnion(e){return e.mode===lp.UnionMode.Sparse?this.visitSparseUnion(e):this.visitDenseUnion(e)}visitDenseUnion(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Union(e,0,r,i,this.readNullBitmap(e,i),this.readTypeIds(e),this.readOffsets(e),this.visitMany(e.children))}visitSparseUnion(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Union(e,0,r,i,this.readNullBitmap(e,i),this.readTypeIds(e),this.visitMany(e.children))}visitDictionary(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Dictionary(e,0,r,i,this.readNullBitmap(e,i),this.readData(e.indices),this.readDictionary(e))}visitInterval(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Interval(e,0,r,i,this.readNullBitmap(e,i),this.readData(e))}visitFixedSizeList(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.FixedSizeList(e,0,r,i,this.readNullBitmap(e,i),this.visit(e.children[0]))}visitMap(e,{length:r,nullCount:i}=this.nextFieldNode()){return oe.Data.Map(e,0,r,i,this.readNullBitmap(e,i),this.readOffsets(e),this.visit(e.children[0]))}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(e,r,i=this.nextBufferRange()){return r>0&&this.readData(e,i)||new Uint8Array(0)}readOffsets(e,r){return this.readData(e,r)}readTypeIds(e,r){return this.readData(e,r)}readData(e,{length:r,offset:i}=this.nextBufferRange()){return this.bytes.subarray(i,i+r)}readDictionary(e){return this.dictionaries.get(e.id)}};Ps.VectorLoader=ks;var Qu=class extends ks{constructor(e,r,i,n){super(new Uint8Array(0),r,i,n),this.sources=e}readNullBitmap(e,r,{offset:i}=this.nextBufferRange()){return r<=0?new Uint8Array(0):up.packBools(this.sources[i])}readOffsets(e,{offset:r}=this.nextBufferRange()){return nt.toArrayBufferView(Uint8Array,nt.toArrayBufferView(Int32Array,this.sources[r]))}readTypeIds(e,{offset:r}=this.nextBufferRange()){return nt.toArrayBufferView(Uint8Array,nt.toArrayBufferView(e.ArrayType,this.sources[r]))}readData(e,{offset:r}=this.nextBufferRange()){let{sources:i}=this;return _t.DataType.isTimestamp(e)||(_t.DataType.isInt(e)||_t.DataType.isTime(e))&&e.bitWidth===64||_t.DataType.isDate(e)&&e.unit===lp.DateUnit.MILLISECOND?nt.toArrayBufferView(Uint8Array,js.Int64.convertArray(i[r])):_t.DataType.isDecimal(e)?nt.toArrayBufferView(Uint8Array,js.Int128.convertArray(i[r])):_t.DataType.isBinary(e)||_t.DataType.isFixedSizeBinary(e)?Ov(i[r]):_t.DataType.isBool(e)?up.packBools(i[r]):_t.DataType.isUtf8(e)?Fv.encodeUtf8(i[r].join("")):nt.toArrayBufferView(Uint8Array,nt.toArrayBufferView(e.ArrayType,i[r].map(n=>+n)))}};Ps.JSONVectorLoader=Qu;function Ov(t){let e=t.join(""),r=new Uint8Array(e.length/2);for(let i=0;i<e.length;i+=2)r[i>>1]=parseInt(e.substr(i,2),16);return r}});var _p=b(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});var Mv=Br(),Vv=Mv.flatbuffers.Long,fe=Sr(),Uv=ye(),fp=fe.org.apache.arrow.flatbuf.Null,zs=fe.org.apache.arrow.flatbuf.Int,Xu=fe.org.apache.arrow.flatbuf.FloatingPoint,hp=fe.org.apache.arrow.flatbuf.Binary,pp=fe.org.apache.arrow.flatbuf.Bool,yp=fe.org.apache.arrow.flatbuf.Utf8,$s=fe.org.apache.arrow.flatbuf.Decimal,el=fe.org.apache.arrow.flatbuf.Date,Ws=fe.org.apache.arrow.flatbuf.Time,Ys=fe.org.apache.arrow.flatbuf.Timestamp,tl=fe.org.apache.arrow.flatbuf.Interval,mp=fe.org.apache.arrow.flatbuf.List,bp=fe.org.apache.arrow.flatbuf.Struct_,Pr=fe.org.apache.arrow.flatbuf.Union,Zi=fe.org.apache.arrow.flatbuf.DictionaryEncoding,rl=fe.org.apache.arrow.flatbuf.FixedSizeBinary,il=fe.org.apache.arrow.flatbuf.FixedSizeList,nl=fe.org.apache.arrow.flatbuf.Map,Hs=class extends Uv.Visitor{visit(e,r){return e==null||r==null?void 0:super.visit(e,r)}visitNull(e,r){return fp.startNull(r),fp.endNull(r)}visitInt(e,r){return zs.startInt(r),zs.addBitWidth(r,e.bitWidth),zs.addIsSigned(r,e.isSigned),zs.endInt(r)}visitFloat(e,r){return Xu.startFloatingPoint(r),Xu.addPrecision(r,e.precision),Xu.endFloatingPoint(r)}visitBinary(e,r){return hp.startBinary(r),hp.endBinary(r)}visitBool(e,r){return pp.startBool(r),pp.endBool(r)}visitUtf8(e,r){return yp.startUtf8(r),yp.endUtf8(r)}visitDecimal(e,r){return $s.startDecimal(r),$s.addScale(r,e.scale),$s.addPrecision(r,e.precision),$s.endDecimal(r)}visitDate(e,r){return el.startDate(r),el.addUnit(r,e.unit),el.endDate(r)}visitTime(e,r){return Ws.startTime(r),Ws.addUnit(r,e.unit),Ws.addBitWidth(r,e.bitWidth),Ws.endTime(r)}visitTimestamp(e,r){let i=e.timezone&&r.createString(e.timezone)||void 0;return Ys.startTimestamp(r),Ys.addUnit(r,e.unit),i!==void 0&&Ys.addTimezone(r,i),Ys.endTimestamp(r)}visitInterval(e,r){return tl.startInterval(r),tl.addUnit(r,e.unit),tl.endInterval(r)}visitList(e,r){return mp.startList(r),mp.endList(r)}visitStruct(e,r){return bp.startStruct_(r),bp.endStruct_(r)}visitUnion(e,r){Pr.startTypeIdsVector(r,e.typeIds.length);let i=Pr.createTypeIdsVector(r,e.typeIds);return Pr.startUnion(r),Pr.addMode(r,e.mode),Pr.addTypeIds(r,i),Pr.endUnion(r)}visitDictionary(e,r){let i=this.visit(e.indices,r);return Zi.startDictionaryEncoding(r),Zi.addId(r,new Vv(e.id,0)),Zi.addIsOrdered(r,e.isOrdered),i!==void 0&&Zi.addIndexType(r,i),Zi.endDictionaryEncoding(r)}visitFixedSizeBinary(e,r){return rl.startFixedSizeBinary(r),rl.addByteWidth(r,e.byteWidth),rl.endFixedSizeBinary(r)}visitFixedSizeList(e,r){return il.startFixedSizeList(r),il.addListSize(r,e.listSize),il.endFixedSizeList(r)}visitMap(e,r){return nl.startMap(r),nl.addKeysSorted(r,e.keysSorted),nl.endMap(r)}};Js.TypeAssembler=Hs;Js.instance=new Hs});var Sp=b(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});var $r=de(),G=P(),er=tr(),zr=Y();function xv(t,e=new Map){return new $r.Schema(Nv(t,e),Gs(t.customMetadata),e)}Wr.schemaFromJSON=xv;function Bp(t){return new er.RecordBatch(t.count,Tp(t.columns),Ip(t.columns))}Wr.recordBatchFromJSON=Bp;function Lv(t){return new er.DictionaryBatch(Bp(t.data),t.id,t.isDelta)}Wr.dictionaryBatchFromJSON=Lv;function Nv(t,e){return(t.fields||[]).filter(Boolean).map(r=>$r.Field.fromJSON(r,e))}function gp(t,e){return(t.children||[]).filter(Boolean).map(r=>$r.Field.fromJSON(r,e))}function Tp(t){return(t||[]).reduce((e,r)=>[...e,new er.FieldNode(r.count,Ev(r.VALIDITY)),...Tp(r.children)],[])}function Ip(t,e=[]){for(let r=-1,i=(t||[]).length;++r<i;){let n=t[r];n.VALIDITY&&e.push(new er.BufferRegion(e.length,n.VALIDITY.length)),n.TYPE&&e.push(new er.BufferRegion(e.length,n.TYPE.length)),n.OFFSET&&e.push(new er.BufferRegion(e.length,n.OFFSET.length)),n.DATA&&e.push(new er.BufferRegion(e.length,n.DATA.length)),e=Ip(n.children,e)}return e}function Ev(t){return(t||[]).reduce((e,r)=>e+ +(r===0),0)}function Rv(t,e){let r,i,n,a,o,c;return!e||!(a=t.dictionary)?(o=wp(t,gp(t,e)),n=new $r.Field(t.name,o,t.nullable,Gs(t.customMetadata))):e.has(r=a.id)?(i=(i=a.indexType)?vp(i):new G.Int32,c=new G.Dictionary(e.get(r),i,r,a.isOrdered),n=new $r.Field(t.name,c,t.nullable,Gs(t.customMetadata))):(i=(i=a.indexType)?vp(i):new G.Int32,e.set(r,o=wp(t,gp(t,e))),c=new G.Dictionary(o,i,r,a.isOrdered),n=new $r.Field(t.name,c,t.nullable,Gs(t.customMetadata))),n||null}Wr.fieldFromJSON=Rv;function Gs(t){return new Map(Object.entries(t||{}))}function vp(t){return new G.Int(t.isSigned,t.bitWidth)}function wp(t,e){let r=t.type.name;switch(r){case"NONE":return new G.Null;case"null":return new G.Null;case"binary":return new G.Binary;case"utf8":return new G.Utf8;case"bool":return new G.Bool;case"list":return new G.List((e||[])[0]);case"struct":return new G.Struct(e||[]);case"struct_":return new G.Struct(e||[])}switch(r){case"int":{let i=t.type;return new G.Int(i.isSigned,i.bitWidth)}case"floatingpoint":{let i=t.type;return new G.Float(zr.Precision[i.precision])}case"decimal":{let i=t.type;return new G.Decimal(i.scale,i.precision)}case"date":{let i=t.type;return new G.Date_(zr.DateUnit[i.unit])}case"time":{let i=t.type;return new G.Time(zr.TimeUnit[i.unit],i.bitWidth)}case"timestamp":{let i=t.type;return new G.Timestamp(zr.TimeUnit[i.unit],i.timezone)}case"interval":{let i=t.type;return new G.Interval(zr.IntervalUnit[i.unit])}case"union":{let i=t.type;return new G.Union(zr.UnionMode[i.mode],i.typeIds||[],e||[])}case"fixedsizebinary":{let i=t.type;return new G.FixedSizeBinary(i.byteWidth)}case"fixedsizelist":{let i=t.type;return new G.FixedSizeList(i.listSize,(e||[])[0])}case"map":{let i=t.type;return new G.Map_((e||[])[0],i.keysSorted)}}throw new Error(`Unrecognized type: "${r}"`)}});var tr=b(ir=>{"use strict";Object.defineProperty(ir,"__esModule",{value:!0});var ol=Br(),be=Sr(),Zs=To(),he=de(),qv=se(),te=Y(),sl=_p(),Qs=Sp(),rr=ol.flatbuffers.Long,Cv=ol.flatbuffers.Builder,jv=ol.flatbuffers.ByteBuffer,ce=be.org.apache.arrow.flatbuf.Type,Ye=be.org.apache.arrow.flatbuf.Field,gt=be.org.apache.arrow.flatbuf.Schema,kv=be.org.apache.arrow.flatbuf.Buffer,Lt=Zs.org.apache.arrow.flatbuf.Message,Et=be.org.apache.arrow.flatbuf.KeyValue,Pv=Zs.org.apache.arrow.flatbuf.FieldNode,Ap=be.org.apache.arrow.flatbuf.Endianness,Nt=Zs.org.apache.arrow.flatbuf.RecordBatch,Yr=Zs.org.apache.arrow.flatbuf.DictionaryBatch,K=P(),al=class t{constructor(e,r,i,n){this._version=r,this._headerType=i,this.body=new Uint8Array(0),n&&(this._createHeader=()=>n),this._bodyLength=typeof e=="number"?e:e.low}static fromJSON(e,r){let i=new t(0,te.MetadataVersion.V4,r);return i._createHeader=zv(e,r),i}static decode(e){e=new jv(qv.toUint8Array(e));let r=Lt.getRootAsMessage(e),i=r.bodyLength(),n=r.version(),a=r.headerType(),o=new t(i,n,a);return o._createHeader=$v(r,a),o}static encode(e){let r=new Cv,i=-1;return e.isSchema()?i=he.Schema.encode(r,e.header()):e.isRecordBatch()?i=Ue.encode(r,e.header()):e.isDictionaryBatch()&&(i=He.encode(r,e.header())),Lt.startMessage(r),Lt.addVersion(r,te.MetadataVersion.V4),Lt.addHeader(r,i),Lt.addHeaderType(r,e.headerType),Lt.addBodyLength(r,new rr(e.bodyLength,0)),Lt.finishMessageBuffer(r,Lt.endMessage(r)),r.asUint8Array()}static from(e,r=0){if(e instanceof he.Schema)return new t(0,te.MetadataVersion.V4,te.MessageHeader.Schema,e);if(e instanceof Ue)return new t(r,te.MetadataVersion.V4,te.MessageHeader.RecordBatch,e);if(e instanceof He)return new t(r,te.MetadataVersion.V4,te.MessageHeader.DictionaryBatch,e);throw new Error(`Unrecognized Message header: ${e}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===te.MessageHeader.Schema}isRecordBatch(){return this.headerType===te.MessageHeader.RecordBatch}isDictionaryBatch(){return this.headerType===te.MessageHeader.DictionaryBatch}};ir.Message=al;var Ue=class{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(e,r,i){this._nodes=r,this._buffers=i,this._length=typeof e=="number"?e:e.low}};ir.RecordBatch=Ue;var He=class{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(e,r,i=!1){this._data=e,this._isDelta=i,this._id=typeof r=="number"?r:r.low}};ir.DictionaryBatch=He;var Rt=class{constructor(e,r){this.offset=typeof e=="number"?e:e.low,this.length=typeof r=="number"?r:r.low}};ir.BufferRegion=Rt;var qt=class{constructor(e,r){this.length=typeof e=="number"?e:e.low,this.nullCount=typeof r=="number"?r:r.low}};ir.FieldNode=qt;function zv(t,e){return(()=>{switch(e){case te.MessageHeader.Schema:return he.Schema.fromJSON(t);case te.MessageHeader.RecordBatch:return Ue.fromJSON(t);case te.MessageHeader.DictionaryBatch:return He.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${te.MessageHeader[e]}, type: ${e} }`)})}function $v(t,e){return(()=>{switch(e){case te.MessageHeader.Schema:return he.Schema.decode(t.header(new gt));case te.MessageHeader.RecordBatch:return Ue.decode(t.header(new Nt),t.version());case te.MessageHeader.DictionaryBatch:return He.decode(t.header(new Yr),t.version())}throw new Error(`Unrecognized Message type: { name: ${te.MessageHeader[e]}, type: ${e} }`)})}he.Field.encode=tw;he.Field.decode=Xv;he.Field.fromJSON=Qs.fieldFromJSON;he.Schema.encode=ew;he.Schema.decode=Wv;he.Schema.fromJSON=Qs.schemaFromJSON;Ue.encode=rw;Ue.decode=Yv;Ue.fromJSON=Qs.recordBatchFromJSON;He.encode=iw;He.decode=Hv;He.fromJSON=Qs.dictionaryBatchFromJSON;qt.encode=nw;qt.decode=Gv;Rt.encode=sw;Rt.decode=Jv;function Wv(t,e=new Map){let r=Qv(t,e);return new he.Schema(r,Ks(t),e)}function Yv(t,e=te.MetadataVersion.V4){return new Ue(t.length(),Kv(t),Zv(t,e))}function Hv(t,e=te.MetadataVersion.V4){return new He(Ue.decode(t.data(),e),t.id(),t.isDelta())}function Jv(t){return new Rt(t.offset(),t.length())}function Gv(t){return new qt(t.length(),t.nullCount())}function Kv(t){let e=[];for(let r,i=-1,n=-1,a=t.nodesLength();++i<a;)(r=t.nodes(i))&&(e[++n]=qt.decode(r));return e}function Zv(t,e){let r=[];for(let i,n=-1,a=-1,o=t.buffersLength();++n<o;)(i=t.buffers(n))&&(e<te.MetadataVersion.V4&&(i.bb_pos+=8*(n+1)),r[++a]=Rt.decode(i));return r}function Qv(t,e){let r=[];for(let i,n=-1,a=-1,o=t.fieldsLength();++n<o;)(i=t.fields(n))&&(r[++a]=he.Field.decode(i,e));return r}function Dp(t,e){let r=[];for(let i,n=-1,a=-1,o=t.childrenLength();++n<o;)(i=t.children(n))&&(r[++a]=he.Field.decode(i,e));return r}function Xv(t,e){let r,i,n,a,o,c;return!e||!(c=t.dictionary())?(n=Op(t,Dp(t,e)),i=new he.Field(t.name(),n,t.nullable(),Ks(t))):e.has(r=c.id().low)?(a=(a=c.indexType())?Fp(a):new K.Int32,o=new K.Dictionary(e.get(r),a,r,c.isOrdered()),i=new he.Field(t.name(),o,t.nullable(),Ks(t))):(a=(a=c.indexType())?Fp(a):new K.Int32,e.set(r,n=Op(t,Dp(t,e))),o=new K.Dictionary(n,a,r,c.isOrdered()),i=new he.Field(t.name(),o,t.nullable(),Ks(t))),i||null}function Ks(t){let e=new Map;if(t)for(let r,i,n=-1,a=t.customMetadataLength()|0;++n<a;)(r=t.customMetadata(n))&&(i=r.key())!=null&&e.set(i,r.value());return e}function Fp(t){return new K.Int(t.isSigned(),t.bitWidth())}function Op(t,e){let r=t.typeType();switch(r){case ce.NONE:return new K.Null;case ce.Null:return new K.Null;case ce.Binary:return new K.Binary;case ce.Utf8:return new K.Utf8;case ce.Bool:return new K.Bool;case ce.List:return new K.List((e||[])[0]);case ce.Struct_:return new K.Struct(e||[])}switch(r){case ce.Int:{let i=t.type(new be.org.apache.arrow.flatbuf.Int);return new K.Int(i.isSigned(),i.bitWidth())}case ce.FloatingPoint:{let i=t.type(new be.org.apache.arrow.flatbuf.FloatingPoint);return new K.Float(i.precision())}case ce.Decimal:{let i=t.type(new be.org.apache.arrow.flatbuf.Decimal);return new K.Decimal(i.scale(),i.precision())}case ce.Date:{let i=t.type(new be.org.apache.arrow.flatbuf.Date);return new K.Date_(i.unit())}case ce.Time:{let i=t.type(new be.org.apache.arrow.flatbuf.Time);return new K.Time(i.unit(),i.bitWidth())}case ce.Timestamp:{let i=t.type(new be.org.apache.arrow.flatbuf.Timestamp);return new K.Timestamp(i.unit(),i.timezone())}case ce.Interval:{let i=t.type(new be.org.apache.arrow.flatbuf.Interval);return new K.Interval(i.unit())}case ce.Union:{let i=t.type(new be.org.apache.arrow.flatbuf.Union);return new K.Union(i.mode(),i.typeIdsArray()||[],e||[])}case ce.FixedSizeBinary:{let i=t.type(new be.org.apache.arrow.flatbuf.FixedSizeBinary);return new K.FixedSizeBinary(i.byteWidth())}case ce.FixedSizeList:{let i=t.type(new be.org.apache.arrow.flatbuf.FixedSizeList);return new K.FixedSizeList(i.listSize(),(e||[])[0])}case ce.Map:{let i=t.type(new be.org.apache.arrow.flatbuf.Map);return new K.Map_((e||[])[0],i.keysSorted())}}throw new Error(`Unrecognized type: "${ce[r]}" (${r})`)}function ew(t,e){let r=e.fields.map(a=>he.Field.encode(t,a));gt.startFieldsVector(t,r.length);let i=gt.createFieldsVector(t,r),n=e.metadata&&e.metadata.size>0?gt.createCustomMetadataVector(t,[...e.metadata].map(([a,o])=>{let c=t.createString(`${a}`),l=t.createString(`${o}`);return Et.startKeyValue(t),Et.addKey(t,c),Et.addValue(t,l),Et.endKeyValue(t)})):-1;return gt.startSchema(t),gt.addFields(t,i),gt.addEndianness(t,aw?Ap.Little:Ap.Big),n!==-1&&gt.addCustomMetadata(t,n),gt.endSchema(t)}function tw(t,e){let r=-1,i=-1,n=-1,a=e.type,o=e.typeId;K.DataType.isDictionary(a)?(o=a.dictionary.typeId,n=sl.instance.visit(a,t),i=sl.instance.visit(a.dictionary,t)):i=sl.instance.visit(a,t);let c=(a.children||[]).map(u=>he.Field.encode(t,u)),l=Ye.createChildrenVector(t,c),s=e.metadata&&e.metadata.size>0?Ye.createCustomMetadataVector(t,[...e.metadata].map(([u,y])=>{let w=t.createString(`${u}`),C=t.createString(`${y}`);return Et.startKeyValue(t),Et.addKey(t,w),Et.addValue(t,C),Et.endKeyValue(t)})):-1;return e.name&&(r=t.createString(e.name)),Ye.startField(t),Ye.addType(t,i),Ye.addTypeType(t,o),Ye.addChildren(t,l),Ye.addNullable(t,!!e.nullable),r!==-1&&Ye.addName(t,r),n!==-1&&Ye.addDictionary(t,n),s!==-1&&Ye.addCustomMetadata(t,s),Ye.endField(t)}function rw(t,e){let r=e.nodes||[],i=e.buffers||[];Nt.startNodesVector(t,r.length),r.slice().reverse().forEach(o=>qt.encode(t,o));let n=t.endVector();Nt.startBuffersVector(t,i.length),i.slice().reverse().forEach(o=>Rt.encode(t,o));let a=t.endVector();return Nt.startRecordBatch(t),Nt.addLength(t,new rr(e.length,0)),Nt.addNodes(t,n),Nt.addBuffers(t,a),Nt.endRecordBatch(t)}function iw(t,e){let r=Ue.encode(t,e.data);return Yr.startDictionaryBatch(t),Yr.addId(t,new rr(e.id,0)),Yr.addIsDelta(t,e.isDelta),Yr.addData(t,r),Yr.endDictionaryBatch(t)}function nw(t,e){return Pv.createFieldNode(t,new rr(e.length,0),new rr(e.nullCount,0))}function sw(t,e){return kv.createBuffer(t,new rr(e.offset,0),new rr(e.length,0))}var aw=(function(){let t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),new Int16Array(t)[0]===256})()});var ta=b(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});var Ct=Y(),ow=Br(),Mp=ow.flatbuffers.ByteBuffer,Qi=tr(),cw=_e(),uw=Ju(),Vp=se(),Xs=xt(),Je=Ir(),ll=t=>`Expected ${Ct.MessageHeader[t]} Message in stream, but was null or length 0.`,dl=t=>`Header pointer of flatbuffer-encoded ${Ct.MessageHeader[t]} Message is null or length 0.`,Up=(t,e)=>`Expected to read ${t} metadata bytes, but only read ${e}.`,xp=(t,e)=>`Expected to read ${t} bytes for message body, but only read ${e}.`,ea=class{constructor(e){this.source=e instanceof Xs.ByteStream?e:new Xs.ByteStream(e)}[Symbol.iterator](){return this}next(){let e;return(e=this.readMetadataLength()).done||e.value===-1&&(e=this.readMetadataLength()).done||(e=this.readMetadata(e.value)).done?Je.ITERATOR_DONE:e}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}readMessage(e){let r;if((r=this.next()).done)return null;if(e!=null&&r.value.headerType!==e)throw new Error(ll(e));return r.value}readMessageBody(e){if(e<=0)return new Uint8Array(0);let r=Vp.toUint8Array(this.source.read(e));if(r.byteLength<e)throw new Error(xp(e,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()}readSchema(e=!1){let r=Ct.MessageHeader.Schema,i=this.readMessage(r),n=i&&i.header();if(e&&!n)throw new Error(dl(r));return n}readMetadataLength(){let e=this.source.read(J.PADDING),r=e&&new Mp(e),i=r&&r.readInt32(0)||0;return{done:i===0,value:i}}readMetadata(e){let r=this.source.read(e);if(!r)return Je.ITERATOR_DONE;if(r.byteLength<e)throw new Error(Up(e,r.byteLength));return{done:!1,value:Qi.Message.decode(r)}}};J.MessageReader=ea;var cl=class{constructor(e,r){this.source=e instanceof Xs.AsyncByteStream?e:cw.isFileHandle(e)?new uw.AsyncRandomAccessFile(e,r):new Xs.AsyncByteStream(e)}[Symbol.asyncIterator](){return this}async next(){let e;return(e=await this.readMetadataLength()).done||e.value===-1&&(e=await this.readMetadataLength()).done||(e=await this.readMetadata(e.value)).done?Je.ITERATOR_DONE:e}async throw(e){return await this.source.throw(e)}async return(e){return await this.source.return(e)}async readMessage(e){let r;if((r=await this.next()).done)return null;if(e!=null&&r.value.headerType!==e)throw new Error(ll(e));return r.value}async readMessageBody(e){if(e<=0)return new Uint8Array(0);let r=Vp.toUint8Array(await this.source.read(e));if(r.byteLength<e)throw new Error(xp(e,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()}async readSchema(e=!1){let r=Ct.MessageHeader.Schema,i=await this.readMessage(r),n=i&&i.header();if(e&&!n)throw new Error(dl(r));return n}async readMetadataLength(){let e=await this.source.read(J.PADDING),r=e&&new Mp(e),i=r&&r.readInt32(0)||0;return{done:i===0,value:i}}async readMetadata(e){let r=await this.source.read(e);if(!r)return Je.ITERATOR_DONE;if(r.byteLength<e)throw new Error(Up(e,r.byteLength));return{done:!1,value:Qi.Message.decode(r)}}};J.AsyncMessageReader=cl;var ul=class extends ea{constructor(e){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=e instanceof Je.ArrowJSON?e:new Je.ArrowJSON(e)}next(){let{_json:e}=this;if(!this._schema)return this._schema=!0,{done:!1,value:Qi.Message.fromJSON(e.schema,Ct.MessageHeader.Schema)};if(this._dictionaryIndex<e.dictionaries.length){let r=e.dictionaries[this._dictionaryIndex++];return this._body=r.data.columns,{done:!1,value:Qi.Message.fromJSON(r,Ct.MessageHeader.DictionaryBatch)}}if(this._batchIndex<e.batches.length){let r=e.batches[this._batchIndex++];return this._body=r.columns,{done:!1,value:Qi.Message.fromJSON(r,Ct.MessageHeader.RecordBatch)}}return this._body=[],Je.ITERATOR_DONE}readMessageBody(e){return r(this._body);function r(i){return(i||[]).reduce((n,a)=>[...n,...a.VALIDITY&&[a.VALIDITY]||[],...a.TYPE&&[a.TYPE]||[],...a.OFFSET&&[a.OFFSET]||[],...a.DATA&&[a.DATA]||[],...r(a.children)],[])}}readMessage(e){let r;if((r=this.next()).done)return null;if(e!=null&&r.value.headerType!==e)throw new Error(ll(e));return r.value}readSchema(){let e=Ct.MessageHeader.Schema,r=this.readMessage(e),i=r&&r.header();if(!r||!i)throw new Error(dl(e));return i}};J.JSONMessageReader=ul;J.PADDING=4;J.MAGIC_STR="ARROW1";J.MAGIC=new Uint8Array(J.MAGIC_STR.length);for(let t=0;t<J.MAGIC_STR.length;t+=1)J.MAGIC[t]=J.MAGIC_STR.charCodeAt(t);function lw(t,e=0){for(let r=-1,i=J.MAGIC.length;++r<i;)if(J.MAGIC[r]!==t[e+r])return!1;return!0}J.checkForMagicArrowString=lw;J.magicLength=J.MAGIC.length;J.magicAndPadding=J.magicLength+J.PADDING;J.magicX2AndPadding=J.magicLength*2+J.PADDING});var qp=b(ml=>{"use strict";Object.defineProperty(ml,"__esModule",{value:!0});var dw=ye(),Lp=Y(),fw=vt(),pl=se(),fl=tt(),hw=Dt(),Ep=tr(),Np=P(),ue=class t extends dw.Visitor{constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...e){let r=new t,i=hw.selectVectorChildrenArgs(fw.RecordBatch,e),[n=r]=r.visitMany(i);return n}visit(e){if(!Np.DataType.isDictionary(e.type)){let{data:r,length:i,nullCount:n}=e;if(i>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");Np.DataType.isNull(e.type)||Ge.call(this,n<=0?new Uint8Array(0):fl.truncateBitmap(r.offset,i,r.nullBitmap)),this.nodes.push(new Ep.FieldNode(i,n))}return super.visit(e)}visitNull(e){return this}visitDictionary(e){return this.visit(e.indices)}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}};ml.VectorAssembler=ue;function Ge(t){let e=t.byteLength+7&-8;return this.buffers.push(t),this.bufferRegions.push(new Ep.BufferRegion(this._byteLength,e)),this._byteLength+=e,this}function pw(t){let{type:e,length:r,typeIds:i,valueOffsets:n}=t;if(Ge.call(this,i),e.mode===Lp.UnionMode.Sparse)return hl.call(this,t);if(e.mode===Lp.UnionMode.Dense){if(t.offset<=0)return Ge.call(this,n),hl.call(this,t);{let a=i.reduce((u,y)=>Math.max(u,y),i[0]),o=new Int32Array(a+1),c=new Int32Array(a+1).fill(-1),l=new Int32Array(r),s=pl.rebaseValueOffsets(-n[0],r,n);for(let u,y,w=-1;++w<r;)(y=c[u=i[w]])===-1&&(y=c[u]=s[u]),l[w]=s[w]-y,++o[u];Ge.call(this,l);for(let u,y=-1,w=e.children.length;++y<w;)if(u=t.getChildAt(y)){let C=e.typeIds[y],Be=Math.min(r,o[C]);this.visit(u.slice(c[C],Be))}}}return this}function yw(t){let e;return t.nullCount>=t.length?Ge.call(this,new Uint8Array(0)):(e=t.values)instanceof Uint8Array?Ge.call(this,fl.truncateBitmap(t.offset,t.length,e)):Ge.call(this,fl.packBools(t))}function jt(t){return Ge.call(this,t.values.subarray(0,t.length*t.stride))}function Rp(t){let{length:e,values:r,valueOffsets:i}=t,n=i[0],a=i[e],o=Math.min(a-n,r.byteLength-n);return Ge.call(this,pl.rebaseValueOffsets(-i[0],e,i)),Ge.call(this,r.subarray(n,n+o)),this}function yl(t){let{length:e,valueOffsets:r}=t;return r&&Ge.call(this,pl.rebaseValueOffsets(r[0],e,r)),this.visit(t.getChildAt(0))}function hl(t){return this.visitMany(t.type.children.map((e,r)=>t.getChildAt(r)).filter(Boolean))[0]}ue.prototype.visitBool=yw;ue.prototype.visitInt=jt;ue.prototype.visitFloat=jt;ue.prototype.visitUtf8=Rp;ue.prototype.visitBinary=Rp;ue.prototype.visitFixedSizeBinary=jt;ue.prototype.visitDate=jt;ue.prototype.visitTimestamp=jt;ue.prototype.visitTime=jt;ue.prototype.visitDecimal=jt;ue.prototype.visitList=yl;ue.prototype.visitStruct=hl;ue.prototype.visitUnion=pw;ue.prototype.visitInterval=jt;ue.prototype.visitFixedSizeList=yl;ue.prototype.visitMap=yl});var Cp=b(_l=>{"use strict";Object.defineProperty(_l,"__esModule",{value:!0});var mw=ye(),X=Y(),bl=class extends mw.Visitor{visit(e){return e==null?void 0:super.visit(e)}visitNull({typeId:e}){return{name:X.ArrowType[e].toLowerCase()}}visitInt({typeId:e,bitWidth:r,isSigned:i}){return{name:X.ArrowType[e].toLowerCase(),bitWidth:r,isSigned:i}}visitFloat({typeId:e,precision:r}){return{name:X.ArrowType[e].toLowerCase(),precision:X.Precision[r]}}visitBinary({typeId:e}){return{name:X.ArrowType[e].toLowerCase()}}visitBool({typeId:e}){return{name:X.ArrowType[e].toLowerCase()}}visitUtf8({typeId:e}){return{name:X.ArrowType[e].toLowerCase()}}visitDecimal({typeId:e,scale:r,precision:i}){return{name:X.ArrowType[e].toLowerCase(),scale:r,precision:i}}visitDate({typeId:e,unit:r}){return{name:X.ArrowType[e].toLowerCase(),unit:X.DateUnit[r]}}visitTime({typeId:e,unit:r,bitWidth:i}){return{name:X.ArrowType[e].toLowerCase(),unit:X.TimeUnit[r],bitWidth:i}}visitTimestamp({typeId:e,timezone:r,unit:i}){return{name:X.ArrowType[e].toLowerCase(),unit:X.TimeUnit[i],timezone:r}}visitInterval({typeId:e,unit:r}){return{name:X.ArrowType[e].toLowerCase(),unit:X.IntervalUnit[r]}}visitList({typeId:e}){return{name:X.ArrowType[e].toLowerCase()}}visitStruct({typeId:e}){return{name:X.ArrowType[e].toLowerCase()}}visitUnion({typeId:e,mode:r,typeIds:i}){return{name:X.ArrowType[e].toLowerCase(),mode:X.UnionMode[r],typeIds:[...i]}}visitDictionary(e){return this.visit(e.dictionary)}visitFixedSizeBinary({typeId:e,byteWidth:r}){return{name:X.ArrowType[e].toLowerCase(),byteWidth:r}}visitFixedSizeList({typeId:e,listSize:r}){return{name:X.ArrowType[e].toLowerCase(),listSize:r}}visitMap({typeId:e,keysSorted:r}){return{name:X.ArrowType[e].toLowerCase(),keysSorted:r}}};_l.JSONTypeAssembler=bl});var Pp=b(wl=>{"use strict";Object.defineProperty(wl,"__esModule",{value:!0});var bw=xi(),Xi=Nr(),_w=ie(),gw=ye(),vw=Y(),ww=vt(),gl=Y(),ra=tt(),Bw=Dt(),jp=P(),vl=class t extends gw.Visitor{static assemble(...e){return new t().visitMany(Bw.selectColumnChildrenArgs(ww.RecordBatch,e))}visit(e){let{data:r,name:i,length:n}=e,{offset:a,nullCount:o,nullBitmap:c}=r,l=jp.DataType.isDictionary(e.type)?e.type.indices:e.type,s=Object.assign([],r.buffers,{[vw.BufferType.VALIDITY]:void 0});return{name:i,count:n,VALIDITY:jp.DataType.isNull(l)?void 0:o<=0?Array.from({length:n},()=>1):[...ra.iterateBits(c,a,n,null,ra.getBit)],...super.visit(_w.Vector.new(r.clone(l,a,n,0,s)))}}visitNull(){return{}}visitBool({values:e,offset:r,length:i}){return{DATA:[...ra.iterateBits(e,r,i,null,ra.getBool)]}}visitInt(e){return{DATA:e.type.bitWidth<64?[...e.values]:[...en(e.values,2)]}}visitFloat(e){return{DATA:[...e.values]}}visitUtf8(e){return{DATA:[...e],OFFSET:[...e.valueOffsets]}}visitBinary(e){return{DATA:[...kp(e)],OFFSET:[...e.valueOffsets]}}visitFixedSizeBinary(e){return{DATA:[...kp(e)]}}visitDate(e){return{DATA:e.type.unit===gl.DateUnit.DAY?[...e.values]:[...en(e.values,2)]}}visitTimestamp(e){return{DATA:[...en(e.values,2)]}}visitTime(e){return{DATA:e.type.unit<gl.TimeUnit.MICROSECOND?[...e.values]:[...en(e.values,2)]}}visitDecimal(e){return{DATA:[...en(e.values,4)]}}visitList(e){return{OFFSET:[...e.valueOffsets],children:e.type.children.map((r,i)=>this.visit(new Xi.Column(r,[e.getChildAt(i)])))}}visitStruct(e){return{children:e.type.children.map((r,i)=>this.visit(new Xi.Column(r,[e.getChildAt(i)])))}}visitUnion(e){return{TYPE:[...e.typeIds],OFFSET:e.type.mode===gl.UnionMode.Dense?[...e.valueOffsets]:void 0,children:e.type.children.map((r,i)=>this.visit(new Xi.Column(r,[e.getChildAt(i)])))}}visitInterval(e){return{DATA:[...e.values]}}visitFixedSizeList(e){return{children:e.type.children.map((r,i)=>this.visit(new Xi.Column(r,[e.getChildAt(i)])))}}visitMap(e){return{OFFSET:[...e.valueOffsets],children:e.type.children.map((r,i)=>this.visit(new Xi.Column(r,[e.getChildAt(i)])))}}};wl.JSONVectorAssembler=vl;function*kp(t){for(let e of t)yield e.reduce((r,i)=>`${r}${("0"+(i&255).toString(16)).slice(-2)}`,"").toUpperCase()}function*en(t,e){for(let r=-1,i=t.length/e;++r<i;)yield`${bw.BN.new(t.subarray((r+0)*e,(r+1)*e),!1)}`}});var na=b(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});var Sl=tn(),Tw=ta(),Iw=Nr(),Sw=P(),Aw=de(),ia=tr(),Bl=tr(),Hr=ku(),Al=Y(),Tl=xt(),zp=qp(),Dw=Cp(),$p=Pp(),Fw=se(),Il=vt(),Ow=Ir(),st=_e(),Jr=class extends Ow.ReadableInterop{constructor(e){super(),this._position=0,this._started=!1,this._sink=new Tl.AsyncByteQueue,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,st.isObject(e)||(e={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof e.autoDestroy=="boolean"?e.autoDestroy:!0,this._writeLegacyIpcFormat=typeof e.writeLegacyIpcFormat=="boolean"?e.writeLegacyIpcFormat:!1}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,r){throw new Error('"throughDOM" not available in this environment')}toString(e=!1){return this._sink.toString(e)}toUint8Array(e=!1){return this._sink.toUint8Array(e)}writeAll(e){return st.isPromise(e)?e.then(r=>this.writeAll(r)):st.isAsyncIterable(e)?Vl(this,e):Ml(this,e)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(e){return this._sink.toDOMStream(e)}toNodeStream(e){return this._sink.toNodeStream(e)}close(){return this.reset()._sink.close()}abort(e){return this.reset()._sink.abort(e)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(e=this._sink,r=null){return e===this._sink||e instanceof Tl.AsyncByteQueue?this._sink=e:(this._sink=new Tl.AsyncByteQueue,e&&st.isWritableDOMStream(e)?this.toDOMStream({type:"bytes"}).pipeTo(e):e&&st.isWritableNodeStream(e)&&this.toNodeStream({objectMode:!1}).pipe(e)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!r||!r.compareTo(this._schema))&&(r===null?(this._position=0,this._schema=null):(this._started=!0,this._schema=r,this._writeSchema(r))),this}write(e){let r=null;if(this._sink){if(e==null)return this.finish()&&void 0;if(e instanceof Sl.Table&&!(r=e.schema))return this.finish()&&void 0;if(e instanceof Il.RecordBatch&&!(r=e.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(r&&!r.compareTo(this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,r)}e instanceof Il.RecordBatch?e instanceof Il._InternalEmptyPlaceholderRecordBatch||this._writeRecordBatch(e):e instanceof Sl.Table?this.writeAll(e.chunks):st.isIterable(e)&&this.writeAll(e)}_writeMessage(e,r=8){let i=r-1,n=ia.Message.encode(e),a=n.byteLength,o=this._writeLegacyIpcFormat?4:8,c=a+o+i&~i,l=c-a-o;return e.headerType===Al.MessageHeader.RecordBatch?this._recordBatchBlocks.push(new Hr.FileBlock(c,e.bodyLength,this._position)):e.headerType===Al.MessageHeader.DictionaryBatch&&this._dictionaryBlocks.push(new Hr.FileBlock(c,e.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(c-o)),a>0&&this._write(n),this._writePadding(l)}_write(e){if(this._started){let r=Fw.toUint8Array(e);r&&r.byteLength>0&&(this._sink.write(r),this._position+=r.byteLength)}return this}_writeSchema(e){return this._writeMessage(ia.Message.from(e))}_writeFooter(e){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(Tw.MAGIC)}_writePadding(e){return e>0?this._write(new Uint8Array(e)):this}_writeRecordBatch(e){let{byteLength:r,nodes:i,bufferRegions:n,buffers:a}=zp.VectorAssembler.assemble(e),o=new Bl.RecordBatch(e.length,i,n),c=ia.Message.from(o,r);return this._writeDictionaries(e)._writeMessage(c)._writeBodyBuffers(a)}_writeDictionaryBatch(e,r,i=!1){this._dictionaryDeltaOffsets.set(r,e.length+(this._dictionaryDeltaOffsets.get(r)||0));let{byteLength:n,nodes:a,bufferRegions:o,buffers:c}=zp.VectorAssembler.assemble(e),l=new Bl.RecordBatch(e.length,a,o),s=new Bl.DictionaryBatch(l,r,i),u=ia.Message.from(s,n);return this._writeMessage(u)._writeBodyBuffers(c)}_writeBodyBuffers(e){let r,i,n;for(let a=-1,o=e.length;++a<o;)(r=e[a])&&(i=r.byteLength)>0&&(this._write(r),(n=(i+7&-8)-i)>0&&this._writePadding(n));return this}_writeDictionaries(e){for(let[r,i]of e.dictionaries){let n=this._dictionaryDeltaOffsets.get(r)||0;if(n===0||(i=i.slice(n)).length>0){let a="chunks"in i?i.chunks:[i];for(let o of a)this._writeDictionaryBatch(o,r,n>0),n+=o.length}}return this}};Gr.RecordBatchWriter=Jr;var Dl=class t extends Jr{static writeAll(e,r){let i=new t(r);return st.isPromise(e)?e.then(n=>i.writeAll(n)):st.isAsyncIterable(e)?Vl(i,e):Ml(i,e)}};Gr.RecordBatchStreamWriter=Dl;var Fl=class t extends Jr{constructor(){super(),this._autoDestroy=!0}static writeAll(e){let r=new t;return st.isPromise(e)?e.then(i=>r.writeAll(i)):st.isAsyncIterable(e)?Vl(r,e):Ml(r,e)}_writeSchema(e){return this._writeMagic()._writePadding(2)}_writeFooter(e){let r=Hr.Footer.encode(new Hr.Footer(e,Al.MetadataVersion.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(e)._write(r)._write(Int32Array.of(r.byteLength))._writeMagic()}};Gr.RecordBatchFileWriter=Fl;var Ol=class t extends Jr{constructor(){super(),this._autoDestroy=!0,this._recordBatches=[],this._dictionaries=[]}static writeAll(e){return new t().writeAll(e)}_writeMessage(){return this}_writeFooter(e){return this}_writeSchema(e){return this._write(`{
  "schema": ${JSON.stringify({fields:e.fields.map(Wp)},null,2)}`)}_writeDictionaries(e){return e.dictionaries.size>0&&this._dictionaries.push(e),this}_writeDictionaryBatch(e,r,i=!1){return this._dictionaryDeltaOffsets.set(r,e.length+(this._dictionaryDeltaOffsets.get(r)||0)),this._write(this._dictionaryBlocks.length===0?"    ":`,
    `),this._write(`${Mw(e,r,i)}`),this._dictionaryBlocks.push(new Hr.FileBlock(0,0,0)),this}_writeRecordBatch(e){return this._writeDictionaries(e),this._recordBatches.push(e),this}close(){if(this._dictionaries.length>0){this._write(`,
  "dictionaries": [
`);for(let e of this._dictionaries)super._writeDictionaries(e);this._write(`
  ]`)}if(this._recordBatches.length>0){for(let e=-1,r=this._recordBatches.length;++e<r;)this._write(e===0?`,
  "batches": [
    `:`,
    `),this._write(`${Vw(this._recordBatches[e])}`),this._recordBatchBlocks.push(new Hr.FileBlock(0,0,0));this._write(`
  ]`)}return this._schema&&this._write(`
}`),this._dictionaries=[],this._recordBatches=[],super.close()}};Gr.RecordBatchJSONWriter=Ol;function Ml(t,e){let r=e;e instanceof Sl.Table&&(r=e.chunks,t.reset(void 0,e.schema));for(let i of r)t.write(i);return t.finish()}async function Vl(t,e){for await(let r of e)t.write(r);return t.finish()}function Wp({name:t,type:e,nullable:r}){let i=new Dw.JSONTypeAssembler;return{name:t,nullable:r,type:i.visit(e),children:(e.children||[]).map(Wp),dictionary:Sw.DataType.isDictionary(e)?{id:e.id,isOrdered:e.isOrdered,indexType:i.visit(e.indices)}:void 0}}function Mw(t,e,r=!1){let i=new Aw.Field(`${e}`,t.type,t.nullCount>0),n=$p.JSONVectorAssembler.assemble(new Iw.Column(i,[t]));return JSON.stringify({id:e,isDelta:r,data:{count:t.length,columns:n}},null,2)}function Vw(t){return JSON.stringify({count:t.length,columns:$p.JSONVectorAssembler.assemble(t)},null,2)}});var Ll=b(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});var Yp=ke(),xl=de(),Uw=At(),xw=vt(),Ul=new Uint8Array(0),Hp=t=>[Ul,Ul,new Uint8Array(t),Ul];function Lw(t,e,r=e.reduce((i,n)=>Math.max(i,n.length),0)){let i,n,a=-1,o=e.length,c=[...t.fields],l=[],s=(r+63&-64)>>3;for(;++a<o;)(i=e[a])&&i.length===r?l[a]=i:((n=c[a]).nullable||(c[a]=c[a].clone({nullable:!0})),l[a]=i?i._changeLengthAndBackfillNullBitmap(r):Yp.Data.new(n.type,0,r,r,Hp(s)));return[new xl.Schema(c),r,l]}rn.ensureSameLengthData=Lw;function Nw(t){return Jp(new xl.Schema(t.map(({field:e})=>e)),t)}rn.distributeColumnsIntoRecordBatches=Nw;function Jp(t,e){return Ew(t,e.map(r=>r instanceof Uw.Chunked?r.chunks.map(i=>i.data):[r.data]))}rn.distributeVectorsIntoRecordBatches=Jp;function Ew(t,e){let r=[...t.fields],i=[],n={numBatches:e.reduce((y,w)=>Math.max(y,w.length),0)},a=0,o=0,c=-1,l=e.length,s,u=[];for(;n.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,c=-1;++c<l;)u[c]=s=e[c].shift(),o=Math.min(o,s?s.length:o);isFinite(o)&&(u=Rw(r,o,u,e,n),o>0&&(i[a++]=[o,u.slice()]))}return[t=new xl.Schema(r,t.metadata),i.map(y=>new xw.RecordBatch(t,...y))]}function Rw(t,e,r,i,n){let a,o,c=0,l=-1,s=i.length,u=(e+63&-64)>>3;for(;++l<s;)(a=r[l])&&(c=a.length)>=e?c===e?r[l]=a:(r[l]=a.slice(0,e),a=a.slice(e,c-e),n.numBatches=Math.max(n.numBatches,i[l].unshift(a))):((o=t[l]).nullable||(t[l]=o.clone({nullable:!0})),r[l]=a?a._changeLengthAndBackfillNullBitmap(e):Yp.Data.new(o.type,0,e,e,Hp(u)));return r}});var ne=b(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});var qw=Y(),Cw=At(),jw=Ci(),Nl=ie(),sa=class extends Nl.AbstractVector{constructor(e,r){super(),this._children=r,this.numChildren=e.childData.length,this._bindDataAccessors(this.data=e)}get type(){return this.data.type}get typeId(){return this.data.typeId}get length(){return this.data.length}get offset(){return this.data.offset}get stride(){return this.data.stride}get nullCount(){return this.data.nullCount}get byteLength(){return this.data.byteLength}get VectorName(){return`${qw.Type[this.typeId]}Vector`}get ArrayType(){return this.type.ArrayType}get values(){return this.data.values}get typeIds(){return this.data.typeIds}get nullBitmap(){return this.data.nullBitmap}get valueOffsets(){return this.data.valueOffsets}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}clone(e,r=this._children){return Nl.Vector.new(e,r)}concat(...e){return Cw.Chunked.concat(this,...e)}slice(e,r){return jw.clampRange(this,e,r,this._sliceInternal)}isValid(e){if(this.nullCount>0){let r=this.offset+e;return(this.nullBitmap[r>>3]&1<<r%8)!==0}return!0}getChildAt(e){return e<0||e>=this.numChildren?null:(this._children||(this._children=[]))[e]||(this._children[e]=Nl.Vector.new(this.data.childData[e]))}toJSON(){return[...this]}_sliceInternal(e,r,i){return e.clone(e.data.slice(r,i-r),null)}_bindDataAccessors(e){}};El.BaseVector=sa;sa.prototype[Symbol.isConcatSpreadable]=!0});var Cl=b(ql=>{"use strict";Object.defineProperty(ql,"__esModule",{value:!0});var kw=ie(),Pw=ne(),zw=P(),Rl=class extends Pw.BaseVector{asUtf8(){return kw.Vector.new(this.data.clone(new zw.Utf8))}};ql.BinaryVector=Rl});var Pl=b(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});var $w=P(),Ww=ne(),Yw=at(),jl=class extends Ww.BaseVector{static from(e){return Yw.vectorFromValuesWithType(()=>new $w.Bool,e)}};kl.BoolVector=jl});var Yl=b(sn=>{"use strict";Object.defineProperty(sn,"__esModule",{value:!0});var Hw=Y(),Jw=ne(),Gp=at(),zl=P(),nn=class extends Jw.BaseVector{static from(...e){return e.length===2?Gp.vectorFromValuesWithType(()=>e[1]===Hw.DateUnit.DAY?new zl.DateDay:new zl.DateMillisecond,e[0]):Gp.vectorFromValuesWithType(()=>new zl.DateMillisecond,e[0])}};sn.DateVector=nn;var $l=class extends nn{};sn.DateDayVector=$l;var Wl=class extends nn{};sn.DateMillisecondVector=Wl});var Gl=b(Jl=>{"use strict";Object.defineProperty(Jl,"__esModule",{value:!0});var Gw=ne(),Hl=class extends Gw.BaseVector{};Jl.DecimalVector=Hl});var oa=b(Kl=>{"use strict";Object.defineProperty(Kl,"__esModule",{value:!0});var Kw=ke(),Kp=ie(),Zw=ne(),Qw=at(),Xw=P(),aa=class extends Zw.BaseVector{constructor(e){super(e),this.indices=Kp.Vector.new(e.clone(this.type.indices))}static from(...e){if(e.length===3){let[r,i,n]=e,a=new Xw.Dictionary(r.type,i,null,null);return Kp.Vector.new(Kw.Data.Dictionary(a,0,n.length,0,null,n,r))}return Qw.vectorFromValuesWithType(()=>e[0].type,e[0])}get dictionary(){return this.data.dictionary}reverseLookup(e){return this.dictionary.indexOf(e)}getKey(e){return this.indices.get(e)}getValue(e){return this.dictionary.get(e)}setKey(e,r){return this.indices.set(e,r)}setValue(e,r){return this.dictionary.set(e,r)}};Kl.DictionaryVector=aa;aa.prototype.indices=null});var Xl=b(Ql=>{"use strict";Object.defineProperty(Ql,"__esModule",{value:!0});var eB=ne(),Zl=class extends eB.BaseVector{};Ql.FixedSizeBinaryVector=Zl});var rd=b(td=>{"use strict";Object.defineProperty(td,"__esModule",{value:!0});var tB=ne(),ed=class extends tB.BaseVector{};td.FixedSizeListVector=ed});var id=b(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});var rB=ke(),iB=ie(),nB=ne(),sB=at(),nr=P(),Kr=class extends nB.BaseVector{static from(e){let r=cB(this);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)){let i=oB(e.constructor)||r;if(r===null&&(r=i),r&&r===i){let n=new r,a=e.byteLength/n.ArrayType.BYTES_PER_ELEMENT;if(!aB(r,e.constructor))return iB.Vector.new(rB.Data.Float(n,0,a,0,null,e))}}if(r)return sB.vectorFromValuesWithType(()=>new r,e);throw e instanceof DataView||e instanceof ArrayBuffer?new TypeError(`Cannot infer float type from instance of ${e.constructor.name}`):new TypeError("Unrecognized FloatVector input")}};Zr.FloatVector=Kr;var ca=class extends Kr{toFloat32Array(){return new Float32Array(this)}toFloat64Array(){return new Float64Array(this)}};Zr.Float16Vector=ca;var ua=class extends Kr{};Zr.Float32Vector=ua;var la=class extends Kr{};Zr.Float64Vector=la;var aB=(t,e)=>t===nr.Float16&&e!==Uint16Array,oB=t=>{switch(t){case Uint16Array:return nr.Float16;case Float32Array:return nr.Float32;case Float64Array:return nr.Float64;default:return null}},cB=t=>{switch(t){case ca:return nr.Float16;case ua:return nr.Float32;case la:return nr.Float64;default:return null}}});var ad=b(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});var uB=ne(),an=class extends uB.BaseVector{};on.IntervalVector=an;var nd=class extends an{};on.IntervalDayTimeVector=nd;var sd=class extends an{};on.IntervalYearMonthVector=sd});var ga=b(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});var lB=ke(),dB=ie(),fB=ne(),hB=at(),Zp=_e(),Qp=se(),re=P(),Ke=class extends fB.BaseVector{static from(...e){let[r,i=!1]=e,n=mB(this,i);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)){let a=yB(r.constructor,i)||n;if(n===null&&(n=a),n&&n===a){let o=new n,c=r.byteLength/o.ArrayType.BYTES_PER_ELEMENT;return pB(n,r.constructor)&&(c*=.5),dB.Vector.new(lB.Data.Int(o,0,c,0,null,r))}}if(n)return hB.vectorFromValuesWithType(()=>new n,r);throw r instanceof DataView||r instanceof ArrayBuffer?new TypeError(`Cannot infer integer type from instance of ${r.constructor.name}`):new TypeError("Unrecognized IntVector input")}};Ze.IntVector=Ke;var da=class extends Ke{};Ze.Int8Vector=da;var fa=class extends Ke{};Ze.Int16Vector=fa;var ha=class extends Ke{};Ze.Int32Vector=ha;var pa=class extends Ke{toBigInt64Array(){return Qp.toBigInt64Array(this.values)}get values64(){return this._values64||(this._values64=this.toBigInt64Array())}};Ze.Int64Vector=pa;var ya=class extends Ke{};Ze.Uint8Vector=ya;var ma=class extends Ke{};Ze.Uint16Vector=ma;var ba=class extends Ke{};Ze.Uint32Vector=ba;var _a=class extends Ke{toBigUint64Array(){return Qp.toBigUint64Array(this.values)}get values64(){return this._values64||(this._values64=this.toBigUint64Array())}};Ze.Uint64Vector=_a;var pB=(t,e)=>(t===re.Int64||t===re.Uint64)&&(e===Int32Array||e===Uint32Array),yB=(t,e)=>{switch(t){case Int8Array:return re.Int8;case Int16Array:return re.Int16;case Int32Array:return e?re.Int64:re.Int32;case Zp.BigInt64Array:return re.Int64;case Uint8Array:return re.Uint8;case Uint16Array:return re.Uint16;case Uint32Array:return e?re.Uint64:re.Uint32;case Zp.BigUint64Array:return re.Uint64;default:return null}},mB=(t,e)=>{switch(t){case da:return re.Int8;case fa:return re.Int16;case ha:return e?re.Int64:re.Int32;case pa:return re.Int64;case ya:return re.Uint8;case ma:return re.Uint16;case ba:return e?re.Uint64:re.Uint32;case _a:return re.Uint64;default:return null}}});var ud=b(cd=>{"use strict";Object.defineProperty(cd,"__esModule",{value:!0});var bB=ne(),od=class extends bB.BaseVector{};cd.ListVector=od});var fd=b(dd=>{"use strict";Object.defineProperty(dd,"__esModule",{value:!0});var _B=Ei(),gB=ie(),vB=ne(),wB=P(),ld=class extends vB.BaseVector{asList(){let e=this.type.children[0];return gB.Vector.new(this.data.clone(new wB.List(e)))}bind(e){let r=this.getChildAt(0),{[e]:i,[e+1]:n}=this.valueOffsets;return new _B.MapRow(r.slice(i,n))}};dd.MapVector=ld});var yd=b(pd=>{"use strict";Object.defineProperty(pd,"__esModule",{value:!0});var BB=ne(),hd=class extends BB.BaseVector{};pd.NullVector=hd});var _d=b(bd=>{"use strict";Object.defineProperty(bd,"__esModule",{value:!0});var TB=Ei(),IB=ne(),SB=Symbol.for("rowIndex"),md=class extends IB.BaseVector{bind(e){let r=this._row||(this._row=new TB.StructRow(this)),i=Object.create(r);return i[SB]=e,i}};bd.StructVector=md});var Td=b(ar=>{"use strict";Object.defineProperty(ar,"__esModule",{value:!0});var AB=ne(),sr=class extends AB.BaseVector{};ar.TimestampVector=sr;var gd=class extends sr{};ar.TimestampSecondVector=gd;var vd=class extends sr{};ar.TimestampMillisecondVector=vd;var wd=class extends sr{};ar.TimestampMicrosecondVector=wd;var Bd=class extends sr{};ar.TimestampNanosecondVector=Bd});var Fd=b(cr=>{"use strict";Object.defineProperty(cr,"__esModule",{value:!0});var DB=ne(),or=class extends DB.BaseVector{};cr.TimeVector=or;var Id=class extends or{};cr.TimeSecondVector=Id;var Sd=class extends or{};cr.TimeMillisecondVector=Sd;var Ad=class extends or{};cr.TimeMicrosecondVector=Ad;var Dd=class extends or{};cr.TimeNanosecondVector=Dd});var Vd=b(un=>{"use strict";Object.defineProperty(un,"__esModule",{value:!0});var FB=ne(),cn=class extends FB.BaseVector{get typeIdToChildIndex(){return this.data.type.typeIdToChildIndex}};un.UnionVector=cn;var Od=class extends cn{get valueOffsets(){return this.data.valueOffsets}};un.DenseUnionVector=Od;var Md=class extends cn{};un.SparseUnionVector=Md});var Ld=b(xd=>{"use strict";Object.defineProperty(xd,"__esModule",{value:!0});var OB=ie(),MB=ne(),Xp=P(),VB=at(),Ud=class extends MB.BaseVector{static from(e){return VB.vectorFromValuesWithType(()=>new Xp.Utf8,e)}asBinary(){return OB.Vector.new(this.data.clone(new Xp.Binary))}};xd.Utf8Vector=Ud});var ey=b(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});function UB(t){return function(){return t(this)}}ln.partial0=UB;function xB(t){return function(e){return t(this,e)}}ln.partial1=xB;function LB(t){return function(e,r){return t(this,e,r)}}ln.partial2=LB});var Rd=b(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});var va=xi(),NB=ye(),EB=Pt(),RB=Mi(),Le=Y(),S=class extends NB.Visitor{};wa.GetVisitor=S;var qB=(t,e)=>864e5*t[e],Nd=(t,e)=>4294967296*t[e+1]+(t[e]>>>0),CB=(t,e)=>4294967296*(t[e+1]/1e3)+(t[e]>>>0)/1e3,jB=(t,e)=>4294967296*(t[e+1]/1e6)+(t[e]>>>0)/1e6,ty=t=>new Date(t),kB=(t,e)=>ty(qB(t,e)),PB=(t,e)=>ty(Nd(t,e)),zB=(t,e)=>null,ry=(t,e,r)=>{let{[r]:i,[r+1]:n}=e;return i!=null&&n!=null?t.subarray(i,n):null},$B=({offset:t,values:e},r)=>{let i=t+r;return(e[i>>3]&1<<i%8)!==0},iy=({values:t},e)=>kB(t,e),ny=({values:t},e)=>PB(t,e*2),ot=({stride:t,values:e},r)=>e[t*r],sy=({stride:t,values:e},r)=>RB.uint16ToFloat64(e[t*r]),Ed=({stride:t,values:e,type:r},i)=>va.BN.new(e.subarray(t*i,t*(i+1)),r.isSigned),WB=({stride:t,values:e},r)=>e.subarray(t*r,t*(r+1)),YB=({values:t,valueOffsets:e},r)=>ry(t,e,r),HB=({values:t,valueOffsets:e},r)=>{let i=ry(t,e,r);return i!==null?EB.decodeUtf8(i):null},JB=(t,e)=>t.type.bitWidth<64?ot(t,e):Ed(t,e),GB=(t,e)=>t.type.precision!==Le.Precision.HALF?ot(t,e):sy(t,e),KB=(t,e)=>t.type.unit===Le.DateUnit.DAY?iy(t,e):ny(t,e),ay=({values:t},e)=>1e3*Nd(t,e*2),oy=({values:t},e)=>Nd(t,e*2),cy=({values:t},e)=>CB(t,e*2),uy=({values:t},e)=>jB(t,e*2),ZB=(t,e)=>{switch(t.type.unit){case Le.TimeUnit.SECOND:return ay(t,e);case Le.TimeUnit.MILLISECOND:return oy(t,e);case Le.TimeUnit.MICROSECOND:return cy(t,e);case Le.TimeUnit.NANOSECOND:return uy(t,e)}},ly=({values:t,stride:e},r)=>t[e*r],dy=({values:t,stride:e},r)=>t[e*r],fy=({values:t},e)=>va.BN.signed(t.subarray(2*e,2*(e+1))),hy=({values:t},e)=>va.BN.signed(t.subarray(2*e,2*(e+1))),QB=(t,e)=>{switch(t.type.unit){case Le.TimeUnit.SECOND:return ly(t,e);case Le.TimeUnit.MILLISECOND:return dy(t,e);case Le.TimeUnit.MICROSECOND:return fy(t,e);case Le.TimeUnit.NANOSECOND:return hy(t,e)}},XB=({values:t},e)=>va.BN.decimal(t.subarray(4*e,4*(e+1))),eT=(t,e)=>{let r=t.getChildAt(0),{valueOffsets:i,stride:n}=t;return r.slice(i[e*n],i[e*n+1])},tT=(t,e)=>t.bind(e),rT=(t,e)=>t.bind(e),iT=(t,e)=>t.type.mode===Le.UnionMode.Dense?py(t,e):yy(t,e),py=(t,e)=>{let r=t.typeIdToChildIndex[t.typeIds[e]],i=t.getChildAt(r);return i?i.get(t.valueOffsets[e]):null},yy=(t,e)=>{let r=t.typeIdToChildIndex[t.typeIds[e]],i=t.getChildAt(r);return i?i.get(e):null},nT=(t,e)=>t.getValue(t.getKey(e)),sT=(t,e)=>t.type.unit===Le.IntervalUnit.DAY_TIME?my(t,e):by(t,e),my=({values:t},e)=>t.subarray(2*e,2*(e+1)),by=({values:t},e)=>{let r=t[e],i=new Int32Array(2);return i[0]=r/12|0,i[1]=r%12|0,i},aT=(t,e)=>{let r=t.getChildAt(0),{stride:i}=t;return r.slice(e*i,(e+1)*i)};S.prototype.visitNull=zB;S.prototype.visitBool=$B;S.prototype.visitInt=JB;S.prototype.visitInt8=ot;S.prototype.visitInt16=ot;S.prototype.visitInt32=ot;S.prototype.visitInt64=Ed;S.prototype.visitUint8=ot;S.prototype.visitUint16=ot;S.prototype.visitUint32=ot;S.prototype.visitUint64=Ed;S.prototype.visitFloat=GB;S.prototype.visitFloat16=sy;S.prototype.visitFloat32=ot;S.prototype.visitFloat64=ot;S.prototype.visitUtf8=HB;S.prototype.visitBinary=YB;S.prototype.visitFixedSizeBinary=WB;S.prototype.visitDate=KB;S.prototype.visitDateDay=iy;S.prototype.visitDateMillisecond=ny;S.prototype.visitTimestamp=ZB;S.prototype.visitTimestampSecond=ay;S.prototype.visitTimestampMillisecond=oy;S.prototype.visitTimestampMicrosecond=cy;S.prototype.visitTimestampNanosecond=uy;S.prototype.visitTime=QB;S.prototype.visitTimeSecond=ly;S.prototype.visitTimeMillisecond=dy;S.prototype.visitTimeMicrosecond=fy;S.prototype.visitTimeNanosecond=hy;S.prototype.visitDecimal=XB;S.prototype.visitList=eT;S.prototype.visitStruct=rT;S.prototype.visitUnion=iT;S.prototype.visitDenseUnion=py;S.prototype.visitSparseUnion=yy;S.prototype.visitDictionary=nT;S.prototype.visitInterval=sT;S.prototype.visitIntervalDayTime=my;S.prototype.visitIntervalYearMonth=by;S.prototype.visitFixedSizeList=aT;S.prototype.visitMap=tT;wa.instance=new S});var wy=b(Ba=>{"use strict";Object.defineProperty(Ba,"__esModule",{value:!0});var oT=ye(),_y=tt(),gy=Ci(),A=class extends oT.Visitor{};Ba.IndexOfVisitor=A;function cT(t,e){return e===null&&t.length>0?0:-1}function uT(t,e){let{nullBitmap:r}=t;if(!r||t.nullCount<=0)return-1;let i=0;for(let n of _y.iterateBits(r,t.data.offset+(e||0),t.length,r,_y.getBool)){if(!n)return i;++i}return-1}function R(t,e,r){if(e===void 0)return-1;if(e===null)return uT(t,r);let i=gy.createElementComparator(e);for(let n=(r||0)-1,a=t.length;++n<a;)if(i(t.get(n)))return n;return-1}function vy(t,e,r){let i=gy.createElementComparator(e);for(let n=(r||0)-1,a=t.length;++n<a;)if(i(t.get(n)))return n;return-1}A.prototype.visitNull=cT;A.prototype.visitBool=R;A.prototype.visitInt=R;A.prototype.visitInt8=R;A.prototype.visitInt16=R;A.prototype.visitInt32=R;A.prototype.visitInt64=R;A.prototype.visitUint8=R;A.prototype.visitUint16=R;A.prototype.visitUint32=R;A.prototype.visitUint64=R;A.prototype.visitFloat=R;A.prototype.visitFloat16=R;A.prototype.visitFloat32=R;A.prototype.visitFloat64=R;A.prototype.visitUtf8=R;A.prototype.visitBinary=R;A.prototype.visitFixedSizeBinary=R;A.prototype.visitDate=R;A.prototype.visitDateDay=R;A.prototype.visitDateMillisecond=R;A.prototype.visitTimestamp=R;A.prototype.visitTimestampSecond=R;A.prototype.visitTimestampMillisecond=R;A.prototype.visitTimestampMicrosecond=R;A.prototype.visitTimestampNanosecond=R;A.prototype.visitTime=R;A.prototype.visitTimeSecond=R;A.prototype.visitTimeMillisecond=R;A.prototype.visitTimeMicrosecond=R;A.prototype.visitTimeNanosecond=R;A.prototype.visitDecimal=R;A.prototype.visitList=R;A.prototype.visitStruct=R;A.prototype.visitUnion=R;A.prototype.visitDenseUnion=vy;A.prototype.visitSparseUnion=vy;A.prototype.visitDictionary=R;A.prototype.visitInterval=R;A.prototype.visitIntervalDayTime=R;A.prototype.visitIntervalYearMonth=R;A.prototype.visitFixedSizeList=R;A.prototype.visitMap=R;Ba.instance=new A});var qd=b(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});var Ta=Y(),lT=ye(),dT=tt(),By=Rd(),D=class extends lT.Visitor{};Ia.IteratorVisitor=D;function fT(t){let e=By.instance.getVisitFn(t);return dT.iterateBits(t.nullBitmap,t.offset,t.length,t,(r,i,n,a)=>(n&1<<a)!==0?e(r,i):null)}function L(t){if(t.nullCount>0)return fT(t);let{type:e,typeId:r,length:i}=t;return t.stride===1&&(r===Ta.Type.Timestamp||r===Ta.Type.Int&&e.bitWidth!==64||r===Ta.Type.Time&&e.bitWidth!==64||r===Ta.Type.Float&&e.precision>0)?t.values.subarray(0,i)[Symbol.iterator]():(function*(n){for(let a=-1;++a<i;)yield n(t,a)})(By.instance.getVisitFn(t))}D.prototype.visitNull=L;D.prototype.visitBool=L;D.prototype.visitInt=L;D.prototype.visitInt8=L;D.prototype.visitInt16=L;D.prototype.visitInt32=L;D.prototype.visitInt64=L;D.prototype.visitUint8=L;D.prototype.visitUint16=L;D.prototype.visitUint32=L;D.prototype.visitUint64=L;D.prototype.visitFloat=L;D.prototype.visitFloat16=L;D.prototype.visitFloat32=L;D.prototype.visitFloat64=L;D.prototype.visitUtf8=L;D.prototype.visitBinary=L;D.prototype.visitFixedSizeBinary=L;D.prototype.visitDate=L;D.prototype.visitDateDay=L;D.prototype.visitDateMillisecond=L;D.prototype.visitTimestamp=L;D.prototype.visitTimestampSecond=L;D.prototype.visitTimestampMillisecond=L;D.prototype.visitTimestampMicrosecond=L;D.prototype.visitTimestampNanosecond=L;D.prototype.visitTime=L;D.prototype.visitTimeSecond=L;D.prototype.visitTimeMillisecond=L;D.prototype.visitTimeMicrosecond=L;D.prototype.visitTimeNanosecond=L;D.prototype.visitDecimal=L;D.prototype.visitList=L;D.prototype.visitStruct=L;D.prototype.visitUnion=L;D.prototype.visitDenseUnion=L;D.prototype.visitSparseUnion=L;D.prototype.visitDictionary=L;D.prototype.visitInterval=L;D.prototype.visitIntervalDayTime=L;D.prototype.visitIntervalYearMonth=L;D.prototype.visitFixedSizeList=L;D.prototype.visitMap=L;Ia.instance=new D});var Ty=b(Sa=>{"use strict";Object.defineProperty(Sa,"__esModule",{value:!0});var dn=Y(),hT=ye(),pT=qd(),F=class extends hT.Visitor{};Sa.ToArrayVisitor=F;function N(t){let{type:e,length:r,stride:i}=t;switch(e.typeId){case dn.Type.Int:case dn.Type.Float:case dn.Type.Decimal:case dn.Type.Time:case dn.Type.Timestamp:return t.values.subarray(0,r*i)}return[...pT.instance.visit(t)]}F.prototype.visitNull=N;F.prototype.visitBool=N;F.prototype.visitInt=N;F.prototype.visitInt8=N;F.prototype.visitInt16=N;F.prototype.visitInt32=N;F.prototype.visitInt64=N;F.prototype.visitUint8=N;F.prototype.visitUint16=N;F.prototype.visitUint32=N;F.prototype.visitUint64=N;F.prototype.visitFloat=N;F.prototype.visitFloat16=N;F.prototype.visitFloat32=N;F.prototype.visitFloat64=N;F.prototype.visitUtf8=N;F.prototype.visitBinary=N;F.prototype.visitFixedSizeBinary=N;F.prototype.visitDate=N;F.prototype.visitDateDay=N;F.prototype.visitDateMillisecond=N;F.prototype.visitTimestamp=N;F.prototype.visitTimestampSecond=N;F.prototype.visitTimestampMillisecond=N;F.prototype.visitTimestampMicrosecond=N;F.prototype.visitTimestampNanosecond=N;F.prototype.visitTime=N;F.prototype.visitTimeSecond=N;F.prototype.visitTimeMillisecond=N;F.prototype.visitTimeMicrosecond=N;F.prototype.visitTimeNanosecond=N;F.prototype.visitDecimal=N;F.prototype.visitList=N;F.prototype.visitStruct=N;F.prototype.visitUnion=N;F.prototype.visitDenseUnion=N;F.prototype.visitSparseUnion=N;F.prototype.visitDictionary=N;F.prototype.visitInterval=N;F.prototype.visitIntervalDayTime=N;F.prototype.visitIntervalYearMonth=N;F.prototype.visitFixedSizeList=N;F.prototype.visitMap=N;Sa.instance=new F});var Iy=b(Da=>{"use strict";Object.defineProperty(Da,"__esModule",{value:!0});var yT=ye(),mT=Y(),fn=(t,e)=>t+e,Cd=t=>`Cannot compute the byte width of variable-width column ${t}`,Aa=class extends yT.Visitor{visitNull(e){return 0}visitInt(e){return e.bitWidth/8}visitFloat(e){return e.ArrayType.BYTES_PER_ELEMENT}visitBinary(e){throw new Error(Cd(e))}visitUtf8(e){throw new Error(Cd(e))}visitBool(e){return 1/8}visitDecimal(e){return 16}visitDate(e){return(e.unit+1)*4}visitTime(e){return e.bitWidth/8}visitTimestamp(e){return e.unit===mT.TimeUnit.SECOND?4:8}visitInterval(e){return(e.unit+1)*4}visitList(e){throw new Error(Cd(e))}visitStruct(e){return this.visitFields(e.children).reduce(fn,0)}visitUnion(e){return this.visitFields(e.children).reduce(fn,0)}visitFixedSizeBinary(e){return e.byteWidth}visitFixedSizeList(e){return e.listSize*this.visitFields(e.children).reduce(fn,0)}visitMap(e){return this.visitFields(e.children).reduce(fn,0)}visitDictionary(e){return this.visit(e.indices)}visitFields(e){return(e||[]).map(r=>this.visit(r.type))}visitSchema(e){return this.visitFields(e.fields).reduce(fn,0)}};Da.ByteWidthVisitor=Aa;Da.instance=new Aa});var Sy=b(Ma=>{"use strict";Object.defineProperty(Ma,"__esModule",{value:!0});var bT=ye(),_T=Cl(),gT=Pl(),jd=Yl(),vT=Gl(),wT=oa(),BT=Xl(),TT=rd(),Fa=id(),kd=ad(),wt=ga(),IT=ud(),ST=fd(),AT=yd(),DT=_d(),hn=Td(),pn=Fd(),Pd=Vd(),FT=Ld(),Oa=class extends bT.Visitor{visitNull(){return AT.NullVector}visitBool(){return gT.BoolVector}visitInt(){return wt.IntVector}visitInt8(){return wt.Int8Vector}visitInt16(){return wt.Int16Vector}visitInt32(){return wt.Int32Vector}visitInt64(){return wt.Int64Vector}visitUint8(){return wt.Uint8Vector}visitUint16(){return wt.Uint16Vector}visitUint32(){return wt.Uint32Vector}visitUint64(){return wt.Uint64Vector}visitFloat(){return Fa.FloatVector}visitFloat16(){return Fa.Float16Vector}visitFloat32(){return Fa.Float32Vector}visitFloat64(){return Fa.Float64Vector}visitUtf8(){return FT.Utf8Vector}visitBinary(){return _T.BinaryVector}visitFixedSizeBinary(){return BT.FixedSizeBinaryVector}visitDate(){return jd.DateVector}visitDateDay(){return jd.DateDayVector}visitDateMillisecond(){return jd.DateMillisecondVector}visitTimestamp(){return hn.TimestampVector}visitTimestampSecond(){return hn.TimestampSecondVector}visitTimestampMillisecond(){return hn.TimestampMillisecondVector}visitTimestampMicrosecond(){return hn.TimestampMicrosecondVector}visitTimestampNanosecond(){return hn.TimestampNanosecondVector}visitTime(){return pn.TimeVector}visitTimeSecond(){return pn.TimeSecondVector}visitTimeMillisecond(){return pn.TimeMillisecondVector}visitTimeMicrosecond(){return pn.TimeMicrosecondVector}visitTimeNanosecond(){return pn.TimeNanosecondVector}visitDecimal(){return vT.DecimalVector}visitList(){return IT.ListVector}visitStruct(){return DT.StructVector}visitUnion(){return Pd.UnionVector}visitDenseUnion(){return Pd.DenseUnionVector}visitSparseUnion(){return Pd.SparseUnionVector}visitDictionary(){return wT.DictionaryVector}visitInterval(){return kd.IntervalVector}visitIntervalDayTime(){return kd.IntervalDayTimeVector}visitIntervalYearMonth(){return kd.IntervalYearMonthVector}visitFixedSizeList(){return TT.FixedSizeListVector}visitMap(){return ST.MapVector}};Ma.GetVectorConstructor=Oa;Ma.instance=new Oa});var at=b(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});var OT=ie();B.Vector=OT.Vector;var MT=ne();B.BaseVector=MT.BaseVector;var VT=Cl();B.BinaryVector=VT.BinaryVector;var UT=Pl();B.BoolVector=UT.BoolVector;var xT=At();B.Chunked=xT.Chunked;var $d=Yl();B.DateVector=$d.DateVector;B.DateDayVector=$d.DateDayVector;B.DateMillisecondVector=$d.DateMillisecondVector;var LT=Gl();B.DecimalVector=LT.DecimalVector;var NT=oa();B.DictionaryVector=NT.DictionaryVector;var ET=Xl();B.FixedSizeBinaryVector=ET.FixedSizeBinaryVector;var RT=rd();B.FixedSizeListVector=RT.FixedSizeListVector;var Ua=id();B.FloatVector=Ua.FloatVector;B.Float16Vector=Ua.Float16Vector;B.Float32Vector=Ua.Float32Vector;B.Float64Vector=Ua.Float64Vector;var Wd=ad();B.IntervalVector=Wd.IntervalVector;B.IntervalDayTimeVector=Wd.IntervalDayTimeVector;B.IntervalYearMonthVector=Wd.IntervalYearMonthVector;var Bt=ga();B.IntVector=Bt.IntVector;B.Int8Vector=Bt.Int8Vector;B.Int16Vector=Bt.Int16Vector;B.Int32Vector=Bt.Int32Vector;B.Int64Vector=Bt.Int64Vector;B.Uint8Vector=Bt.Uint8Vector;B.Uint16Vector=Bt.Uint16Vector;B.Uint32Vector=Bt.Uint32Vector;B.Uint64Vector=Bt.Uint64Vector;var qT=ud();B.ListVector=qT.ListVector;var CT=fd();B.MapVector=CT.MapVector;var jT=yd();B.NullVector=jT.NullVector;var kT=_d();B.StructVector=kT.StructVector;var mn=Td();B.TimestampVector=mn.TimestampVector;B.TimestampSecondVector=mn.TimestampSecondVector;B.TimestampMillisecondVector=mn.TimestampMillisecondVector;B.TimestampMicrosecondVector=mn.TimestampMicrosecondVector;B.TimestampNanosecondVector=mn.TimestampNanosecondVector;var bn=Fd();B.TimeVector=bn.TimeVector;B.TimeSecondVector=bn.TimeSecondVector;B.TimeMillisecondVector=bn.TimeMillisecondVector;B.TimeMicrosecondVector=bn.TimeMicrosecondVector;B.TimeNanosecondVector=bn.TimeNanosecondVector;var Yd=Vd();B.UnionVector=Yd.UnionVector;B.DenseUnionVector=Yd.DenseUnionVector;B.SparseUnionVector=Yd.SparseUnionVector;var PT=Ld();B.Utf8Vector=PT.Utf8Vector;var Fy=Ei();B.MapRow=Fy.MapRow;B.StructRow=Fy.StructRow;var yn=ey(),zd=Y(),Qr=ie(),Ay=At(),ur=ne(),zT=tt(),Va=_e(),Dy=ee(),Oy=Rd(),My=Mu(),Vy=wy(),Uy=Ty(),xy=qd(),Ly=Iy(),Ny=Sy();Qr.Vector.new=$T;Qr.Vector.from=YT;function $T(t,...e){return new(Ny.instance.getVisitFn(t)())(t,...e)}function WT(t,e){if(Va.isIterable(e))return Qr.Vector.from({nullValues:[null,void 0],type:t(),values:e});if(Va.isAsyncIterable(e))return Qr.Vector.from({nullValues:[null,void 0],type:t(),values:e});let{values:r=[],type:i=t(),nullValues:n=[null,void 0]}={...e};return Va.isIterable(r)?Qr.Vector.from({nullValues:n,...e,type:i}):Qr.Vector.from({nullValues:n,...e,type:i})}B.vectorFromValuesWithType=WT;function YT(t){let{values:e=[],...r}={nullValues:[null,void 0],...t};if(Va.isIterable(e)){let i=[...Dy.Builder.throughIterable(r)(e)];return i.length===1?i[0]:Ay.Chunked.concat(i)}return(async i=>{let n=Dy.Builder.throughAsyncIterable(r);for await(let a of n(e))i.push(a);return i.length===1?i[0]:Ay.Chunked.concat(i)})([])}ur.BaseVector.prototype.get=function(e){return Oy.instance.visit(this,e)};ur.BaseVector.prototype.set=function(e,r){return My.instance.visit(this,e,r)};ur.BaseVector.prototype.indexOf=function(e,r){return Vy.instance.visit(this,e,r)};ur.BaseVector.prototype.toArray=function(){return Uy.instance.visit(this)};ur.BaseVector.prototype.getByteWidth=function(){return Ly.instance.visit(this.type)};ur.BaseVector.prototype[Symbol.iterator]=function(){return xy.instance.visit(this)};ur.BaseVector.prototype._bindDataAccessors=KT;Object.keys(zd.Type).map(t=>zd.Type[t]).filter(t=>typeof t=="number").filter(t=>t!==zd.Type.NONE).forEach(t=>{let e=Ny.instance.visit(t);e.prototype.get=yn.partial1(Oy.instance.getVisitFn(t)),e.prototype.set=yn.partial2(My.instance.getVisitFn(t)),e.prototype.indexOf=yn.partial2(Vy.instance.getVisitFn(t)),e.prototype.toArray=yn.partial0(Uy.instance.getVisitFn(t)),e.prototype.getByteWidth=HT(Ly.instance.getVisitFn(t)),e.prototype[Symbol.iterator]=yn.partial0(xy.instance.getVisitFn(t))});function HT(t){return function(){return t(this.type)}}function JT(t){return function(e){return this.isValid(e)?t.call(this,e):null}}function GT(t){return function(e,r){zT.setBool(this.nullBitmap,this.offset+e,r!=null)&&t.call(this,e,r)}}function KT(){let t=this.nullBitmap;t&&t.byteLength>0&&(this.get=JT(this.get),this.set=GT(this.set))}});var tn=b(Zd=>{"use strict";Object.defineProperty(Zd,"__esModule",{value:!0});var ZT=Nr(),Ey=de(),Hd=vt(),QT=gn(),Gd=P(),Ry=Dt(),Jd=_e(),qy=na(),Cy=Ll(),Kd=at(),_n=class t extends Kd.Chunked{constructor(...e){let r=null;e[0]instanceof Ey.Schema&&(r=e.shift());let i=Ry.selectArgs(Hd.RecordBatch,e);if(!r&&!(r=i[0]&&i[0].schema))throw new TypeError("Table must be initialized with a Schema or at least one RecordBatch");i[0]||(i[0]=new Hd._InternalEmptyPlaceholderRecordBatch(r)),super(new Gd.Struct(r.fields),i),this._schema=r,this._chunks=i}static empty(e=new Ey.Schema([])){return new t(e,[])}static from(e){if(!e)return t.empty();if(typeof e=="object"){let i=Jd.isIterable(e.values)?XT(e):Jd.isAsyncIterable(e.values)?e0(e):null;if(i!==null)return i}let r=QT.RecordBatchReader.from(e);return Jd.isPromise(r)?(async()=>await t.from(await r))():r.isSync()&&(r=r.open())?r.schema?new t(r.schema,[...r]):t.empty():(async i=>{let n=await i,a=n.schema,o=[];if(a){for await(let c of n)o.push(c);return new t(a,o)}return t.empty()})(r.open())}static async fromAsync(e){return await t.from(e)}static fromStruct(e){return t.new(e.data.childData,e.type.children)}static new(...e){return new t(...Cy.distributeColumnsIntoRecordBatches(Ry.selectColumnArgs(e)))}get schema(){return this._schema}get length(){return this._length}get chunks(){return this._chunks}get numCols(){return this._numChildren}clone(e=this._chunks){return new t(this._schema,e)}getColumn(e){return this.getColumnAt(this.getColumnIndex(e))}getColumnAt(e){return this.getChildAt(e)}getColumnIndex(e){return this._schema.fields.findIndex(r=>r.name===e)}getChildAt(e){if(e<0||e>=this.numChildren)return null;let r,i,n=this._schema.fields,a=this._children||(this._children=[]);if(i=a[e])return i;if(r=n[e]){let o=this._chunks.map(c=>c.getChildAt(e)).filter(c=>c!=null);if(o.length>0)return a[e]=new ZT.Column(r,o)}return null}serialize(e="binary",r=!0){return(r?qy.RecordBatchStreamWriter:qy.RecordBatchFileWriter).writeAll(this).toUint8Array(!0)}count(){return this._length}select(...e){let r=this._schema.fields.reduce((i,n,a)=>i.set(n.name,a),new Map);return this.selectAt(...e.map(i=>r.get(i)).filter(i=>i>-1))}selectAt(...e){let r=this._schema.selectAt(...e);return new t(r,this._chunks.map(({length:i,data:{childData:n}})=>new Hd.RecordBatch(r,i,e.map(a=>n[a]).filter(Boolean))))}assign(e){let r=this._schema.fields,[i,n]=e.schema.fields.reduce((c,l,s)=>{let[u,y]=c,w=r.findIndex(C=>C.name===l.name);return~w?y[w]=s:u.push(s),c},[[],[]]),a=this._schema.assign(e.schema),o=[...r.map((c,l,s,u=n[l])=>u===void 0?this.getColumnAt(l):e.getColumnAt(u)),...i.map(c=>e.getColumnAt(c))].filter(Boolean);return new t(...Cy.distributeVectorsIntoRecordBatches(a,o))}};Zd.Table=_n;function XT(t){let{type:e}=t;return e instanceof Gd.Struct?_n.fromStruct(Kd.StructVector.from(t)):null}function e0(t){let{type:e}=t;return e instanceof Gd.Struct?Kd.StructVector.from(t).then(r=>_n.fromStruct(r)):null}});var vt=b(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});var Xd=ke(),Qd=tn(),t0=ie(),r0=ye(),i0=de(),n0=_e(),s0=At(),a0=Dt(),ef=P(),o0=Ll(),c0=at(),xa=class t extends c0.StructVector{constructor(...e){let r,i=e[0],n;if(e[1]instanceof Xd.Data)[,r,n]=e;else{let a=i.fields,[,o,c]=e;r=Xd.Data.Struct(new ef.Struct(a),0,o,0,null,c)}super(r,n),this._schema=i}static from(e){return n0.isIterable(e.values),Qd.Table.from(e)}static new(...e){let[r,i]=a0.selectFieldArgs(e),n=i.filter(a=>a instanceof t0.Vector);return new t(...o0.ensureSameLengthData(new i0.Schema(r),n.map(a=>a.data)))}clone(e,r=this._children){return new t(this._schema,e,r)}concat(...e){let r=this._schema,i=s0.Chunked.flatten(this,...e);return new Qd.Table(r,i.map(({data:n})=>new t(r,n)))}get schema(){return this._schema}get numCols(){return this._schema.fields.length}get dictionaries(){return this._dictionaries||(this._dictionaries=rf.collect(this))}select(...e){let r=this._schema.fields.reduce((i,n,a)=>i.set(n.name,a),new Map);return this.selectAt(...e.map(i=>r.get(i)).filter(i=>i>-1))}selectAt(...e){let r=this._schema.selectAt(...e),i=e.map(n=>this.data.childData[n]).filter(Boolean);return new t(r,this.length,i)}};La.RecordBatch=xa;var tf=class extends xa{constructor(e){super(e,0,e.fields.map(r=>Xd.Data.new(r.type,0,0,0)))}};La._InternalEmptyPlaceholderRecordBatch=tf;var rf=class t extends r0.Visitor{constructor(){super(...arguments),this.dictionaries=new Map}static collect(e){return new t().visit(e.data,new ef.Struct(e.schema.fields)).dictionaries}visit(e,r){return ef.DataType.isDictionary(r)?this.visitDictionary(e,r):(e.childData.forEach((i,n)=>this.visit(i,r.children[n].type)),this)}visitDictionary(e,r){let i=e.dictionary;return i&&i.length>0&&this.dictionaries.set(r.id,i),this}}});var gn=b(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});var jy=ie(),Na=Y(),Wy=ku(),ky=ui(),Py=xt(),vn=Ju(),Yy=dp(),af=vt(),lr=Ir(),Ee=ta(),Ne=_e(),dr=class t extends lr.ReadableInterop{constructor(e){super(),this._impl=e}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(e){return this._impl.throw(e)}return(e){return this._impl.return(e)}cancel(){return this._impl.cancel()}reset(e){return this._impl.reset(e),this._DOMStream=void 0,this._nodeStream=void 0,this}open(e){let r=this._impl.open(e);return Ne.isPromise(r)?r.then(()=>this):this}readRecordBatch(e){return this._impl.isFile()?this._impl.readRecordBatch(e):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return ky.default.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return ky.default.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,r){throw new Error('"throughDOM" not available in this environment')}static from(e){return e instanceof t?e:Ne.isArrowJSON(e)?u0(e):Ne.isFileHandle(e)?f0(e):Ne.isPromise(e)?(async()=>await t.from(await e))():Ne.isFetchResponse(e)||Ne.isReadableDOMStream(e)||Ne.isReadableNodeStream(e)||Ne.isAsyncIterable(e)?d0(new Py.AsyncByteStream(e)):l0(new Py.ByteStream(e))}static readAll(e){return e instanceof t?e.isSync()?zy(e):$y(e):Ne.isArrowJSON(e)||ArrayBuffer.isView(e)||Ne.isIterable(e)||Ne.isIteratorResult(e)?zy(e):$y(e)}};pr.RecordBatchReader=dr;var fr=class extends dr{constructor(e){super(e),this._impl=e}[Symbol.iterator](){return this._impl[Symbol.iterator]()}async*[Symbol.asyncIterator](){yield*this[Symbol.iterator]()}};pr.RecordBatchStreamReader=fr;var hr=class extends dr{constructor(e){super(e),this._impl=e}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}};pr.AsyncRecordBatchStreamReader=hr;var wn=class extends fr{constructor(e){super(e),this._impl=e}};pr.RecordBatchFileReader=wn;var Ea=class extends hr{constructor(e){super(e),this._impl=e}};pr.AsyncRecordBatchFileReader=Ea;var Ra=class{constructor(e=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=e}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(e){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=e,this.dictionaries=new Map,this}_loadRecordBatch(e,r){return new af.RecordBatch(this.schema,e.length,this._loadVectors(e,r,this.schema.fields))}_loadDictionaryBatch(e,r){let{id:i,isDelta:n,data:a}=e,{dictionaries:o,schema:c}=this,l=o.get(i);if(n||!l){let s=c.dictionaries.get(i);return l&&n?l.concat(jy.Vector.new(this._loadVectors(a,r,[s])[0])):jy.Vector.new(this._loadVectors(a,r,[s])[0])}return l}_loadVectors(e,r,i){return new Yy.VectorLoader(r,e.nodes,e.buffers,this.dictionaries).visitMany(i)}},Xr=class extends Ra{constructor(e,r){super(r),this._reader=Ne.isArrowJSON(e)?new Ee.JSONMessageReader(this._handle=e):new Ee.MessageReader(this._handle=e)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(e){return this.closed||(this.autoDestroy=Hy(this,e),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(e):lr.ITERATOR_DONE}return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(e):lr.ITERATOR_DONE}next(){if(this.closed)return lr.ITERATOR_DONE;let e,{_reader:r}=this;for(;e=this._readNextMessageAndValidate();)if(e.isSchema())this.reset(e.header());else if(e.isRecordBatch()){this._recordBatchIndex++;let i=e.header(),n=r.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(i,n)}}else if(e.isDictionaryBatch()){this._dictionaryIndex++;let i=e.header(),n=r.readMessageBody(e.bodyLength),a=this._loadDictionaryBatch(i,n);this.dictionaries.set(i.id,a)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new af._InternalEmptyPlaceholderRecordBatch(this.schema)}):this.return()}_readNextMessageAndValidate(e){return this._reader.readMessage(e)}},ei=class extends Ra{constructor(e,r){super(r),this._reader=new Ee.AsyncMessageReader(this._handle=e)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}async cancel(){!this.closed&&(this.closed=!0)&&(await this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}async open(e){return this.closed||(this.autoDestroy=Hy(this,e),this.schema||(this.schema=await this._reader.readSchema())||await this.cancel()),this}async throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?await this.reset()._reader.throw(e):lr.ITERATOR_DONE}async return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?await this.reset()._reader.return(e):lr.ITERATOR_DONE}async next(){if(this.closed)return lr.ITERATOR_DONE;let e,{_reader:r}=this;for(;e=await this._readNextMessageAndValidate();)if(e.isSchema())await this.reset(e.header());else if(e.isRecordBatch()){this._recordBatchIndex++;let i=e.header(),n=await r.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(i,n)}}else if(e.isDictionaryBatch()){this._dictionaryIndex++;let i=e.header(),n=await r.readMessageBody(e.bodyLength),a=this._loadDictionaryBatch(i,n);this.dictionaries.set(i.id,a)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new af._InternalEmptyPlaceholderRecordBatch(this.schema)}):await this.return()}async _readNextMessageAndValidate(e){return await this._reader.readMessage(e)}},qa=class extends Xr{constructor(e,r){super(e instanceof vn.RandomAccessFile?e:new vn.RandomAccessFile(e),r)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(let r of this._footer.dictionaryBatches())r&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(e)}readRecordBatch(e){if(this.closed)return null;this._footer||this.open();let r=this._footer&&this._footer.getRecordBatch(e);if(r&&this._handle.seek(r.offset)){let i=this._reader.readMessage(Na.MessageHeader.RecordBatch);if(i&&i.isRecordBatch()){let n=i.header(),a=this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(n,a)}}return null}_readDictionaryBatch(e){let r=this._footer&&this._footer.getDictionaryBatch(e);if(r&&this._handle.seek(r.offset)){let i=this._reader.readMessage(Na.MessageHeader.DictionaryBatch);if(i&&i.isDictionaryBatch()){let n=i.header(),a=this._reader.readMessageBody(i.bodyLength),o=this._loadDictionaryBatch(n,a);this.dictionaries.set(n.id,o)}}}_readFooter(){let{_handle:e}=this,r=e.size-Ee.magicAndPadding,i=e.readInt32(r),n=e.readAt(r-i,i);return Wy.Footer.decode(n)}_readNextMessageAndValidate(e){if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let r=this._footer&&this._footer.getRecordBatch(this._recordBatchIndex);if(r&&this._handle.seek(r.offset))return this._reader.readMessage(e)}return null}},nf=class extends ei{constructor(e,...r){let i=typeof r[0]!="number"?r.shift():void 0,n=r[0]instanceof Map?r.shift():void 0;super(e instanceof vn.AsyncRandomAccessFile?e:new vn.AsyncRandomAccessFile(e,i),n)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}async open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=await this._readFooter()).schema;for(let r of this._footer.dictionaryBatches())r&&await this._readDictionaryBatch(this._dictionaryIndex++)}return await super.open(e)}async readRecordBatch(e){if(this.closed)return null;this._footer||await this.open();let r=this._footer&&this._footer.getRecordBatch(e);if(r&&await this._handle.seek(r.offset)){let i=await this._reader.readMessage(Na.MessageHeader.RecordBatch);if(i&&i.isRecordBatch()){let n=i.header(),a=await this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(n,a)}}return null}async _readDictionaryBatch(e){let r=this._footer&&this._footer.getDictionaryBatch(e);if(r&&await this._handle.seek(r.offset)){let i=await this._reader.readMessage(Na.MessageHeader.DictionaryBatch);if(i&&i.isDictionaryBatch()){let n=i.header(),a=await this._reader.readMessageBody(i.bodyLength),o=this._loadDictionaryBatch(n,a);this.dictionaries.set(n.id,o)}}}async _readFooter(){let{_handle:e}=this;e._pending&&await e._pending;let r=e.size-Ee.magicAndPadding,i=await e.readInt32(r),n=await e.readAt(r-i,i);return Wy.Footer.decode(n)}async _readNextMessageAndValidate(e){if(this._footer||await this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let r=this._footer.getRecordBatch(this._recordBatchIndex);if(r&&await this._handle.seek(r.offset))return await this._reader.readMessage(e)}return null}},sf=class extends Xr{constructor(e,r){super(e,r)}_loadVectors(e,r,i){return new Yy.JSONVectorLoader(r,e.nodes,e.buffers,this.dictionaries).visitMany(i)}};function Hy(t,e){return e&&typeof e.autoDestroy=="boolean"?e.autoDestroy:t.autoDestroy}function*zy(t){let e=dr.from(t);try{if(!e.open({autoDestroy:!1}).closed)do yield e;while(!e.reset().open().closed)}finally{e.cancel()}}async function*$y(t){let e=await dr.from(t);try{if(!(await e.open({autoDestroy:!1})).closed)do yield e;while(!(await e.reset().open()).closed)}finally{await e.cancel()}}function u0(t){return new fr(new sf(t))}function l0(t){let e=t.peek(Ee.magicLength+7&-8);return e&&e.byteLength>=4?Ee.checkForMagicArrowString(e)?new wn(new qa(t.read())):new fr(new Xr(t)):new fr(new Xr((function*(){})()))}async function d0(t){let e=await t.peek(Ee.magicLength+7&-8);return e&&e.byteLength>=4?Ee.checkForMagicArrowString(e)?new wn(new qa(await t.read())):new hr(new ei(t)):new hr(new ei((async function*(){})()))}async function f0(t){let{size:e}=await t.stat(),r=new vn.AsyncRandomAccessFile(t,e);return e>=Ee.magicX2AndPadding&&Ee.checkForMagicArrowString(await r.readAt(0,Ee.magicLength+7&-8))?new Ea(new nf(r)):new hr(new ei(r))}});var Ky=b(of=>{"use strict";Object.defineProperty(of,"__esModule",{value:!0});var Gy=se(),Jy=_e();function h0(t,e){if(Jy.isAsyncIterable(t))return y0(t,e);if(Jy.isIterable(t))return p0(t,e);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")}of.toDOMStream=h0;function p0(t,e){let r=null,i=e&&e.type==="bytes"||!1,n=e&&e.highWaterMark||2**24;return new ReadableStream({...e,start(o){a(o,r||(r=t[Symbol.iterator]()))},pull(o){r?a(o,r):o.close()},cancel(){(r&&r.return&&r.return()||!0)&&(r=null)}},{highWaterMark:i?n:void 0,...e});function a(o,c){let l,s=null,u=o.desiredSize||null;for(;!(s=c.next(i?u:null)).done;)if(ArrayBuffer.isView(s.value)&&(l=Gy.toUint8Array(s.value))&&(u!=null&&i&&(u=u-l.byteLength+1),s.value=l),o.enqueue(s.value),u!=null&&--u<=0)return;o.close()}}function y0(t,e){let r=null,i=e&&e.type==="bytes"||!1,n=e&&e.highWaterMark||2**24;return new ReadableStream({...e,async start(o){await a(o,r||(r=t[Symbol.asyncIterator]()))},async pull(o){r?await a(o,r):o.close()},async cancel(){(r&&r.return&&await r.return()||!0)&&(r=null)}},{highWaterMark:i?n:void 0,...e});async function a(o,c){let l,s=null,u=o.desiredSize||null;for(;!(s=await c.next(i?u:null)).done;)if(ArrayBuffer.isView(s.value)&&(l=Gy.toUint8Array(s.value))&&(u!=null&&i&&(u=u-l.byteLength+1),s.value=l),o.enqueue(s.value),u!=null&&--u<=0)return;o.close()}}});var Xy=b(ja=>{"use strict";Object.defineProperty(ja,"__esModule",{value:!0});var m0=Ns();function b0(t){return new Ca(t)}ja.builderThroughDOMStream=b0;var Ca=class{constructor(e){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{["readableStrategy"]:r,["writableStrategy"]:i,["queueingStrategy"]:n="count",...a}=e;this._controller=null,this._builder=m0.Builder.new(a),this._getSize=n!=="bytes"?Zy:Qy;let{["highWaterMark"]:o=n==="bytes"?2**14:1e3}={...r},{["highWaterMark"]:c=n==="bytes"?2**14:1e3}={...i};this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:l=>{this._maybeFlush(this._builder,this._controller=l)},start:l=>{this._maybeFlush(this._builder,this._controller=l)}},{highWaterMark:o,size:n!=="bytes"?Zy:Qy}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:c,size:l=>this._writeValueAndReturnChunkSize(l)})}_writeValueAndReturnChunkSize(e){let r=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(e)),this._bufferedSize-r}_maybeFlush(e,r){r!==null&&(this._bufferedSize>=r.desiredSize&&++this._numChunks&&this._enqueue(r,e.toVector()),e.finished&&((e.length>0||this._numChunks===0)&&++this._numChunks&&this._enqueue(r,e.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(r,null)))}_enqueue(e,r){this._bufferedSize=0,this._controller=null,r===null?e.close():e.enqueue(r)}};ja.BuilderTransform=Ca;var Zy=t=>t.length,Qy=t=>t.byteLength});var em=b(cf=>{"use strict";Object.defineProperty(cf,"__esModule",{value:!0});var _0=xt(),g0=gn();function v0(t,e){let r=new _0.AsyncByteQueue,i=null,n=new ReadableStream({async cancel(){await r.close()},async start(c){await o(c,i||(i=await a()))},async pull(c){i?await o(c,i):c.close()}});return{writable:new WritableStream(r,{highWaterMark:2**14,...t}),readable:n};async function a(){return await(await g0.RecordBatchReader.from(r)).open(e)}async function o(c,l){let s=c.desiredSize,u=null;for(;!(u=await l.next()).done;)if(c.enqueue(u.value),s!=null&&--s<=0)return;c.close()}}cf.recordBatchReaderThroughDOMStream=v0});var tm=b(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});var w0=xt();function B0(t,e){let r=new this(t),i=new w0.AsyncByteStream(r),n=new ReadableStream({type:"bytes",async cancel(){await i.cancel()},async pull(o){await a(o)},async start(o){await a(o)}},{highWaterMark:2**14,...e});return{writable:new WritableStream(r,t),readable:n};async function a(o){let c=null,l=o.desiredSize;for(;c=await i.read(l||null);)if(o.enqueue(c),l!=null&&(l-=c.byteLength)<=0)return;o.close()}}uf.recordBatchWriterThroughDOMStream=B0});var lf=b(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});var T0=oa(),Bn=class t{eq(e){return e instanceof t||(e=new ct(e)),new Pa(this,e)}le(e){return e instanceof t||(e=new ct(e)),new za(this,e)}ge(e){return e instanceof t||(e=new ct(e)),new $a(this,e)}lt(e){return new yr(this.ge(e))}gt(e){return new yr(this.le(e))}ne(e){return new yr(this.eq(e))}};ae.Value=Bn;var ct=class extends Bn{constructor(e){super(),this.v=e}};ae.Literal=ct;var ka=class extends Bn{constructor(e){super(),this.name=e}bind(e){if(!this.colidx){this.colidx=-1;let i=e.schema.fields;for(let n=-1;++n<i.length;)if(i[n].name===this.name){this.colidx=n;break}if(this.colidx<0)throw new Error(`Failed to bind Col "${this.name}"`)}let r=this.vector=e.getChildAt(this.colidx);return i=>r.get(i)}};ae.Col=ka;var mr=class{and(...e){return new Tn(this,...e)}or(...e){return new In(this,...e)}not(){return new yr(this)}};ae.Predicate=mr;var ti=class extends mr{constructor(e,r){super(),this.left=e,this.right=r}bind(e){return this.left instanceof ct?this.right instanceof ct?this._bindLitLit(e,this.left,this.right):this._bindLitCol(e,this.left,this.right):this.right instanceof ct?this._bindColLit(e,this.left,this.right):this._bindColCol(e,this.left,this.right)}};ae.ComparisonPredicate=ti;var ri=class extends mr{constructor(...e){super(),this.children=e}};ae.CombinationPredicate=ri;ri.prototype.children=Object.freeze([]);var Tn=class t extends ri{constructor(...e){e=e.reduce((r,i)=>r.concat(i instanceof t?i.children:i),[]),super(...e)}bind(e){let r=this.children.map(i=>i.bind(e));return(i,n)=>r.every(a=>a(i,n))}};ae.And=Tn;var In=class t extends ri{constructor(...e){e=e.reduce((r,i)=>r.concat(i instanceof t?i.children:i),[]),super(...e)}bind(e){let r=this.children.map(i=>i.bind(e));return(i,n)=>r.some(a=>a(i,n))}};ae.Or=In;var Pa=class extends ti{_bindLitLit(e,r,i){let n=r.v==i.v;return()=>n}_bindColCol(e,r,i){let n=r.bind(e),a=i.bind(e);return(o,c)=>n(o,c)==a(o,c)}_bindColLit(e,r,i){let n=r.bind(e);if(r.vector instanceof T0.DictionaryVector){let a,o=r.vector;return o.dictionary!==this.lastDictionary?(a=o.reverseLookup(i.v),this.lastDictionary=o.dictionary,this.lastKey=a):a=this.lastKey,a===-1?()=>!1:c=>o.getKey(c)===a}else return(a,o)=>n(a,o)==i.v}_bindLitCol(e,r,i){return this._bindColLit(e,i,r)}};ae.Equals=Pa;var za=class extends ti{_bindLitLit(e,r,i){let n=r.v<=i.v;return()=>n}_bindColCol(e,r,i){let n=r.bind(e),a=i.bind(e);return(o,c)=>n(o,c)<=a(o,c)}_bindColLit(e,r,i){let n=r.bind(e);return(a,o)=>n(a,o)<=i.v}_bindLitCol(e,r,i){let n=i.bind(e);return(a,o)=>r.v<=n(a,o)}};ae.LTeq=za;var $a=class extends ti{_bindLitLit(e,r,i){let n=r.v>=i.v;return()=>n}_bindColCol(e,r,i){let n=r.bind(e),a=i.bind(e);return(o,c)=>n(o,c)>=a(o,c)}_bindColLit(e,r,i){let n=r.bind(e);return(a,o)=>n(a,o)>=i.v}_bindLitCol(e,r,i){let n=i.bind(e);return(a,o)=>r.v>=n(a,o)}};ae.GTeq=$a;var yr=class extends mr{constructor(e){super(),this.child=e}bind(e){let r=this.child.bind(e);return(i,n)=>!r(i,n)}};ae.Not=yr;var Wa=class extends mr{constructor(e,r){super(),this.next=e,this.bind_=r}bind(e){return this.bind_(e),this.next}};ae.CustomPredicate=Wa;function I0(t){return new ct(t)}ae.lit=I0;function S0(t){return new ka(t)}ae.col=S0;function A0(...t){return new Tn(...t)}ae.and=A0;function D0(...t){return new In(...t)}ae.or=D0;function F0(t,e){return new Wa(t,e)}ae.custom=F0});var sm=b(An=>{"use strict";Object.defineProperty(An,"__esModule",{value:!0});var ii=tn(),rm=ga(),df=de(),im=lf(),O0=vt(),nm=P();ii.Table.prototype.countBy=function(t){return new kt(this.chunks).countBy(t)};ii.Table.prototype.scan=function(t,e){return new kt(this.chunks).scan(t,e)};ii.Table.prototype.scanReverse=function(t,e){return new kt(this.chunks).scanReverse(t,e)};ii.Table.prototype.filter=function(t){return new kt(this.chunks).filter(t)};var kt=class extends ii.Table{filter(e){return new Ya(this.chunks,e)}scan(e,r){let i=this.chunks,n=i.length;for(let a=-1;++a<n;){let o=i[a];r&&r(o);for(let c=-1,l=o.length;++c<l;)e(c,o)}}scanReverse(e,r){let i=this.chunks,n=i.length;for(let a=n;--a>=0;){let o=i[a];r&&r(o);for(let c=o.length;--c>=0;)e(c,o)}}countBy(e){let r=this.chunks,i=r.length,n=typeof e=="string"?new im.Col(e):e;n.bind(r[i-1]);let a=n.vector;if(!nm.DataType.isDictionary(a.type))throw new Error("countBy currently only supports dictionary-encoded columns");let o=Math.ceil(Math.log(a.length)/Math.log(256)),c=o==4?Uint32Array:o>=2?Uint16Array:Uint8Array,l=new c(a.dictionary.length);for(let s=-1;++s<i;){let u=r[s];n.bind(u);let y=n.vector.indices;for(let w=-1,C=u.length;++w<C;){let Be=y.get(w);Be!==null&&l[Be]++}}return new Sn(a.dictionary,rm.IntVector.from(l))}};An.DataFrame=kt;var Sn=class extends ii.Table{constructor(e,r){let i=new df.Schema([new df.Field("values",e.type),new df.Field("counts",r.type)]);super(new O0.RecordBatch(i,r.length,[e,r]))}toJSON(){let e=this.getColumnAt(0),r=this.getColumnAt(1),i={};for(let n=-1;++n<this.length;)i[e.get(n)]=r.get(n);return i}};An.CountByResult=Sn;var Ya=class t extends kt{constructor(e,r){super(e),this._predicate=r}scan(e,r){let i=this._chunks,n=i.length;for(let a=-1;++a<n;){let o=i[a],c=this._predicate.bind(o),l=!1;for(let s=-1,u=o.length;++s<u;)c(s,o)&&(r&&!l&&(r(o),l=!0),e(s,o))}}scanReverse(e,r){let i=this._chunks,n=i.length;for(let a=n;--a>=0;){let o=i[a],c=this._predicate.bind(o),l=!1;for(let s=o.length;--s>=0;)c(s,o)&&(r&&!l&&(r(o),l=!0),e(s,o))}}count(){let e=0,r=this._chunks,i=r.length;for(let n=-1;++n<i;){let a=r[n],o=this._predicate.bind(a);for(let c=-1,l=a.length;++c<l;)o(c,a)&&++e}return e}*[Symbol.iterator](){let e=this._chunks,r=e.length;for(let i=-1;++i<r;){let n=e[i],a=this._predicate.bind(n);for(let o=-1,c=n.length;++o<c;)a(o,n)&&(yield n.get(o))}}filter(e){return new t(this._chunks,this._predicate.and(e))}countBy(e){let r=this._chunks,i=r.length,n=typeof e=="string"?new im.Col(e):e;n.bind(r[i-1]);let a=n.vector;if(!nm.DataType.isDictionary(a.type))throw new Error("countBy currently only supports dictionary-encoded columns");let o=Math.ceil(Math.log(a.length)/Math.log(256)),c=o==4?Uint32Array:o>=2?Uint16Array:Uint8Array,l=new c(a.dictionary.length);for(let s=-1;++s<i;){let u=r[s],y=this._predicate.bind(u);n.bind(u);let w=n.vector.indices;for(let C=-1,Be=u.length;++C<Be;){let gr=w.get(C);gr!==null&&y(C,u)&&l[gr]++}}return new Sn(a.dictionary,rm.IntVector.from(l))}};An.FilteredDataFrame=Ya});var om=b(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});var ut=Y();d.ArrowType=ut.ArrowType;d.DateUnit=ut.DateUnit;d.IntervalUnit=ut.IntervalUnit;d.MessageHeader=ut.MessageHeader;d.MetadataVersion=ut.MetadataVersion;d.Precision=ut.Precision;d.TimeUnit=ut.TimeUnit;d.Type=ut.Type;d.UnionMode=ut.UnionMode;d.BufferType=ut.BufferType;var M0=ke();d.Data=M0.Data;var U=P();d.DataType=U.DataType;d.Null=U.Null;d.Bool=U.Bool;d.Int=U.Int;d.Int8=U.Int8;d.Int16=U.Int16;d.Int32=U.Int32;d.Int64=U.Int64;d.Uint8=U.Uint8;d.Uint16=U.Uint16;d.Uint32=U.Uint32;d.Uint64=U.Uint64;d.Float=U.Float;d.Float16=U.Float16;d.Float32=U.Float32;d.Float64=U.Float64;d.Utf8=U.Utf8;d.Binary=U.Binary;d.FixedSizeBinary=U.FixedSizeBinary;d.Date_=U.Date_;d.DateDay=U.DateDay;d.DateMillisecond=U.DateMillisecond;d.Timestamp=U.Timestamp;d.TimestampSecond=U.TimestampSecond;d.TimestampMillisecond=U.TimestampMillisecond;d.TimestampMicrosecond=U.TimestampMicrosecond;d.TimestampNanosecond=U.TimestampNanosecond;d.Time=U.Time;d.TimeSecond=U.TimeSecond;d.TimeMillisecond=U.TimeMillisecond;d.TimeMicrosecond=U.TimeMicrosecond;d.TimeNanosecond=U.TimeNanosecond;d.Decimal=U.Decimal;d.List=U.List;d.Struct=U.Struct;d.Union=U.Union;d.DenseUnion=U.DenseUnion;d.SparseUnion=U.SparseUnion;d.Dictionary=U.Dictionary;d.Interval=U.Interval;d.IntervalDayTime=U.IntervalDayTime;d.IntervalYearMonth=U.IntervalYearMonth;d.FixedSizeList=U.FixedSizeList;d.Map_=U.Map_;var V0=tn();d.Table=V0.Table;var U0=Nr();d.Column=U0.Column;var x0=ye();d.Visitor=x0.Visitor;var am=de();d.Schema=am.Schema;d.Field=am.Field;var V=at();d.Vector=V.Vector;d.BaseVector=V.BaseVector;d.BinaryVector=V.BinaryVector;d.BoolVector=V.BoolVector;d.Chunked=V.Chunked;d.DateVector=V.DateVector;d.DateDayVector=V.DateDayVector;d.DateMillisecondVector=V.DateMillisecondVector;d.DecimalVector=V.DecimalVector;d.DictionaryVector=V.DictionaryVector;d.FixedSizeBinaryVector=V.FixedSizeBinaryVector;d.FixedSizeListVector=V.FixedSizeListVector;d.FloatVector=V.FloatVector;d.Float16Vector=V.Float16Vector;d.Float32Vector=V.Float32Vector;d.Float64Vector=V.Float64Vector;d.IntervalVector=V.IntervalVector;d.IntervalDayTimeVector=V.IntervalDayTimeVector;d.IntervalYearMonthVector=V.IntervalYearMonthVector;d.IntVector=V.IntVector;d.Int8Vector=V.Int8Vector;d.Int16Vector=V.Int16Vector;d.Int32Vector=V.Int32Vector;d.Int64Vector=V.Int64Vector;d.Uint8Vector=V.Uint8Vector;d.Uint16Vector=V.Uint16Vector;d.Uint32Vector=V.Uint32Vector;d.Uint64Vector=V.Uint64Vector;d.ListVector=V.ListVector;d.MapVector=V.MapVector;d.NullVector=V.NullVector;d.StructVector=V.StructVector;d.TimestampVector=V.TimestampVector;d.TimestampSecondVector=V.TimestampSecondVector;d.TimestampMillisecondVector=V.TimestampMillisecondVector;d.TimestampMicrosecondVector=V.TimestampMicrosecondVector;d.TimestampNanosecondVector=V.TimestampNanosecondVector;d.TimeVector=V.TimeVector;d.TimeSecondVector=V.TimeSecondVector;d.TimeMillisecondVector=V.TimeMillisecondVector;d.TimeMicrosecondVector=V.TimeMicrosecondVector;d.TimeNanosecondVector=V.TimeNanosecondVector;d.UnionVector=V.UnionVector;d.DenseUnionVector=V.DenseUnionVector;d.SparseUnionVector=V.SparseUnionVector;d.Utf8Vector=V.Utf8Vector;var x=Ns();d.Builder=x.Builder;d.BinaryBuilder=x.BinaryBuilder;d.BoolBuilder=x.BoolBuilder;d.DateBuilder=x.DateBuilder;d.DateDayBuilder=x.DateDayBuilder;d.DateMillisecondBuilder=x.DateMillisecondBuilder;d.DecimalBuilder=x.DecimalBuilder;d.DictionaryBuilder=x.DictionaryBuilder;d.FixedSizeBinaryBuilder=x.FixedSizeBinaryBuilder;d.FixedSizeListBuilder=x.FixedSizeListBuilder;d.FloatBuilder=x.FloatBuilder;d.Float16Builder=x.Float16Builder;d.Float32Builder=x.Float32Builder;d.Float64Builder=x.Float64Builder;d.IntervalBuilder=x.IntervalBuilder;d.IntervalDayTimeBuilder=x.IntervalDayTimeBuilder;d.IntervalYearMonthBuilder=x.IntervalYearMonthBuilder;d.IntBuilder=x.IntBuilder;d.Int8Builder=x.Int8Builder;d.Int16Builder=x.Int16Builder;d.Int32Builder=x.Int32Builder;d.Int64Builder=x.Int64Builder;d.Uint8Builder=x.Uint8Builder;d.Uint16Builder=x.Uint16Builder;d.Uint32Builder=x.Uint32Builder;d.Uint64Builder=x.Uint64Builder;d.ListBuilder=x.ListBuilder;d.MapBuilder=x.MapBuilder;d.NullBuilder=x.NullBuilder;d.StructBuilder=x.StructBuilder;d.TimestampBuilder=x.TimestampBuilder;d.TimestampSecondBuilder=x.TimestampSecondBuilder;d.TimestampMillisecondBuilder=x.TimestampMillisecondBuilder;d.TimestampMicrosecondBuilder=x.TimestampMicrosecondBuilder;d.TimestampNanosecondBuilder=x.TimestampNanosecondBuilder;d.TimeBuilder=x.TimeBuilder;d.TimeSecondBuilder=x.TimeSecondBuilder;d.TimeMillisecondBuilder=x.TimeMillisecondBuilder;d.TimeMicrosecondBuilder=x.TimeMicrosecondBuilder;d.TimeNanosecondBuilder=x.TimeNanosecondBuilder;d.UnionBuilder=x.UnionBuilder;d.DenseUnionBuilder=x.DenseUnionBuilder;d.SparseUnionBuilder=x.SparseUnionBuilder;d.Utf8Builder=x.Utf8Builder;var ff=xt();d.ByteStream=ff.ByteStream;d.AsyncByteStream=ff.AsyncByteStream;d.AsyncByteQueue=ff.AsyncByteQueue;var Dn=gn();d.RecordBatchReader=Dn.RecordBatchReader;d.RecordBatchFileReader=Dn.RecordBatchFileReader;d.RecordBatchStreamReader=Dn.RecordBatchStreamReader;d.AsyncRecordBatchFileReader=Dn.AsyncRecordBatchFileReader;d.AsyncRecordBatchStreamReader=Dn.AsyncRecordBatchStreamReader;var Ha=na();d.RecordBatchWriter=Ha.RecordBatchWriter;d.RecordBatchFileWriter=Ha.RecordBatchFileWriter;d.RecordBatchStreamWriter=Ha.RecordBatchStreamWriter;d.RecordBatchJSONWriter=Ha.RecordBatchJSONWriter;var hf=ta();d.MessageReader=hf.MessageReader;d.AsyncMessageReader=hf.AsyncMessageReader;d.JSONMessageReader=hf.JSONMessageReader;var L0=tr();d.Message=L0.Message;var N0=vt();d.RecordBatch=N0.RecordBatch;var pf=sm();d.DataFrame=pf.DataFrame;d.FilteredDataFrame=pf.FilteredDataFrame;d.CountByResult=pf.CountByResult;var E0=xi(),R0=Zu(),q0=tt(),C0=Mi(),j0=se(),k0=Ci(),P0=lf();d.predicate=P0;d.util={...E0,...R0,...q0,...C0,...j0,...k0}});var cm=b(f=>{"use strict";Object.defineProperty(f,"__esModule",{value:!0});var z0=ui(),$0=Ns(),W0=gn(),Y0=na(),H0=Ky(),J0=Xy(),G0=em(),K0=tm();z0.default.toDOMStream=H0.toDOMStream;$0.Builder.throughDOM=J0.builderThroughDOMStream;W0.RecordBatchReader.throughDOM=G0.recordBatchReaderThroughDOMStream;Y0.RecordBatchWriter.throughDOM=K0.recordBatchWriterThroughDOMStream;var h=om();f.ArrowType=h.ArrowType;f.DateUnit=h.DateUnit;f.IntervalUnit=h.IntervalUnit;f.MessageHeader=h.MessageHeader;f.MetadataVersion=h.MetadataVersion;f.Precision=h.Precision;f.TimeUnit=h.TimeUnit;f.Type=h.Type;f.UnionMode=h.UnionMode;f.BufferType=h.BufferType;f.Data=h.Data;f.DataType=h.DataType;f.Null=h.Null;f.Bool=h.Bool;f.Int=h.Int;f.Int8=h.Int8;f.Int16=h.Int16;f.Int32=h.Int32;f.Int64=h.Int64;f.Uint8=h.Uint8;f.Uint16=h.Uint16;f.Uint32=h.Uint32;f.Uint64=h.Uint64;f.Float=h.Float;f.Float16=h.Float16;f.Float32=h.Float32;f.Float64=h.Float64;f.Utf8=h.Utf8;f.Binary=h.Binary;f.FixedSizeBinary=h.FixedSizeBinary;f.Date_=h.Date_;f.DateDay=h.DateDay;f.DateMillisecond=h.DateMillisecond;f.Timestamp=h.Timestamp;f.TimestampSecond=h.TimestampSecond;f.TimestampMillisecond=h.TimestampMillisecond;f.TimestampMicrosecond=h.TimestampMicrosecond;f.TimestampNanosecond=h.TimestampNanosecond;f.Time=h.Time;f.TimeSecond=h.TimeSecond;f.TimeMillisecond=h.TimeMillisecond;f.TimeMicrosecond=h.TimeMicrosecond;f.TimeNanosecond=h.TimeNanosecond;f.Decimal=h.Decimal;f.List=h.List;f.Struct=h.Struct;f.Union=h.Union;f.DenseUnion=h.DenseUnion;f.SparseUnion=h.SparseUnion;f.Dictionary=h.Dictionary;f.Interval=h.Interval;f.IntervalDayTime=h.IntervalDayTime;f.IntervalYearMonth=h.IntervalYearMonth;f.FixedSizeList=h.FixedSizeList;f.Map_=h.Map_;f.Table=h.Table;f.Column=h.Column;f.Schema=h.Schema;f.Field=h.Field;f.Visitor=h.Visitor;f.Vector=h.Vector;f.BaseVector=h.BaseVector;f.BinaryVector=h.BinaryVector;f.BoolVector=h.BoolVector;f.Chunked=h.Chunked;f.DateVector=h.DateVector;f.DateDayVector=h.DateDayVector;f.DateMillisecondVector=h.DateMillisecondVector;f.DecimalVector=h.DecimalVector;f.DictionaryVector=h.DictionaryVector;f.FixedSizeBinaryVector=h.FixedSizeBinaryVector;f.FixedSizeListVector=h.FixedSizeListVector;f.FloatVector=h.FloatVector;f.Float16Vector=h.Float16Vector;f.Float32Vector=h.Float32Vector;f.Float64Vector=h.Float64Vector;f.IntervalVector=h.IntervalVector;f.IntervalDayTimeVector=h.IntervalDayTimeVector;f.IntervalYearMonthVector=h.IntervalYearMonthVector;f.IntVector=h.IntVector;f.Int8Vector=h.Int8Vector;f.Int16Vector=h.Int16Vector;f.Int32Vector=h.Int32Vector;f.Int64Vector=h.Int64Vector;f.Uint8Vector=h.Uint8Vector;f.Uint16Vector=h.Uint16Vector;f.Uint32Vector=h.Uint32Vector;f.Uint64Vector=h.Uint64Vector;f.ListVector=h.ListVector;f.MapVector=h.MapVector;f.NullVector=h.NullVector;f.StructVector=h.StructVector;f.TimestampVector=h.TimestampVector;f.TimestampSecondVector=h.TimestampSecondVector;f.TimestampMillisecondVector=h.TimestampMillisecondVector;f.TimestampMicrosecondVector=h.TimestampMicrosecondVector;f.TimestampNanosecondVector=h.TimestampNanosecondVector;f.TimeVector=h.TimeVector;f.TimeSecondVector=h.TimeSecondVector;f.TimeMillisecondVector=h.TimeMillisecondVector;f.TimeMicrosecondVector=h.TimeMicrosecondVector;f.TimeNanosecondVector=h.TimeNanosecondVector;f.UnionVector=h.UnionVector;f.DenseUnionVector=h.DenseUnionVector;f.SparseUnionVector=h.SparseUnionVector;f.Utf8Vector=h.Utf8Vector;f.ByteStream=h.ByteStream;f.AsyncByteStream=h.AsyncByteStream;f.AsyncByteQueue=h.AsyncByteQueue;f.RecordBatchReader=h.RecordBatchReader;f.RecordBatchFileReader=h.RecordBatchFileReader;f.RecordBatchStreamReader=h.RecordBatchStreamReader;f.AsyncRecordBatchFileReader=h.AsyncRecordBatchFileReader;f.AsyncRecordBatchStreamReader=h.AsyncRecordBatchStreamReader;f.RecordBatchWriter=h.RecordBatchWriter;f.RecordBatchFileWriter=h.RecordBatchFileWriter;f.RecordBatchStreamWriter=h.RecordBatchStreamWriter;f.RecordBatchJSONWriter=h.RecordBatchJSONWriter;f.MessageReader=h.MessageReader;f.AsyncMessageReader=h.AsyncMessageReader;f.JSONMessageReader=h.JSONMessageReader;f.Message=h.Message;f.RecordBatch=h.RecordBatch;f.DataFrame=h.DataFrame;f.FilteredDataFrame=h.FilteredDataFrame;f.CountByResult=h.CountByResult;f.predicate=h.predicate;f.util=h.util;f.Builder=h.Builder;f.BinaryBuilder=h.BinaryBuilder;f.BoolBuilder=h.BoolBuilder;f.DateBuilder=h.DateBuilder;f.DateDayBuilder=h.DateDayBuilder;f.DateMillisecondBuilder=h.DateMillisecondBuilder;f.DecimalBuilder=h.DecimalBuilder;f.DictionaryBuilder=h.DictionaryBuilder;f.FixedSizeBinaryBuilder=h.FixedSizeBinaryBuilder;f.FixedSizeListBuilder=h.FixedSizeListBuilder;f.FloatBuilder=h.FloatBuilder;f.Float16Builder=h.Float16Builder;f.Float32Builder=h.Float32Builder;f.Float64Builder=h.Float64Builder;f.IntervalBuilder=h.IntervalBuilder;f.IntervalDayTimeBuilder=h.IntervalDayTimeBuilder;f.IntervalYearMonthBuilder=h.IntervalYearMonthBuilder;f.IntBuilder=h.IntBuilder;f.Int8Builder=h.Int8Builder;f.Int16Builder=h.Int16Builder;f.Int32Builder=h.Int32Builder;f.Int64Builder=h.Int64Builder;f.Uint8Builder=h.Uint8Builder;f.Uint16Builder=h.Uint16Builder;f.Uint32Builder=h.Uint32Builder;f.Uint64Builder=h.Uint64Builder;f.ListBuilder=h.ListBuilder;f.MapBuilder=h.MapBuilder;f.NullBuilder=h.NullBuilder;f.StructBuilder=h.StructBuilder;f.TimestampBuilder=h.TimestampBuilder;f.TimestampSecondBuilder=h.TimestampSecondBuilder;f.TimestampMillisecondBuilder=h.TimestampMillisecondBuilder;f.TimestampMicrosecondBuilder=h.TimestampMicrosecondBuilder;f.TimestampNanosecondBuilder=h.TimestampNanosecondBuilder;f.TimeBuilder=h.TimeBuilder;f.TimeSecondBuilder=h.TimeSecondBuilder;f.TimeMillisecondBuilder=h.TimeMillisecondBuilder;f.TimeMicrosecondBuilder=h.TimeMicrosecondBuilder;f.TimeNanosecondBuilder=h.TimeNanosecondBuilder;f.UnionBuilder=h.UnionBuilder;f.DenseUnionBuilder=h.DenseUnionBuilder;f.SparseUnionBuilder=h.SparseUnionBuilder;f.Utf8Builder=h.Utf8Builder});var X0={};vm(X0,{ArrowTable:()=>Fn,Streamlit:()=>Qe,StreamlitComponentBase:()=>fm,withStreamlitConnection:()=>hm});var dm=Un(Af()),_r=Un(zf());var um=Un(Xf());var br=Un(cm());var Fn=(function(){function t(e,r,i,n){var a=this;this.getCell=function(o,c){var l=o<a.headerRows&&c<a.headerColumns,s=o>=a.headerRows&&c<a.headerColumns,u=o<a.headerRows&&c>=a.headerColumns;if(l){var y=["blank"];return c>0&&y.push("level"+o),{type:"blank",classNames:y.join(" "),content:""}}else if(u){var w=c-a.headerColumns,y=["col_heading","level"+o,"col"+w];return{type:"columns",classNames:y.join(" "),content:a.getContent(a.columnsTable,w,o)}}else if(s){var C=o-a.headerRows,y=["row_heading","level"+c,"row"+C];return{type:"index",id:"T_"+a.uuid+"level"+c+"_row"+C,classNames:y.join(" "),content:a.getContent(a.indexTable,C,c)}}else{var C=o-a.headerRows,w=c-a.headerColumns,y=["data","row"+C,"col"+w],Be=a.styler?a.getContent(a.styler.displayValuesTable,C,w):a.getContent(a.dataTable,C,w);return{type:"data",id:"T_"+a.uuid+"row"+C+"_col"+w,classNames:y.join(" "),content:Be}}},this.getContent=function(o,c,l){var s=o.getColumnAt(l);if(s===null)return"";var u=a.getColumnTypeId(o,l);switch(u){case br.Type.Timestamp:return a.nanosToDate(s.get(c));default:return s.get(c)}},this.dataTable=br.Table.from(e),this.indexTable=br.Table.from(r),this.columnsTable=br.Table.from(i),this.styler=n?{caption:n.caption,displayValuesTable:br.Table.from(n.displayValues),styles:n.styles,uuid:n.uuid}:void 0}return Object.defineProperty(t.prototype,"rows",{get:function(){return this.indexTable.length+this.columnsTable.numCols},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.indexTable.numCols+this.columnsTable.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headerRows",{get:function(){return this.rows-this.dataRows},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headerColumns",{get:function(){return this.columns-this.dataColumns},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataRows",{get:function(){return this.dataTable.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataColumns",{get:function(){return this.dataTable.numCols},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uuid",{get:function(){return this.styler&&this.styler.uuid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"caption",{get:function(){return this.styler&&this.styler.caption},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"styles",{get:function(){return this.styler&&this.styler.styles},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"table",{get:function(){return this.dataTable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.indexTable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnTable",{get:function(){return this.columnsTable},enumerable:!0,configurable:!0}),t.prototype.serialize=function(){return{data:this.dataTable.serialize(),index:this.indexTable.serialize(),columns:this.columnsTable.serialize()}},t.prototype.getColumnTypeId=function(e,r){return e.schema.fields[r].type.typeId},t.prototype.nanosToDate=function(e){return new Date(e/1e6)},t})();var On=function(){return On=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},On.apply(this,arguments)},Mn;(function(t){t.COMPONENT_READY="streamlit:componentReady",t.SET_COMPONENT_VALUE="streamlit:setComponentValue",t.SET_FRAME_HEIGHT="streamlit:setFrameHeight"})(Mn||(Mn={}));var Qe=(function(){function t(){}return t.API_VERSION=1,t.RENDER_EVENT="streamlit:render",t.events=new um.EventTarget,t.registeredMessageListener=!1,t.setComponentReady=function(){t.registeredMessageListener||(window.addEventListener("message",t.onMessageEvent),t.registeredMessageListener=!0),t.sendBackMsg(Mn.COMPONENT_READY,{apiVersion:t.API_VERSION})},t.setFrameHeight=function(e){e===void 0&&(e=document.body.scrollHeight),e!==t.lastFrameHeight&&(t.lastFrameHeight=e,t.sendBackMsg(Mn.SET_FRAME_HEIGHT,{height:e}))},t.setComponentValue=function(e){var r;e instanceof Fn?(r="dataframe",e=e.serialize()):Q0(e)?(r="bytes",e=new Uint8Array(e.buffer)):e instanceof ArrayBuffer?(r="bytes",e=new Uint8Array(e)):r="json",t.sendBackMsg(Mn.SET_COMPONENT_VALUE,{value:e,dataType:r})},t.onMessageEvent=function(e){var r=e.data.type;switch(r){case t.RENDER_EVENT:t.onRenderMessage(e.data);break}},t.onRenderMessage=function(e){var r=e.args;r==null&&(console.error("Got null args in onRenderMessage. This should never happen"),r={});var i=e.dfs&&e.dfs.length>0?t.argsDataframeToObject(e.dfs):{};r=On(On({},r),i);var n=!!e.disabled,a=e.theme;a&&Z0(a);var o={disabled:n,args:r,theme:a},c=new CustomEvent(t.RENDER_EVENT,{detail:o});t.events.dispatchEvent(c)},t.argsDataframeToObject=function(e){var r=e.map(function(i){var n=i.key,a=i.value;return[n,t.toArrowTable(a)]});return Object.fromEntries(r)},t.toArrowTable=function(e){var r=e.data,i=r.data,n=r.index,a=r.columns,o=r.styler;return new Fn(i,n,a,o)},t.sendBackMsg=function(e,r){window.parent.postMessage(On({isStreamlitMessage:!0,type:e},r),"*")},t})();var Z0=function(t){var e=document.createElement("style");document.head.appendChild(e),e.innerHTML=`
    :root {
      --primary-color: `+t.primaryColor+`;
      --background-color: `+t.backgroundColor+`;
      --secondary-background-color: `+t.secondaryBackgroundColor+`;
      --text-color: `+t.textColor+`;
      --font: `+t.font+`;
    }

    body {
      background-color: var(--background-color);
      color: var(--text-color);
    }
  `};function Q0(t){var e=!1;try{e=t instanceof BigInt64Array||t instanceof BigUint64Array}catch{}return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array||e}var lm=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)n.hasOwnProperty(a)&&(i[a]=n[a])},t(e,r)};return function(e,r){t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}})(),fm=(function(t){lm(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.componentDidMount=function(){Qe.setFrameHeight()},e.prototype.componentDidUpdate=function(){Qe.setFrameHeight()},e})(_r.default.PureComponent);function hm(t){var e=(function(r){lm(i,r);function i(n){var a=r.call(this,n)||this;return a.componentDidMount=function(){Qe.events.addEventListener(Qe.RENDER_EVENT,a.onRenderEvent),Qe.setComponentReady()},a.componentDidUpdate=function(){a.state.componentError!=null&&Qe.setFrameHeight()},a.componentWillUnmount=function(){Qe.events.removeEventListener(Qe.RENDER_EVENT,a.onRenderEvent)},a.onRenderEvent=function(o){var c=o;a.setState({renderData:c.detail})},a.render=function(){return a.state.componentError!=null?_r.default.createElement("div",null,_r.default.createElement("h1",null,"Component Error"),_r.default.createElement("span",null,a.state.componentError.message)):a.state.renderData==null?null:_r.default.createElement(t,{width:window.innerWidth,disabled:a.state.renderData.disabled,args:a.state.renderData.args,theme:a.state.renderData.theme})},a.state={renderData:void 0,componentError:void 0},a}return i.getDerivedStateFromError=function(n){return{componentError:n}},i})(_r.default.PureComponent);return(0,dm.default)(e,t)}return wm(X0);})();
/**
 * @license
 * Copyright 2018-2021 Streamlit Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/*! Bundled license information:

react-is/cjs/react-is.production.min.js:
  (** @license React v16.13.1
   * react-is.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

object-assign/index.js:
  (*
  object-assign
  (c) Sindre Sorhus
  @license MIT
  *)

react/cjs/react.production.min.js:
  (** @license React v16.14.0
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
